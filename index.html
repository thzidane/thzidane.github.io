<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://example.com">
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Hao Tang">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" type="text/css" href="/./main.0cf68a.css">
  <style type="text/css">
  
    #container.show {
      background: linear-gradient(200deg,#a0cfe4,#e8c37e);
    }
  </style>
  

  

<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container" q-class="show:isCtnShow">
    <canvas id="anm-canvas" class="anm-canvas"></canvas>
    <div class="left-col" q-class="show:isShow">
      
<div class="overlay" style="background: #4d4d4d"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="img/cookie.jpg" class="js-avatar">
		</a>
		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>
		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
    		
    			
    			<a q-on="click: openSlider(e, 'innerArchive')" href="javascript:void(0)">所有文章</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'friends')" href="javascript:void(0)">友链</a>
    			
            
    			
    			<a q-on="click: openSlider(e, 'aboutme')" href="javascript:void(0)">关于我</a>
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://thzidane.github.io/" title="github"><i class="icon-github"></i></a>
		        
					<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
		        
					<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
		        
					<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col" q-class="show:isShow,hide:isShow|isFalse">
      
<nav id="mobile-nav">
  	<div class="overlay js-overlay" style="background: #4d4d4d"></div>
	<div class="btnctn js-mobile-btnctn">
  		<div class="slider-trigger list" q-on="click: openSlider(e)"><i class="icon icon-sort"></i></div>
	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="img/cookie.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author js-header-author"></h1>
			</hgroup>
			
			
			
				
			
			
			
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://thzidane.github.io/" title="github"><i class="icon-github"></i></a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo"><i class="icon-weibo"></i></a>
			        
						<a class="rss" target="_blank" href="#" title="rss"><i class="icon-rss"></i></a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu"><i class="icon-zhihu"></i></a>
			        
				</div>
			</nav>

			<nav class="header-menu js-header-menu">
				<ul style="width: 50%">
				
				
					<li style="width: 100%"><a href="/">主页</a></li>
		        
				</ul>
			</nav>
		</header>				
	</div>
	<div class="mobile-mask" style="display:none" q-show="isShow"></div>
</nav>

      <div id="wrapper" class="body-wrap">
        <div class="menu-l">
          <div class="canvas-wrap">
            <canvas data-colors="#eaeaea" data-sectionHeight="100" data-contentId="js-content" id="myCanvas1" class="anm-canvas"></canvas>
          </div>
          <div id="js-content" class="content-ll">
            
  
    <article id="post-Learning-redis" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/10/03/Learning-redis/">Learning-redis</a>
    </h1>
  

        
        <a href="/2021/10/03/Learning-redis/" class="archive-article-date">
  	<time datetime="2021-10-03T20:57:53.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-10-03</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Redis-basics"><a href="#Redis-basics" class="headerlink" title="Redis basics"></a>Redis basics</h2><h3 id="Data-structures"><a href="#Data-structures" class="headerlink" title="Data structures"></a><code>Data structures</code></h3><pre><code>- 5 basic data structures
    1. string
        - All redis data structures are key value pair and the only difference exists in value structure
        - like Java ArrayList
            - ArrayList capacity &gt; string len
            - Double capacity when len &lt; 1 MB
            - Increase 1 MB when len &gt; 1 MB
            - Max is 512 MB
        - Related commands
            - set name value =&gt; set key value
            - mget name1 name2 =&gt; batch get values
            - expire name 5 =&gt; set expiration time
            - setex =&gt; set + expire
            - setnx =&gt; set only when not exists
            - incr or incrby =&gt; increase value between signed long min and max
    2. list 
        - like java linked list =&gt; index search slow, and insert or delete is fast
        - Can be used to build a message queue
            - Serialize message into a string and save it into a list
            - Another process query the queue and process items in turn
        - Commands
            - rpush lpop =&gt; Queue
            - rpush rpop =&gt; Stack (rarely used)
            - lrange list start_index end_index =&gt; slow o(n)
            - ltrim list start_index end_index =&gt; slow o(n)
    3. hash like java hashmap
    4. set like java hashset
    5. zset ordered set by index
</code></pre>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/10/03/Learning-redis/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-SQL-knowledge-summary" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/21/SQL-knowledge-summary/">SQL knowledge summary</a>
    </h1>
  

        
        <a href="/2021/08/21/SQL-knowledge-summary/" class="archive-article-date">
  	<time datetime="2021-08-21T18:03:23.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-08-21</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Designing-Data-Intensive-Application-Chapter-7-Transactions"><a href="#Designing-Data-Intensive-Application-Chapter-7-Transactions" class="headerlink" title="Designing Data-Intensive Application Chapter 7 Transactions"></a>Designing Data-Intensive Application Chapter 7 <em><strong>Transactions</strong></em></h2><h3 id="ACID"><a href="#ACID" class="headerlink" title="ACID"></a><code>ACID</code></h3><pre><code>- Atomicity:
    - If an error occurs halfway through a sequence of writes, the transaction should be aborted, and the writes made up to that point should be discarded. (The database should save you from having to worry about partial failure, by giving an all-or-nothing guarantee)
- Isolation
    - Concurrently running transactions should&#39;t interfere with each other 
</code></pre>
<h3 id="Weak-Isolation-levels"><a href="#Weak-Isolation-levels" class="headerlink" title="Weak Isolation levels"></a><code>Weak Isolation levels</code></h3><h4 id="Read-Committed"><a href="#Read-Committed" class="headerlink" title="Read Committed"></a>Read Committed</h4><pre><code>- 2 promise:
    1. No Dirty Reads: When reading from the database, you will only see data that has been committed
        - Solution: 
            1. Read lock: TOO MUCH for most database except IBM DB2 and Microsoft SQL Server in the read_committed_snapshot=off configuration
            2. DB has 2 values, one for old committed and the other one for uncommitted transaction. Only when the new values is committed do transactions switch over to reading the new value.
    2. No Dirty Writes: When writing to the database, you will only overwrite data that has been committed
        - Solution:
            1. Write lock: when a transaction want to modify a particular object(row or document), it must acquire a lock on that object. It must then hold the lock for any given object until transaction is committed or aborted. Other transactions must wait until the first transaction is committed or aborted before it can acquire the lock
</code></pre>
<h4 id="Snapshot-Isolation-and-Repeatable-Read-Some-DBs-use-latter-one-for-same-isolation-level"><a href="#Snapshot-Isolation-and-Repeatable-Read-Some-DBs-use-latter-one-for-same-isolation-level" class="headerlink" title="Snapshot Isolation and Repeatable Read (Some DBs use latter one for same isolation level)"></a>Snapshot Isolation and Repeatable Read (Some DBs use latter one for same isolation level)</h4><pre><code>- Snapshot isolation is the most common solution. 
    - Each transaction reads from a consistent snapshot of the database. Even if the data is subsequently changed by another transaction, each transaction sees only the old data from that particular point in time.
- Implement snapshot isolation
    - Key principle: readers never block writer, and writers never block readers
    - MVCC (multi-version concurrency control)
        - How: 
            1. Every transaction is given a unique and always-increasing transaction ID (txid) when transaction started
            2. Every row has a createdBy and deletedBy fields which will be filled with txid
            3. Insert a new row will put its txid to createdBy and deletedBy will be empty
            4. Update a row will create a new row and mark old row deletedBy with its current new txid
                - GC will collect old row when there is no transaction referencing the old row
        - Visibility rules for observing a consistent snapshot
            1. Ignore all in progress transactions
            2. Ignore aborted transactions
            3. Ignore any writes with later transaction id
        - Index for MVCC
            1. All different versions of index living in one single point and filter out versions later than current query txid. GC will collection table rows and their index
            2. append-only/copy-on-write: 
                - Every write creates a new page of index from root for only affected part
                - No need filter because every write will not change the old index tree and every new write is seperate root
                - Needs background compaction and GC
        - Storage engines that support snapshot isolation typically use MVCC for their read committed isolation. A typical approach is that read committed uses a separate snapshot for each QUERY, while snapshot isolation uses the same snapshot for an entire TRANSACTION (Per QUERY vs Per TRANSACTION)
</code></pre>
<h4 id="Preventing-Lost-Updates"><a href="#Preventing-Lost-Updates" class="headerlink" title="Preventing Lost Updates"></a>Preventing Lost Updates</h4><pre><code>- In read-write-modify cycle(An application reads some value from the database, modifies it, and writes back the modified value), if 2 transactions do this concurrently, one of the modifications can be lost, because the second write does not include the first modification
- Solutions:
    - Foring the read-write-modify cycles to happen sequentially 
        1. Use DB provided atomic operation if possible
        2. Explicit locking
            - FOR UPDATE clause indicates that the DB should take a lock on all rows returned by this query
            - Easy to forget to add a necessary lock somewhere in the code, and thus introduce a race condition
    - DB does lost update detection: Allow concurrent transactions run parallel, and transaction manager detects a lost update, abort the transaction and force it to retry its read-write-modify cycle
        - It doesn&#39;t require application code to use any special database features. Lost update detection happens automatically and is thus less error-prone
    - Compare-and-set(In databases that don&#39;t provide transactions)
        - Update only when the value has not changed since you last read it
        - It will not work if DB is snapshot isolation because you may read an old snapshot
    - Replicated databases:
        - locks and compare-and-set assumes that there is a single up-to-date copy of the data
        - For Database with mutliple-leader or leaderless replication
            - Linearizability like 2 phase commit
            - Allow conflicting versions of value
                - Application code handling conflict
                - LWW(last write wins) is the defaut in many replicated databases
            - Atomic operations can work well in a replicated context especially if they are commutative
</code></pre>
<h4 id="Write-Skew-and-Phantoms"><a href="#Write-Skew-and-Phantoms" class="headerlink" title="Write Skew and Phantoms"></a>Write Skew and Phantoms</h4><pre><code>- Write Skew is generalization of the lost update problem
    1. Write Skew can occur if 2 transactions read the same objects, and then update some of those objects(different transactions may update different objects)
    2. Speical case where different transactions update the same object, it is a dirty read or lost update (depend on timing)
- Solutions:
    1. Serializable isolation (Preferable for rows not existing and try to insert)
        - Another option is materializing conflicts =&gt; Create a table only for locking
    2. Explicitly lock the rows that the transaction depends on like FOR UPDATE clause in SQL (Only worked for rows existing)
- Phantoms causing write skew
    1. A SELECT query checks whether some requirement is satisfied by searching for rows that match some search condition
    2. Depending on the result of the first query, the application code decides how to continue
    3. If the application decides to go ahead, it makes a write
</code></pre>
<h3 id="Serializability"><a href="#Serializability" class="headerlink" title="Serializability"></a><code>Serializability</code></h3><h4 id="Single-node-databases"><a href="#Single-node-databases" class="headerlink" title="Single-node databases"></a>Single-node databases</h4><pre><code>- 3 techniques
    1. Literally executing transactions in serial order
    2. Two-phase locking
    3. Optimistic concurrency control techniques such as serializable snapshot isolation
</code></pre>
<h4 id="Actual-Serial-Execution"><a href="#Actual-Serial-Execution" class="headerlink" title="Actual Serial Execution"></a>Actual Serial Execution</h4><pre><code>- 2 Developments caused rethink to change to make single-threaded excution
    1. RAM became cheap enough that for many cases it is now feasible to kep the entire active dataset in memory
    2. OLTP transactions are usually short and only make a small number of reawds and writes
- Encapsulating transactions in stored procedures
    - On the web, one transaction per HTTP request and every new request starts a new transaction
    - Drawbacks for stored procedures
        1. Each database has its own language
        2. Code running in a database is difficult to manage
        3. A database is often much more performance-sensitive than an application server
    - Partitioning for high write throughput applications
        - Every CPU core has its own transaction processing thread running independently per partition
        - cross-partition needs to be in lock-step across all partitions
- Summary of serial execution
    1. Every transaction must be small and fast
    2. It is limited to use cases where the active dataset can fit into memory(Newest in-memory DB like VoltDB/H-Store, Redis and Datomic. Not old-way SQL DB)
    3. Write thoughtput should be low enough to be handled on a single CPU core, or else transactions need to be partitioned without requiring cross-partition coordination
    4. Cross-partition transactions are possible, but there is a hard limit to the extent to which they can be used
</code></pre>
<h4 id="Two-Phase-Locking-2PL"><a href="#Two-Phase-Locking-2PL" class="headerlink" title="Two-Phase Locking (2PL)"></a>Two-Phase Locking (2PL)</h4><pre><code>- Lock can either be in shared mode or in exclusive mode
    - Transaction must first acquire the lock in SHARED mode before READ 
        - Lock in shared mode =&gt; allowed multiple transactions to hold the lock in shared mode
        - Lock in exclusive mode =&gt; wait until lock released
    - Trasaction must first acquire the lock in EXCLUSIVE mode before WRITE
        - Lock in shared mode =&gt; wait until lock released 
        - Lock in exclusive mode =&gt; wait until lock released
    - Transaction may upgrade lock from SHARED to EXCLUSIVE if it wants to WRITE after READ (Same as acquire exclusive lock)
        - Lock in shared mode =&gt; wait until lock released 
        - Lock in exclusive mode =&gt; wait until lock released
    - Transaction will hold the lock until the end of transaction (2 phasae lock)
        1. First phase =&gt; the lock are acquired
        2. Second phase =&gt; all the locks are released
- Deadlock is happening easily
    - Database needs to detect and abort one of the transaction to let others make progress
    - Application needs to retry aborted transaction by itself
- Performance of two-phase locking
    - Acquiring and releasing locks
    - (Mainly) reduce concurrency
    - Wasted effors to retry after transaction aborted 
- Predicate locks for Phantoms or write skew
    1. Transaction A must acquire a shared-mode predicate lock on the conditions of the query (Wants to read objects matching some condition before doing insert or update)
        - If another transaction B has an exclusive lock on any object matching those conditions =&gt; A must wait untile B releases lock
    2. Transaction A must first check whether either the old or the new value matches any existing predicate lock. 
        - If there is a matching predicate lock held by another transaction B, it must wait
- Index-range locks (PREFERRED)
    - Index-range locks acquire shared lock on a bigger range of objects than is strictly necessary to mains serializability(Predicate locks)
    - It has much better performance than predicate locks because predicate locks will create a lot of locks by active transactions
</code></pre>
<h4 id="Serializable-Snapshot-Isolation-SSI"><a href="#Serializable-Snapshot-Isolation-SSI" class="headerlink" title="Serializable Snapshot Isolation (SSI)"></a>Serializable Snapshot Isolation (SSI)</h4><pre><code>- Pessimistic vs optimistic concurrency control
    - Pessimistic =&gt; 2 phase locking and each transaction has an exclusive lock on the entire DB
    - Optimistic =&gt; Always let transactions make progress and abort when it tries to commit
- Decisions based on an outdated premise
    - 2 cases to consider
        1. Detecting reads of a stale MVCC version object (uncommitted write occurred before the read committed finally)
            - DB keeps ignored uncommitted transactions
            - When the transaction wants to commit, the database checks whether any of ignored transactions has been committed
        2. Detecting writes that affect prior reads (the writes occurs after the read)
            - Database can use index entry to record the fact that which  transaction ids are reading this data. The information will be kept before transactions have finished
            - When a transaction writes to the database, it must look into the indexes of any other transactions that have recently read the affected data. Database will notify the affected transactions that their prior read is outdated
- Performance
    1. Compared to 2 phase locking:
        - Makes query latency much more predictable and less variable. 
        - Read-only queries can run on a consistent snapshot without requiring any locks, which is very appealing for read-heavy workloads
    2. Compared to serial execution
        - not limited to the throughput of a single CPU core
        - less sensitive than serial execution and 2 phase locking to slow transactions
</code></pre>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/08/21/SQL-knowledge-summary/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Operating-System-three-pieces" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/08/20/Operating-System-three-pieces/">Operating System: three pieces</a>
    </h1>
  

        
        <a href="/2021/08/20/Operating-System-three-pieces/" class="archive-article-date">
  	<time datetime="2021-08-21T04:17:49.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-08-20</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Chapter-2-Introduction-to-Operating-Systems"><a href="#Chapter-2-Introduction-to-Operating-Systems" class="headerlink" title="Chapter 2 Introduction to Operating Systems"></a>Chapter 2 <em><strong>Introduction to Operating Systems</strong></em></h2><h3 id="What-is-operating-system"><a href="#What-is-operating-system" class="headerlink" title="What is operating system"></a><code>What is operating system</code></h3><pre><code>- What happens when a program runs:
    1. Processor fetches an instruction from memory
    2. Decodes it
    3. Executes it
- Operating System is a software responsible for making it   
    1. easy to run programs (even allowing you to seemingly run many at the same time)
    2. allowing programs to share memory
    3. enabling programs to interact with devices
- Operating System 
    - IS a virtual machine =&gt; takes a physical resource and transforms it into a virtual ofrm of itself
        1. Virtualizing CPU
        2. Virtualizing Memory
    - IS a resource manager
    - Persistence
        - OS is sometimes seen as a standard library for accessing devices through its system calls
        - Software in the operating system to usually manage the disk is called file system
        - No virtual for file system because users will want to share information that is in files
        - Handle the problems of system crashes during writes
            1. journaling
            2. copy-on-write
- Design goals
    - virtualizes, concurrency, persistently
    - Goals:
        1. abstraction
        2. performance
            - minimize the overhead:
                1. time (more instructions) 
                2. space (in memory or on disk)
        3. protection
            - isolation between processes
        4. reliability
</code></pre>
<hr>
<h2 id="Chapter-3-11-Virtualization"><a href="#Chapter-3-11-Virtualization" class="headerlink" title="Chapter 3 - 11 Virtualization"></a>Chapter 3 - 11 <em><strong>Virtualization</strong></em></h2><h3 id="Processes"><a href="#Processes" class="headerlink" title="Processes"></a><code>Processes</code></h3><pre><code>- Virtualizing CPU for multiple process running same time illusion
    - Low level mechanisms =&gt; Like time sharing mechanism
    - On top of mechanisms resides policies=&gt; Like scheduling policy
- The Abstraction: A Process
    - Machine state
        1. Memory
            - Address space is the memory that the process can address
        2. Registers
        3. I/O information
- Process API
    1. Create
    2. Destroy
    3. wait
    4. miscellaneous control like stop for some time and resume
    5. status such as how long it has run for, or what state it is in
- Process creation
    - Load code and any static data into memory from disk
    - Allocate memory for run-time stack
        1. local variables 
        2. function parameters
        3. return addresses
    - Allocate memory for heap
    - do some other initialization tasks, particularly as related to input/output (I/O)
    - main()
- Process states are Running, Ready, Blocked
</code></pre>
<h3 id="Process-API"><a href="#Process-API" class="headerlink" title="Process API"></a><code>Process API</code></h3><pre><code>- Fork() =&gt; create a new child process
- Wait() =&gt; wait for a child process to finish what it has been doing
- exec() =&gt; create a new process and execute new code that is pointing to
    - the heap and stack and other parts of the memory space of the program are re-initialized
</code></pre>
<h3 id="Limited-Direct-Execution"><a href="#Limited-Direct-Execution" class="headerlink" title="Limited Direct Execution"></a><code>Limited Direct Execution</code></h3><pre><code>- Restricted Operations
    - User mode vs Kernal mode
    - Kernal
        - kernel set up a trap table at boot time and informs the hardware of the location of these trap handler =&gt; the hardware (CPU) knows what to do (i.e., what code to jump to) when system calls and other exceptional events take place.
        - 2 Phases in the limited direct execution (LDE) protocol
            1. At boot time, kernel initializes athe trap table and the CPU remembers its location for subsequent use
            2. Running a process
                - Need traps back into the OS when the process wishes to issue a system call
                - Returns control back to process via a return-from-trap 
        - Context switch
            - Scheduler determines which process to run and timer will interrupt CPU in X ms
            - 2 types of register saves/restores
                1. Timer interrupt occurs
                    - User registers of the running process will be implicitly saved by hardware using the kernel stack of the process
                2. OS decides to switch process
                    - Kernel registers are explicitly saved by the software(OS) into memory in the process stucture of the process
    - How it works
        1. Set up the trap handlers and starting an interrupter timer
        2. Running a process in restricted mode
        3. Require OS to perform privileged operations or switch process when one process has occupied CPU for too long
</code></pre>
<h3 id="Scheduler"><a href="#Scheduler" class="headerlink" title="Scheduler"></a><code>Scheduler</code></h3><pre><code>- Metrics: 
    - Turnaround time: completion - arrival
    - Fairness
    - Response time: first run - arrival
- two families of approaches
    1. First category: Run the shortest job remaining =&gt; optimizes turnaround time
    - FIFO
        - Convoy effect: a number of relatively-short potential consumers of a resource get queued behind a heavyweight resource consumer
    - Shortest Job Frist (SJF)
    - Shortest Time-to-Completion First (STCF)
        - Any time a new job enters the system, the STCF scheduler determines which of the remaining jobs (including the new job) has the least time left, and schedules that one.
    2. Second category: alternates between all jobs =&gt; optimizes response time
        - Round-Robin (time slicing)
            - the length of a time slice must be a multiple of the timer-interrupt period
</code></pre>
<h3 id="Multi-level-Feedback-Queue-MLFQ"><a href="#Multi-level-Feedback-Queue-MLFQ" class="headerlink" title="Multi-level Feedback Queue (MLFQ)"></a><code>Multi-level Feedback Queue (MLFQ)</code></h3><pre><code>- MLFQ: Basic Rules
    - MLFQ has a number of distinct queues, each assigned a different priority level.
- Summary
    - Rule 1: If Priority(A) &gt; Priority(B), A runs (B doesn’t).
    - Rule 2: If Priority(A) = Priority(B), A &amp; B run in round-robin fashion using the time slice (quantum length) of the given queue.
    - Rule 3: When a job enters the system, it is placed at the highest priority (the topmost queue).
    - Rule 4: Once a job uses up its time allotment at a given level (regardless of how many times it has given up the CPU), its priority is reduced (i.e., it moves down one queue).
    - Rule 5: After some time period S, move all the jobs in the system to the topmost queue.
</code></pre>
<h3 id="SCHEDULING-PROPORTIONAL-SHARE"><a href="#SCHEDULING-PROPORTIONAL-SHARE" class="headerlink" title="SCHEDULING: PROPORTIONAL SHARE"></a><code>SCHEDULING: PROPORTIONAL SHARE</code></h3><pre><code>- Ticket mechanism
    - Every process has tickets number. Pick random number and compare with tickets each process has
- Stride scheduling
    - Stride: inverse in proportion to the number of tickets it has
    - Benefits vs lottery scheduling =&gt; Lottery scheduling achieves the proportions probabilistically over time; stride scheduling gets them exactly right at the end of each scheduling cycle
    - Drawbacks vs lottery scheduling =&gt; Lottery is easier. With lottery scheduling, there is no global state per process; we simply add a new process with whatever tickets it has, update the single global variable to track how many total tickets we have, and go from there
</code></pre>
<h3 id="Completely-Fair-Scheduler-CFS-of-Linux"><a href="#Completely-Fair-Scheduler-CFS-of-Linux" class="headerlink" title="Completely Fair Scheduler (CFS) of Linux"></a><code>Completely Fair Scheduler (CFS) of Linux</code></h3><pre><code>- Weighted round-robin with dynamic time slices, but built to scale and perform well under load
- virtual runtime (vruntime)
    - When a scheduling decision occurs, CFS will pick the process with the lowest vruntime to run next
- sched_latency
    - CFS uses this value to determine how long one process should run before considering a switch
    - A typical sched latency value is 48 (milliseconds)
    - CFS divides this value by the number (n) of processes running on the CPU to determine the time slice for a process
- min_granularity
    - usually set to a value like 6 ms
- Weighting (Niceness)
    - enabling users or administrators to give some processes a higher share of the CPU
    - Positive nice values imply lower priority and negative values imply higher priority
- Dealing With I/O And Sleeping Processes
    - Sets the vruntime of that job to the minimum value found in the tree
</code></pre>
<h3 id="MULTIPROCESSOR-SCHEDULING"><a href="#MULTIPROCESSOR-SCHEDULING" class="headerlink" title="MULTIPROCESSOR SCHEDULING"></a><code>MULTIPROCESSOR SCHEDULING</code></h3><pre><code>- Background: Multiprocessor Architecture
    - cache coherence for CPU cache
        - locality
            1. temporal locality: when a piece of data is accessed, it is likely to be accessed again in the near future
            2. spatial locality: if a program accesses a data item at address x, it is likely to access data items near x as well
    - Synchronization
        - the number of CPUs grows, access to a synchronized shared data structure becomes quite slow (mutex the lock on shared data)
    - Cache Affinity
        - A process, when run on a particular CPU, builds up a fair bit of state in the caches (and TLBs) of the CPU. Runs a process on a different CPU each time, the performance of the process will be worse, as it will have to reload the state each time it runs
        - Preferring to keep a process on the same CPU if at all possible
- Solutions
    1. Single-Queue Scheduling
        - Simple and looks like same as single CPU
        - Problems with scalibility:
            1. Lock is expensive
            2. Cache affinity
                - Implement some complex theme to make jobs always on same CPU
    2. multi-queue multiprocessor scheduling (or MQMS)
        - Scalable
            - Each queue will likely follow a particular scheduling discipline, such as round robin
            - It is scheduled essentially independently, thus avoiding the problems of information sharing and synchronization found in the single-queue approach
        - Load imbalance
            - Job switch like work stealing
                - a (source) queue that is low on jobs will occasionally peek at another (target) queue, to see how full it is
                -  If the target queue is (notably) more full than the source queue, the source will “steal” one or more jobs from the target to help balance load.
</code></pre>
<hr>
<h2 id="Chapter-13-23-Virtualization-of-memory"><a href="#Chapter-13-23-Virtualization-of-memory" class="headerlink" title="Chapter 13 - 23 Virtualization of memory"></a>Chapter 13 - 23 <em><strong>Virtualization of memory</strong></em></h2><h3 id="Address-space"><a href="#Address-space" class="headerlink" title="Address space"></a><code>Address space</code></h3><pre><code>- easy to use abstraction of physical memory
- all of the memory state of the running program
    - CODE of the program
    - STACK
        - Keep track of where it is in the function call chain
        - local variables and pass parameters and return values to and from routines
    - HEAP
        - dynamically-allocated, user-managed memory like new in java
</code></pre>
<h3 id="Mechanism-Address-Translation"><a href="#Mechanism-Address-Translation" class="headerlink" title="Mechanism: Address Translation"></a><code>Mechanism: Address Translation</code></h3><pre><code>- Goal: create an illusion =&gt; the program has its own private memory, where its own code and data reside
- Address translation
    - physical address = virtual address + base address
    - Base register(in CPU) =&gt; was set to the base physical memory address value when process starts
    - Each memory reference generated by the process is a virtual address
    - Bound registers =&gt; If a process generates a virtual address that is greater than the bounds, or one that is negative, the CPU will raise an exception, and the process will likely be terminated
- Hardware requirements:
    - Privileged mode to prevent user-mode processes from executing privileged operations
    - Base/bound registers
    - Ability to translate virtual address to physical address and check if within bounds
    - Privileged instruction to update base/bounds
    - Privileged instruction to register exception handlers
    - Ability to raise exceptions
- OS responsibilites
    - Have free list to allocate memory when new process created
    - Reclaim memory for terminated process and add it back to free list
    - Save and restore base/bounds register from memory per process(process structure or process control block) while context switch
    - Exception handler
        - OS installs these handlers at boot time (CPU knows which code to call when exception happens) 
</code></pre>
<h3 id="Segmentation"><a href="#Segmentation" class="headerlink" title="Segmentation"></a><code>Segmentation</code></h3><pre><code>- 3 segments for code, statck and heap; each has its own base / bounds segment registers
- 2 way to determine which segment address is pointing to
    - Expilicit: top bits for which segment and rest of bits for offset
    - Implicit: the address was generated from the program counter (i.e., it was an instruction fetch), then the address is within the code segment =&gt; ; if the address is based off of the stack or base pointer, it must be in the stack segment; any other address must be in the heap.
- Stack memory is growing negative
    - Need one more register for growing direction
    - Stack physical address = base - segement length + offset
- Sharing like code segments can be shared between processes
    - Need one more register value to for protection like read-write and read execute
    - Hardware also needs to check whether a particular access is permissible
- OS support
    - Context switch =&gt; need save and restore more register values comparing to previous simple method
    - Segments grow or shrink =&gt; find new large enough spot in physical memory
    - managing free space in physical memory =&gt;  When a new address space is created, the OS has to be able to find space in physical memory for its segments
        - Compact current existing framentation
        - Keep a free list and have some algorithm to pick next available fit spot
</code></pre>
<h3 id="Free-Space-Management"><a href="#Free-Space-Management" class="headerlink" title="Free-Space Management"></a><code>Free-Space Management</code></h3><pre><code>- Low level mechanism
    - Splitting and Coalescing
        - Split chunk of free memory when need malloc a smaller space than current chunks in list
        - Coalese chunks of free memory sitting adjacent to current chunk waiting for free and make it a continous large chunk
    - Need include size info into header since free() only needs pointer and no size passed in
        - Real memory chunk needs to free = user allocate + header
- Strategies for managing free space
    - Basic
        1. Best fit
            - Find the smallest fit
            - Benefits =&gt; reduce wasted space
            - Drawbacks =&gt; performance penalty to search fro the correct free block
        2. Worst fit
            - Find the largest fit
            - Worse, most studies show that it performs badly, leading to excess fragmentation while still having high overheads
        3. First fit
            - finds the first block that is big enough
            - One approach is to use address-based ordering
            - by keeping the list ordered by the address of the free space, coalescing becomes easier, and fragmentation tends to be reduced
        4. Next fit
            - keeps an extra pointer to the location within the list where one was looking last
            - The idea is to spread the searches for free space throughout the list more uniformly, thus avoiding splintering of the beginning of the list.
    - Other approaches
        - Segregated Lists
            - keep list of objects of one or a few popular-sized
        - Buddy Allocation
            - good for coalescing
            - One example binary buddy allocator
                - Always divide free space by two until a block that is big enough to accommodate the request is found
                - coalescing will happen recursively to check whether buddy block can coalesce into a large one
</code></pre>
<h3 id="Paging"><a href="#Paging" class="headerlink" title="Paging"></a><code>Paging</code></h3><pre><code>- Fixed size of memory
- Advantages
    - Flexibility
    - Simplicity
        - Page table (per-process) for virtual page and physical page mapping
        - Translate
            - Vitrual address bits = VPN (Virtual page number) + offset
            - Page table =&gt; VPN to physical frame number (PFN) (also sometimes called the physical page number or PPN
            - Offset is same in physical page
- PTE (Page table entry)
    - Valid bit =&gt; indicate virtual is valid or not
    - Protection bits =&gt; read, write or execute
    - Present bit =&gt; page in physical memory or on disk
    - Drity bit =&gt; page has been modified or not
    - Reference bit =&gt; track a page has been accessed or not
</code></pre>
<h3 id="Paging-Faster-Translations-TLBs"><a href="#Paging-Faster-Translations-TLBs" class="headerlink" title="Paging: Faster Translations (TLBs)"></a><code>Paging: Faster Translations (TLBs)</code></h3><pre><code>- TLB (translation-lookaside buffer)
    - TLB hit
    - TLB miss =&gt; Access memory page table and save into TLB
- Cache =&gt; take advantage of locality
    - temporal locality: an instruction or data item that has been recently accessed will likely be re-accessed soon in the future
    - spatial locality: if a program accesses memory at address x, it will likely soon access memory near x
- Who Handles The TLB Miss?
    - Hardware-managed TLBs
    - Software-managed TLB
        - trap handler
            1. The code will lookup the translation in the page table, use special “privileged” instructions to update the TLB, and return from the trap;
            2. At this point, the hardware retries the instruction (resulting in a TLB hit)
        - the hardware must save a different PC when trapping into the OS for trap handler because it is different from regular return-from-trap. The hardware must resume execution at the instruction that caused the trap not excecute the next instruction after causing trap instruction
        - needs to be extra careful not to cause an infinite chain of TLB misses to occur.
            - keep TLB miss handlers in physical memory
            - reserve some entries in the TLB for permanently-valid translations
        - Advantages
            - Flexibility: the OS can use any data structure it wants to implement the page
            - Simplicity: The hardware doesn’t do much on a miss: just raise an exception and let the OS TLB miss handler do the rest
- TLB Contents: What’s In There?
    - VPN | PFN | other bits
        - valid bit
        - protection bits
        - address-space identifier
        - a dirty bit
- TLB Issue: Context Switches
    - TLB is per process
    - Methods:
        - Flush all TLB entry by marking valid bit to be false =&gt; too costly while context switches usually happen in OS
        - Hardware systems provide an address space identifier (ASID) field in the TLB
            - ASID act same as PID (Process identifier)
            - TLB can hold translations from different processes at the same time without any confusion
            - the OS must, on a context switch, set some privileged register to the ASID of the current process
- Cache replacement
    - LRU
    - Random
</code></pre>
<h3 id="Paging-Smaller-Tables"><a href="#Paging-Smaller-Tables" class="headerlink" title="Paging: Smaller Tables"></a><code>Paging: Smaller Tables</code></h3><pre><code>- Simple Solution: Bigger pages
    - It will cause waste of memory resource (known as internal fragmentation)
- Hybrid Approach: Paging and Segments
    - Segmentation like code, stack and heap
    - Virtual address include segment number
    - When TLB miss happen, it will
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SN = (VirtualAddress &amp; SEG_MASK) &gt;&gt; SN_SHIFT</span><br><span class="line">VPN = (VirtualAddress &amp; VPN_MASK) &gt;&gt; VPN_SHIFT</span><br><span class="line">AddressOfPTE = Base[SN] + (VPN * sizeof(PTE))</span><br></pre></td></tr></table></figure>
    - The only difference compared to linear page tables is the use of one of three segment base registers instead of the single page table base register.
- Multi-level Page Tables
    - Basic idea behind a multi-level page table
        1. chop up the page table into page-sized units; 
        2. if an entire page of page-table entries (PTEs) is invalid, don’t allocate that page of the page table at all.
    - Page directory =&gt; track whether a page of the page table is valid (and if valid, where it is in memory)
        - either can be used to tell you where a page of the page table is 
        - or that the entire page of the page table contains no valid pages.
    - page directory, in a simple two-level table, contains one entry per page of the page table
        - a number of page directory entries (PDE) 
        - A PDE (minimally) has a valid bit 
        - a page frame number (PFN), similar to a PTE
    - Advantages
        1. save space: allocates page-table space in proportion to the amount of address space you are using
        2. making it easier to manage memory
    - Drawbacks:
        1. time-space trade-off: 2 instructions for one TLB miss (one for page directory and one for the PTE), in contrast to just one load with a linear page table.
        2. complexity
    - VPN =&gt; PTE in Page table
        - PDEAddr = PageDirBase + (PDIndex * sizeof(PDE))
            - page-directory index (PDIndex for short)
            - page-directory entry (PDE)
            - If the page-directory entry is marked invalid, we know that the access is invalid, and thus raise an exception
        - (First 4 bits in example) Page Directory Index =&gt; Page directory entry and find the actual page of page table
        - (Next 4 bits in example) Page Table Index =&gt; Page table entry
</code></pre>
<h3 id="BEYOND-PHYSICAL-MEMORY-MECHANISMS"><a href="#BEYOND-PHYSICAL-MEMORY-MECHANISMS" class="headerlink" title="BEYOND PHYSICAL MEMORY: MECHANISMS"></a><code>BEYOND PHYSICAL MEMORY: MECHANISMS</code></h3><pre><code>- swap space
    - OS will need to remember the disk address of a given page
- Page fault: the act of accessing a page that is not in physical memory
    - TLB hit
    - TLB miss =&gt; search in page table and load it into TLB from memory(Present bit is 1)
    - Present bit is 0 =&gt; Page fault
- OS will handle page fault and has page fault handler code
    - Looks in the PTE to find the address
    - issues the request to disk to fetch the page into memory
- Swap daemon will run in background
    - low watermark =&gt; trigger swap daemon
    - high watermark =&gt; swap will end until reaching the high watermark of free pages in memory
</code></pre>
<h3 id="BEYOND-PHYSICAL-MEMORY-Policies"><a href="#BEYOND-PHYSICAL-MEMORY-Policies" class="headerlink" title="BEYOND PHYSICAL MEMORY: Policies"></a><code>BEYOND PHYSICAL MEMORY: Policies</code></h3><pre><code>- The Optimal Replacement Policy: replaces the page that will be accessed furthest in the future
- Simple policies: FIFO and Random are intelligent in picking which blocks to evict
- Using History: LRU
    - recency of access
    - principle of locality
- Approximating LRU
    - Clock algorithm: A clock hand points to some particular page to begin with (it doesn’t really matter which). When a replacement must occur, the OS checks if the currently-pointed to page P has a use bit of 1 or 0
    - Use bit is provide by hardware
- Considering Dirty Pages
    - Dirty pages(has been modified) is more expensive than clean pages to evict
- Other VM Policies
    - On-demand paging (most systems do) or prefeching =&gt; when to bring the page into memory when it is accessed
    - cluster writing
- Thrashing
    - Need kill some process when memory is oversubscribed
</code></pre>
<h3 id="COMPLETE-VIRTUAL-MEMORY-SYSTEMS"><a href="#COMPLETE-VIRTUAL-MEMORY-SYSTEMS" class="headerlink" title="COMPLETE VIRTUAL MEMORY SYSTEMS"></a><code>COMPLETE VIRTUAL MEMORY SYSTEMS</code></h3><pre><code>- VAX/VMS
    - User address space is under OS kernel portion address space
    - lazy optimizations
        - demand zeroing: only create an entry in page table but only zero page and allocate real page when process access it 
        - copy-on-write: 
            - when the OS needs to copy a page from one address space to another, instead of copying it, it can map it into the target address space and mark it readonly in both address spaces
            - only allocate a new page when either process is trying to write
- Linux
    - User and kernel address spaces are separate
    - Kernel address has 2 parts
        1. Kernel logical address
            - Continuous in vitual as physical and easy to access
        2. kernel virtual address
            - Not continuous
            - Allocating large chunk of memory
    - 4 level of page directory structure for page table
    - TLB performance gains drive large page support
</code></pre>
<hr>
<h2 id="Chapter-26-33-Concurrency"><a href="#Chapter-26-33-Concurrency" class="headerlink" title="Chapter 26 - 33 Concurrency"></a>Chapter 26 - 33 <em><strong>Concurrency</strong></em></h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a><code>Introduction</code></h3><pre><code>- Single thread state is similar as single process
    - Differences between thread and process
        1. Context switch the address space remains the same
        2. One stack per thread
- Why use thread
    - Parallelism: transforming your standard single-threaded program into a program that does this sort of work on multiple CPUs
    - avoid blocking program progress due to slow I/O: enables overlap of I/O with other activities within a single program 
    - Could use multiple process to do either of these 2 but multi-thread makes it easy to share data
- Heart of the problem
    - Race condition on shared across threads execution
    - one thread wait for another
</code></pre>
<h3 id="locks"><a href="#locks" class="headerlink" title="locks"></a><code>locks</code></h3><pre><code>- Evaluating locks
    - Basic task: mutual exclusion between different threads
    - Fairness
    - Performance
- Ways to add locks
    1. Controlling Interrupts
        - lock() =&gt; DisableInterrupts()
        - disadvantages:
            1. allow any calling thread to perform a privileged operation
            2. does not work on multiprocessors (thread is running on another processor)
            3. Inefficiency
    2. A Failed Attempt: Just Using Loads/Stores
        - sets the flag to 1 to indicate that the thread now holds the lock
        - Other threads while spin-wait
        - easily produce a case where both threads set the flag to 1 and both threads are thus able to enter the critical section
    3. Working Spin Locks with Test-And-Set
        - Test-And-Set: It returns the old value pointed to by the old ptr, and simultaneously updates said value to new. 
        - The key =&gt; this sequence of operations is performed atomically
    4. Compare-And-Swap
    5. Load-Linked and Store-Conditional
        - key difference compared to a typical load instruction =&gt; with the store-conditional, which only succeeds (and updates the value stored at the address just load-linked from) if no intervening store to the address has taken place
        - the store-conditional=&gt;  only one of these threads will succeed in updating the flag to 1 and thus acquire the lock when two threads have each executed the load-linked
    6. Fetch-And-Add
        - atomically increments a value while returning the old value at a particular address
        - Only run when (myturn == turn) for a given thread
        -  Once a thread is assigned its ticket value, it will be scheduled at some point in the future (no such guarantee existed in other methods)
- Hardware provides locks mechanism =&gt; Complete multiple actions atomically
- Software (OS) can support to avoid spinning
    - A Simple Approach: Yield
        - A thread can be in one of three states (running, ready, or blocked); 
        - yield is simply a system call that moves the caller from the running state to the ready state, and thus promotes another thread to running
        - still costly (Context switch) and does not resolve starving
</code></pre>
<h3 id="Lock-based-Concurrent-Data-Structures"><a href="#Lock-based-Concurrent-Data-Structures" class="headerlink" title="Lock-based Concurrent Data Structures"></a><code>Lock-based Concurrent Data Structures</code></h3><pre><code>- Concurrent Counters
    - Local counter per core and periodically updates global counter
</code></pre>
<h3 id="Condition-variable"><a href="#Condition-variable" class="headerlink" title="Condition variable"></a><code>Condition variable</code></h3><pre><code>- Condition variable
    - an explicit queue that threads can put themselves on when some state of execution (i.e., some condition) is not as desired (by waiting on the condition);
    - some other thread, when it changes said state, can then wake one (or more) of those waiting threads and thus allow them to continue (by signaling on the condition)
- Always use while not if do check
</code></pre>
<h3 id="Semaphores"><a href="#Semaphores" class="headerlink" title="Semaphores"></a><code>Semaphores</code></h3><pre><code>- definition
    - sem_wait(sem_t *s): decrement the value of semaphore s by one wait if value of semaphore s is negative
    - sem_post(sem_t *s): increment the value of semaphore s by one if there are one or more threads waiting, wake one
    - negative value == number of waiting thread
- Binary Semaphores (locks)
    - Initial value should be 1
- Semaphores For Ordering (condition variable)
    - Initial value should be 0
- Semaphores solution for The Producer/Consumer (Bounded Buffer) Problem
    - sem_init(&amp;empty, 0, MAX); // MAX are empty
    - sem_init(&amp;full, 0, 0); // 0 are full
    - Producer             
        - sem_wait(&amp;empty); // Line P1
        - sem_wait(&amp;mutex); // Line P0 (NEW LINE)
        - sem_post(&amp;full); // Line P3
    - void *consumer(void *arg) &#123;
        - sem_wait(&amp;full); // Line C1
        - sem_wait(&amp;mutex); // Line C0 (NEW LINE)
        - sem_post(&amp;empty); // Line C3
- Reader-Writer Locks
    - First reader will acquire write lock
    - Reader always acquires read lock and increase the readers count
    - After last reader is done, release the write lock
    - Possible optimization: prevent more readers acquire read lock when writer has already been in queue waiting for write lock
</code></pre>
<h3 id="Common-Concurrency-Problems"><a href="#Common-Concurrency-Problems" class="headerlink" title="Common Concurrency Problems"></a><code>Common Concurrency Problems</code></h3><pre><code>- Non-Deadlock Bugs
    - Atomicity-Violation Bugs =&gt; Add locks
    - Order-Violation Bugs =&gt; Add lock and condition variable
- Deadlock Bugs
    - Four conditions need to hold for a deadlock to occur:
        1. Mutual exclusion: Threads claim exclusive control of resources that they require (e.g., a thread grabs a lock).
        2. Hold-and-wait: Threads hold resources allocated to them (e.g., locks that they have already acquired) while waiting for additional resources (e.g., locks that they wish to acquire).
        3. No preemption: Resources (e.g., locks) cannot be forcibly removed from threads that are holding them.
        4. Circular wait: There exists a circular chain of threads such that each thread holds one or more resources (e.g., locks) that are being requested by the next thread in the chain.
    - Prevention
        1. Circular Wait: provide a total ordering on lock acquisition
        2. Hold-and-wait: Add global prevention lock
            - Not good for encapsulation
        3. No Preemption: tryLock()
        4. Mutual Exclusion: using powerful hardware instructions, you can build data structures in a manner that does not require explicit locking
            - Like compare-and-swap
        5. Deadlock Avoidance via Scheduling
        6. Detect and Recover
</code></pre>
<h3 id="Event-based-Concurrency-Like-web-server"><a href="#Event-based-Concurrency-Like-web-server" class="headerlink" title="Event-based Concurrency (Like web server)"></a><code>Event-based Concurrency (Like web server)</code></h3><pre><code>- Event loop to keep getting events and handle event to event handler
- select() =&gt; query network sockets for events
- No locks needed
- No blocking calls are allowed
- Asynchronous I/O: enable an application to issue an I/O request and return control immediately to the caller, before the I/O has completed
    1. Query system to check if I/O is done
    2. some systems provide an approach based on the interrupt. Using UNIX signals to inform applications when an asynchronous I/O completes =&gt; removing the need to repeatedly ask the system
- State Management: manual stack management
- What Is Still Difficult With Events
    - All systems moved from a single CPU to multiple CPUs
    - it does not integrate well with certain kinds of systems activity, such as paging
    - event-based code can be hard to manage overtime
    - Difficult to intergrate with other system
</code></pre>
<hr>
<h2 id="Chapter-35-51-Persistence"><a href="#Chapter-35-51-Persistence" class="headerlink" title="Chapter 35 - 51 Persistence"></a>Chapter 35 - 51 <em><strong>Persistence</strong></em></h2><h3 id="I-O-Devices"><a href="#I-O-Devices" class="headerlink" title="I/O Devices"></a><code>I/O Devices</code></h3><pre><code>- System Architecture
    1. By memory bus
        - CPU and Main memory
    2. By general I/O bus
        - graphics and some other higher-performance I/O devices
    3. peripheral bus
        - slow devices to the system, including disks, mice, and keyboards
- A Canonical Device
    - Interface: status register, commnd register and data register            
    - Internal structure
- The Canonical Protocol
    1. OS waits until the device is ready to receive a command by repeatedly reading the status register
    2. OS sends some data down to the data register
    3. OS writes a command to the command register
    4. OS waits for the device to finish by again polling it in a loop, waiting to see if it is finished
- Lowering CPU Overhead With Interrupts
    - Instead of polling the device repeatedly, 
        1. OS can issue a request, put the calling process to sleep, and context switch to another task 
        2. When the device is finally finished with the operation, it will raise a hardware interrupt, causing the CPU to jump into the OS at a predetermined interrupt service routine (ISR) or more simply an interrupt handler
    - it may be best to use a hybrid that polls for a little while and then, if the device is not yet finished, uses interrupts. This two-phased approach may achieve the best of both worlds
    - Another reason not to use interrupts arises in networks. When a huge stream of incoming packets each generate an interrupt, it is possible for the OS to livelock
    - Another interrupt-based optimization is coalescing. 
        - In such a setup, a device which needs to raise an interrupt first waits for a bit before delivering the interrupt to the CPU. - While waiting, other requests may soon complete, and thus multiple interrupts can be coalesced into a single interrupt delivery =&gt; lowering the overhead of interrupt processing
- More Efficient Data Movement With Direct Memory Access (DMA)
    - To transfer data to the device, for example, the OS would program the DMA engine by telling it 
        - where the data lives in memory
        - how much data to copy
        - which device to send it to 
    - At that point, the OS is done with the transfer and can proceed with other work.
    - When the DMA is complete, the DMA controller raises an interrupt, and the OS thus knows the transfer is complete
- Methods Of Device Interaction
    - I/O instructions
        - These instructions specify a way for the OS to send data to specific device registers
        - instructions are usually privileged
    - memory-mapped I/O
        - the hardware makes device registers available as if they were memory locations
        - To access a particular register, the OS issues a load (to read) or store (to write) the address; the hardware then routes the load/store to the device instead of main memory
- Fitting Into The OS: The Device Driver
    - device driver is the software knows the detail of device and encapsulate the detail
    - Application =&gt; File System =&gt; Generic Block interface =&gt; Specific Block Interface (Device Driver)
    - Downsides:
        1. Have to provide generic interface and may sacrifice device&#39;s special capabilities
        2. Huge percentage of kernel code
</code></pre>
<h3 id="Hard-Disk-Drives"><a href="#Hard-Disk-Drives" class="headerlink" title="Hard Disk Drives"></a><code>Hard Disk Drives</code></h3><pre><code>- The Interface
    - The drive consists of a large number of sectors (512-byte blocks), each of which can be read or written
    - The sectors are numbered from 0 to n − 1 on a disk with n sectors
    - 0 to n − 1 is thus the address space of the drive
- the only guarantee drive manufacturers make is that a single 512-byte write is atomic
- assumptions
    1. accessing two blocks1 near one-another within the drive’s address space will be faster than accessing two blocks that are far apart
    2. accessing blocks in a contiguous chunk (i.e., a sequential read or write) is the fastest access mode, and usually much faster than any more random access pattern
- Disk Scheduling
    1. SSTF: Shortest Seek Time First =&gt; orders the queue of I/O requests by track, picking requests on the nearest track to complete first
        - Drawbacks
            1. the drive geometry is not available to the host OS
                - OS can simply implement nearest-block-first (NBF)
            2. starvation: if there were a steady stream of requests to the inner track, Requests to any other tracks would then be ignored completely
    2. Elevator (a.k.a. SCAN or C-SCAN) =&gt; simply moves back and forth across the disk servicing requests in order across the tracks
    3. SPTF: Shortest Positioning Time First
        - seek time VS rotational delay
        - OS does not know =&gt; SPTF is usually performed inside a drive
</code></pre>
<h3 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a><code>RAID</code></h3><pre><code>- Redundant Array of Inexpensive Disks
- A RAID system is often built as a separate hardware box
    - a microcontroller that runs firmware to direct the operation of the RAID
    - volatile memory such as DRAM to buffer data blocks as they are read and written, and in some cases
    - non-volatile memory to buffer writes safely 
    - perhaps even specialized logic to perform parity calculations
- RAID Level 0: Striping =&gt; no redundancy
    1. Capacity: perfect
    2. reliability: worst 
        - any disk failure will lead to data loss
    3. performance: excellent
- RAID Level 1: Mirroring =&gt; 2 copy of same block
    - half the available bandwidth
- RAID Level 4: Saving Space With Parity =&gt; adding redundancy to a disk array known as parity
    - 1 extra disk for parity
    - Allow at most 1 disk data loss
    - Override parity when bits change
        1. additive parity
            - Read all other disks and recalculate
        2. subtractive parity
            - Pnew = (Cold XOR Cnew) XOR Pold
- RAID Level 5: Rotating Parity =&gt; no extra parity disk
- Conclusion
    1. Strictly want performance and do not care about reliability =&gt; striping (RAID 0)
    2. Random I/O performance and reliability =&gt; mirroring (RAID 1)
        - Cost =&gt; lost capacity. 
    3. Capacity and reliability are main goals =&gt; RAID5 is the winner
        - Cost =&gt; small-write performance. 
    4. Always doing sequential I/O and want to maximize capacity =&gt; RAID-5
</code></pre>
<h3 id="Files-and-Directories"><a href="#Files-and-Directories" class="headerlink" title="Files and Directories"></a><code>Files and Directories</code></h3><pre><code>- File
    - Low-level name is inode number (user is not aware of)
    - OS does not know much about the structure of the file 
    - responsibility of the file system =&gt; simply to store such data persistently on disk and make sure that when you request the data again, you get what you put there in the first place
- directory
    - Like a file, also has a low-level name (i.e., an inode number), but - Its contents are quite specific: it contains a list of (user-readable name, low-level name) pairs
    - Each entry in a directory refers to either files or other directories. By placing directories within other directories, users are able to build an arbitrary directory tree
    - The directory hierarchy starts at a root directory (in UNIX-based systems, the root directory is simply referred to as /) and uses some kind of separator to name subsequent sub-directories until the desired file or directory is named
- API
    - Create files
        - open() =&gt; returns a file descriptor
        - A file descriptor is just an integer, private per process, and is used in UNIX systems to access files
        - once a file is opened, you use the file descriptor to read or write the file
    - Reading And Writing Files
        - cat
            - Firstly needs open() and use file descriptor returned from open() to read bytes from file
            - each running process already has three files open
                1. standard input (which the process can read to receive input)
                2. standard output (which the process can write to in order to dump information to the screen)
                3. standard error (which the process can write error messages to)
    - Reading And Writing, But Not Sequentially
        - off_t lseek(int fildes, off_t offset, int whence);
            1. The first argument is familiar (a file descriptor). 
            2. The second argument is the offset, which positions the file offset to a particular location within the file. 
            3. The third argument, called whence for historical reasons, determines exactly how the seek is performed. From the man page:
                -  If whence is SEEK_SET, the offset is set to offset bytes.
                - If whence is SEEK_CUR, the offset is set to its current location plus offset bytes.
                - If whence is SEEK_END, the offset is set to the size of the file plus offset bytes.
    - Shared File Table Entries: fork() And dup()
        - Even if some other process reads the same file at the same time, each will have its own entry in the open file table
        - In a few cases, an entry in the open file table is shared
            - a parent process and a child process created with fork() by parent
            - reference count to determine when to remove the entry in the table
        - dup() call allows a process to create a new file descriptor that refers to the same underlying open file as an existing descriptor
    - Writing Immediately With fsync()
        - write()
            - The file system, for performance reasons, will buffer such writes in memory for some time (say 5 seconds, or 30); at that later point in time, the write(s) will actually be issued to the storage device
        - fsync()
            - the file system responds by forcing all dirty (i.e., not yet written) data to disk, for the file referred to by the specified file descriptor
    - Renaming Files: mv
        - rename() call is that it is (usually) implemented as an atomic call with respect to system crashes
    - Getting Information About Files: stat
        - metadata: the file system to keep a fair amount of information about each file it is storing
        - stat
            - its size (in bytes)
            - its low-level name (i.e., inode number)
            - some ownership information
            - some information about when the file was accessed or modified
    - Removing Files: rm
        - call unlink() underneath
    - Making Directories: mkdir
        - mkdir will create an empty directory including
            1. “.” (dot) directory =&gt; refers to itself
            2. “..” (dot-dot) =&gt; refers to its parent
    - Reading Directories: ls
        - ls will give just mapping the name to the inode number, along with a few other details
        - ls -l will get more information such as its length or other detailed information
    - Deleting Directories: rmdir
        - If you try to delete a non-empty directory, the call to rmdir() simply will fail
    - Hard Links: ln
        - takes two arguments, an old pathname and a new one
        - creates another name in the directory you are creating the link to, and refers it to the same inode number (i.e., low-level name) of the original file
        - When create a file
            1. Making a structure (the inode) that will track virtually all relevant information about the file, including its size, where its blocks are on disk, and so forth
            2. linking a human-readable name to that file, and putting that link into a directory
        - unlink 
            1. remove the “link” between the human-readable name (the file that is being deleted) to the given inode number
            2. decrements the reference count
            3. only when the reference count reaches zero does the file system also free the inode and related data blocks, and thus truly “delete” the file
    - Symbolic Links or Soft link: ln -s
        - Different between soft and hard link
            1. a symbolic link is actually a file itself, of a different type.
            2. because of the way symbolic links are created, they leave the possibility for what is known as a dangling reference =&gt; the link to point to a pathname that no longer exists
    - Permission Bits And Access Control Lists
        <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">prompt&gt; ls -l foo.txt</span><br><span class="line">-rw-r--r-- 1 remzi wheel 0 Aug 24 16:29 foo.txt</span><br></pre></td></tr></table></figure>
        - The first character =&gt; shows the type of the file
            1. - for a regular file (which foo.txt is)
            2. d for a directory
            3. l for a symbolic link
        - Next 9 bits are permission bits
            - determine exactly who can access it and how for each regular file, directory, and other entities
            - consist of three groupings
                1. what the owner of the file can do to it
                2. what someone in a group can do to the file
                3. what anyone (sometimes referred to as other)
            - read the file, write it, or execute it
</code></pre>
<h3 id="File-System-Implementation"><a href="#File-System-Implementation" class="headerlink" title="File System Implementation"></a><code>File System Implementation</code></h3><pre><code>- 2 key questions
    1. data structures of the file system
    2. access methods
- Overall Organization
    - divide the disk into blocks
        - Data blocks 
        - Inodes
            - metadata to track information about each file
        - Allocation structures
            1. data bitmap
            2. inode bitmap
        - Superblck
            - information about this particular file system, including, for example, how many inodes and data blocks are in the file system (80 and 56, respectively in this instance), where the inode table begins (block 3), and so forth
- File Organization: The Inode
    - metadata: any information inside the file system that isn’t pure user data
    - Include
        1. type (e.g., regular file, directory, etc.)
        2. size
        3. the number of blocks allocated to it
        4. protection information (such as who owns the file, as well as who can access it)
        5. time information
            - including when the file was created, modified, or last accessed
        6. information about where its data blocks reside on disk (e.g., pointers of some kind)
-  Directory Organization
    - a directory basically just contains a list of (entry name, inode number) pairs
    - each directory has two extra entries, . “dot” and .. “dot-dot”
    - a directory has an inode, somewhere in the inode table
- Free Space Management
    - Bit map is one way
- Access Paths: Reading and Writing
    - Reading A File From Disk
        1. Search from root directory and read root directory inode (In most UNIX file systems, the root inode number is 2)
        2. Once the inode is read in, the FS can look inside of it to find pointers to data blocks, which contain the contents of the root directory =&gt; looking for (foo, inode_nbr)
        3. recursively traverse the pathname until the desired inode is found
        4. read bar’s inode into memory
        5. the FS then does a final permissions check
        6. allocates a file descriptor for this process in the per-process open-file table, and returns it to the user
        7. Once open, the program can then issue a read() system call to read from the file
        8. The first read (at offset 0 unless lseek() has been called) will thus read in the first block of the file, consulting the inode to find the location of such a block
        9. it may also update the inode with a new lastaccessed time
        10. The read will further update the in-memory open file table for this file descriptor, updating the file offset such that the next read will read the second file block
    - Writing A File To Disk (Writing to a file is a similar process)
        1. the file must be opened
        2. the application can issue write() calls to update the file with new contents
            - Unlike reading, writing to the file may also allocate a block
                - 5 I/Os
                    1. read the data bitmap (which is then updated to mark the newly-allocated block as used)
                    2. write the bitmap (to reflect its new state to disk)
                    3. two more to read and write the inode (which is updated with the new block’s location)
                    5. write the actual block itself
        3. the file is closed.
</code></pre>
<h3 id="LOCALITY-AND-THE-FAST-FILE-SYSTEM"><a href="#LOCALITY-AND-THE-FAST-FILE-SYSTEM" class="headerlink" title="LOCALITY AND THE FAST FILE SYSTEM"></a><code>LOCALITY AND THE FAST FILE SYSTEM</code></h3><pre><code>- divides the disk into a number of cylinder groups
    - a single cylinder group:
        1. super block (S)
        2. per-group inode bitmap (ib) and data bitmap (db)
        3. inode and data block regions
- basic rule: keep related stuff together (and its corollary, keep unrelated stuff far apart)
    - directories: find the cylinder group with a low number of allocated directories (to balance directories across groups) and a high number of free inodes (to subsequently be able to allocate a bunch of files), and put the directory data and inode in that group
    - files: FFS does two things
        1. it makes sure (in the general case) to allocate the data blocks of a file in the same group as its inode, thus preventing long seeks between inode and data (as in the old file system).
        2. it places all files that are in the same directory in the cylinder group of the directory they are in
</code></pre>
<h3 id="Crash-Consistency-FSCK-and-Journaling"><a href="#Crash-Consistency-FSCK-and-Journaling" class="headerlink" title="Crash Consistency: FSCK and Journaling"></a><code>Crash Consistency: FSCK and Journaling</code></h3><pre><code>- CANNOT move the file system from one consistent state (e.g., before the file got appended to) to another atomically (e.g., after the inode, bitmap, and new data block have been written to disk)
- Solution 1 FSCK
    - A UNIX tool for finding such inconsistencies and repairing them
- Solution 2 Journaling (or Write-Ahead Logging)
    - Data Journaling
        - The transaction begin (TxB) tells us about this update, including information about the pending update to the file system (e.g., the final addresses of the blocks I[v2], B[v2], and Db), and some kind of transaction identifier (TID)
        - The middle three blocks just contain the exact contents of the blocks themselves; this is known as physical logging
        - The final block (TxE) is a marker of the end of this transaction, and will also contain the TID
    - protocol to update the file system
        1. Journal write: Write the contents of the transaction (including TxB, metadata, and data) to the log; wait for these writes to complete.
        2. Journal commit: Write the transaction commit block (containing TxE) to the log; wait for write to complete; transaction is said to be committed.
        3. Checkpoint: Write the contents of the update (metadata and data) to their final on-disk locations.
</code></pre>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/08/20/Operating-System-three-pieces/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Microservice-Pattern" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/17/Microservice-Pattern/">Learning Microservice Pattern</a>
    </h1>
  

        
        <a href="/2021/07/17/Microservice-Pattern/" class="archive-article-date">
  	<time datetime="2021-07-18T04:22:34.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-07-17</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Chapter-1-Microservice-summary"><a href="#Chapter-1-Microservice-summary" class="headerlink" title="Chapter 1 Microservice summary"></a>Chapter 1 <em><strong>Microservice summary</strong></em></h2><h3 id="What-is-microservice-and-its-good-and-bad"><a href="#What-is-microservice-and-its-good-and-bad" class="headerlink" title="What is microservice and its good and bad"></a><code>What is microservice and its good and bad</code></h3><pre><code>- What is microservice
    1. Communictation between services:
        - Use light protocol like REST or gRPC
    2. Data managment:
        - Microservice always has its own data model and database
- Good:
    1. Big and complex system can be continous development
    2. Microservice is small and easy for maintainence
    3. Individual deployment
    4. Individual development
    5. Easy to do new experiment and test new technology
    6. Better error tolerance
- Bad:
    1. How to devide and define microservice is challenging
    2. Distributed system is complex
        - Talk between different services
        - Query with different services
        - IDE
        - Maintenance
    3. Multiple teams management
    4. Decide when to start using microservice
</code></pre>
<hr>
<h2 id="Chapter-2-Service-Decompose-Strategy"><a href="#Chapter-2-Service-Decompose-Strategy" class="headerlink" title="Chapter 2 Service Decompose Strategy"></a>Chapter 2 <em><strong>Service Decompose Strategy</strong></em></h2><h3 id="Software-Architecture"><a href="#Software-Architecture" class="headerlink" title="Software Architecture"></a><code>Software Architecture</code></h3><pre><code>- Features:
    1. Software Elements
    2. Relationship
- 4 + 1 view model
    1. Logic 
        - Class and type
        - Inheritance, class relation and dependency
    2. Implementation or Development
        - Module(JAR) and assembly(WAR)
        - Module and module relationship and modules and assembly relationship
    3. Process:
        - Process
        - Talk between different processes
    4. Physical:
        - VM or Physical machine
        - Network
- Architecture is import for non-functional requirements
    - like Reliability and Scalability
- Software Architecture pattern:
    - Logic:
        1. Layers
            - API
            - Logic
            - Database
        2. 六边形
            - Business logic is center and all adapters depend on business logic
            - Ins and outs port and adapters
                1. Ins 
                    - port: service API for outside world calling
                    - Adapter: Processing outside world request (like Spring MVC controller and message broker proxy)
                2. Outs 
                    - port: database API
                    - adapter: process request from business logic (like DAO)
    - Implementation
        1. Monolithic
            - Single WAR
        2. Microservice
            - Multiple WAR
            - What is service:
                - One single software component and can be individually deployed
                - Basic definition:
                    1. Has API
                    2. Individual deployment
            - Loose coupling:
                - Use API to encapsulate the implementation details
                - Benefits:
                    1. No access to service database from outside world
                    2. Isolation easy for development and testing
                - Bad:
                    - Data integrity
                    - Query across different services is hard
            - Shared Library vs Microservice:
                - Shared Library should be used for component very unlikely to change
                - Microsersive is opposite and should be used for easy to change service
</code></pre>
<h3 id="Service-decomposition"><a href="#Service-decomposition" class="headerlink" title="Service decomposition"></a><code>Service decomposition</code></h3><pre><code>- Microservice decompose steps
    1. Translate user case to system operation
        - Create data model for different subdomain (from User story nounce)
        - System operation definition and correlate operations with data model subdomains (from User story verbs)
            - Command and query
            - Operation definition:
                1. Operation (param1, param2)
                2. Return value
                3. pre-requisite
                4. post-requisite
    2. Decompose Service
        1. By business capability
            - Top level capability and sub level capability
            - Top level capability is always a service and sometimes sub level can also be a service. It depends
            - Good: capability is not always changing and services structure is stable
            - But services by capability may still need change in the future like too many talks between 2 services and they should become one single service 
        2. By subdomain
            - Need analyzing the business and its organizational structure
        3. principles:
            - SRP: single responsibility principle
                - One service should only have one single responsibility and only one reason to change it not influenced by others
                - Good for reliability
            - CCP: common closure principle
                - One closure should contain types which are coupled and have to be changed in sequence
                - Good for maintenance
    3. Service API definition
        - Service category:
            - Internal service call only
            - Both internal and outer client service call
        - Steps:
            - Get starting service for a system operation
            - Get all needed API for all other relying services
            - 3 ways for communication between services
                1. Real time API call like REST api call
                2. Asynchronous like message queue
                3. Self contained service like saving a copy of another service data and listening on update events
- Microservice design obstacles:
    1. Network delay
        - Solution: Request in batch or have to combine 2 servcies
    2. Service synchronous communication
        - Problem: REST may reduce the reliability. One service down may cause the whole service not working
    3. Data integrity across service
        - SAGA can achieve eventual consistency but still ACID cannot be achieved like old 2-phase commit
    4. Remove GOD class
        - DDD: domain driven and decompose large object into different domain
</code></pre>
<hr>
<h2 id="Chapter-3-Service-Communication"><a href="#Chapter-3-Service-Communication" class="headerlink" title="Chapter 3 Service Communication"></a>Chapter 3 <em><strong>Service Communication</strong></em></h2><h3 id="Communication-style"><a href="#Communication-style" class="headerlink" title="Communication style"></a><code>Communication style</code></h3><pre><code>1. Synchsonous Communication
    - To stop failure spreading, use timeout, request upper limit and circuit breaker        
    - Need service discovery either use Kubernetes platform or client keeps service table    
2. Asynchronous Communication        
    - Better and should be used as much as possible (Higher reliability)
    - Save message becomes part of transaction        
    - A seperate process to do polling publisher or transaction log miner to get message and sent to message broker
</code></pre>
<hr>
<h2 id="Chapter-4-Saga"><a href="#Chapter-4-Saga" class="headerlink" title="Chapter 4 Saga"></a>Chapter 4 <em><strong>Saga</strong></em></h2><h3 id="Saga"><a href="#Saga" class="headerlink" title="Saga"></a><code>Saga</code></h3><pre><code>1. 2 Phase commit is not for some application and SAGA is the answer
    - Application operation may need transaction which spans multiple services and 2PC is not achievable since that may need every microservice to agree and waiting for reply through network.
    - Every microservice will update its local data store and needs compensation if the whole saga transaction failed
2. 2 types of Saga
    1. Choreography-based saga(协同式)
        - only used for Simplest business logic
        - services communicate with each other for next step
    2. Orchestration-based saga（编排式)
        - Complicate business logic
        - Have single master saga manager to send commands to participants
        - Benefits:
            1. Easy for testing and development with state machine
3. Saga is missing I in ACID
    - Need different strategies to achieve isolation
        0. Sematic lock
            - Order table add PENDING_APPROVE lock and other operation cannot update
        1. Pessimistic
            - Reorder service calls to remove dirty read possibility
        2. Commutative
            - Operation are Commutative =&gt; operations sequence not matter 
        3. Add version to non commutative operations
            - Can process based on version sequence
        4. Read again and compare before update
4. Implementation example:
    1. Order service
        - Order class
        - Service API
        - repository
    2. Create order saga
        - Saga manager and saga state
    3. Order command handlers
        - Saga participants
</code></pre>
<hr>
<h2 id="Chapter-5-Business-logic-design-patterns"><a href="#Chapter-5-Business-logic-design-patterns" class="headerlink" title="Chapter 5 Business logic design patterns"></a>Chapter 5 <em><strong>Business logic design patterns</strong></em></h2><h3 id="2-design-patterns"><a href="#2-design-patterns" class="headerlink" title="2 design patterns"></a><code>2 design patterns</code></h3><pre><code>1. Transaction
    - Procedural
    - Good for simple business logic and not easy for extension
    - Order service has list of all operations provided
    - Order DAO for Database operations
    - Order class only has properties and no function implementation detail 
2. Domain driven
    - OOP
    - Order service still provides operations API
    - Order repository for database queries
    - Order class has state and function for business logic actions
    - Benefits:
        1. Easy for understanding and maintenance
        2. Easy for testing
</code></pre>
<h3 id="Domain-driven-design"><a href="#Domain-driven-design" class="headerlink" title="Domain-driven design"></a><code>Domain-driven design</code></h3><pre><code>- Key concepts:
    1. Entity
        - Persistable object with ID
    2. Value object
        - asset of values. Objects with same values are same objects
    3. Factory
    4. Repository
    5. Service
    6. Aggregates
- Aggregates in domain design model
    - Aggregates has clear boundary
    - Aggregates rules:
        1. Only reference root object which is good for unchanged rules always check
        2. Aggregate should use primary key to reference other aggregate
        3. One transaction can only update or create one aggregate
            - Benefits for microservice:
                1. Transaction will not span to multiple aggregates and domains
                2. Saga is solution for managing multiple aggregates operations 
</code></pre>
<h3 id="Domain-Event"><a href="#Domain-Event" class="headerlink" title="Domain Event"></a><code>Domain Event</code></h3><pre><code>- A domain event as something that has happened to an aggregate
    - Pattern =&gt; When X happpens do Y  
- How to create a domain event and publish
    - Domain type class will not have domain event publisher but service can have because of dependency injection
    - 2 ways
        1. (Service&#39;s methods do it seperately)Create a method in Aggregate to return a list of events and let service call when state changed 
            - Problem: It needs refactor for non-void methods
        2. (Super class has property to save and publish multiple aggregate&#39;s events together) Extends super class and save events
            - Problem: Aggregate root type always has the method to save events to super class but other types needs some way to publish events to root type
- Kitchen service as an example
    - Aggrete Ticket Type:
        1. Properties
            - Use Id not object as reference to other types
        2. Functions
            - Update state properties
            - Create event list for publish back state updates
    - Domain service KitchenService:
        1. accept()
            - Use repository to query DB and create entity object (Ticket ticket)
            - Call implementation and get list of publish back domain events =&gt; ticket.accept()
            - domainEventPublisher publish events
        2. Order service it needs create saga after publish
    - Adapter to handle saga commands KitchenServiceCommandHandler
        1. commandHandlers()
            - return mapping of command type and related handler method
        2. Handler method:
            - Call kitchenService related methods
            - return status withSuccess(), withFailure().... 
</code></pre>
<h3 id="Difference-between-DDD-and-OOP"><a href="#Difference-between-DDD-and-OOP" class="headerlink" title="Difference between DDD and OOP"></a><code>Difference between DDD and OOP</code></h3><pre><code>1. DDD aggregate has retricted rule and implemented in root aggregate type
    - Reference to other types is by primary key not by object memory address (ACID is within single microservice. No direct reference to other types)
    - Transaction only updates or creates single aggregate not multiple class objects like OOP
2. Saga has been used to do transaction events to keep data integrity across different aggregates
</code></pre>
<hr>
<h2 id="Chapter-6-Event-sourcing"><a href="#Chapter-6-Event-sourcing" class="headerlink" title="Chapter 6 Event sourcing"></a>Chapter 6 <em><strong>Event sourcing</strong></em></h2><h3 id="Event-sourcing"><a href="#Event-sourcing" class="headerlink" title="Event sourcing"></a><code>Event sourcing</code></h3><pre><code>- Old way to persist object
    1. Impedance mismatch
        - DB model is a table not same as oo design
    2. No aggregate change history. Only has current state in DB.
    3. Hard for auditing and easy for mistake because of No 2
    4. Event publishing is seperate from business logic
- What is event sourcing
    - Compare to old persist way: Instead of only saving current state for persisting object, event sourcing will replay all events on the default new object.
        1. Load all events
        2. Create default new object
        3. Replay all events to get latest state
    - Old way event is driven by receiver (what information is needed) vs Event sourcing every event is about a state change and has more rigid requirements
        - Event will have all data needed for create or update domain object
        - Create (Class factory method will be replaced by process and apply):
            1. Create default object
            2. process() =&gt; generate create*Event
            3. apply(create*Event)
            4. save create*Event into events db
        - Update:
            1. Load all events from events db
            2. create default object
            3. apply(allLoadedEvents)
            4. generate update*Event
            5. apply(update*Event)
            6. save(update*Event) into events db
        - Optimistic lock (version like events list count for aggregate)
        - Publish events to message publish proxy:
            1. Direct Select query not published events
            2. Read DB table transaction logs
        - Snapshot to improve performance for old items
            - Create object from snapshot and only play events after snapshot timestamp
        - Idempotent Message
            - Remove duplicate messages:
                1. Relation DB: save message ID as part of event transaction
                2. NoSQL: Always fire event after processed message to include message ID
        - Upcast message to latest like script do SQL schema upgrade
        - Benefits:
            1. Publish domain event reliably
            2. Have aggregate history
            3. Good solution to Impedance mismatch
                - DB model is a table not same as oo design
            4. Back to old days possibility for developers
        - Drawbacks:
            1. Learning curve
            2. message communication is complex
                - like handle and remove duplicate message
            3. Event version
            4. Delete data
            5. Query event store
</code></pre>
<h3 id="Event-store"><a href="#Event-store" class="headerlink" title="Event store"></a><code>Event store</code></h3><pre><code>- Mix of DB saving events and message broker
- 3 parts
    1. DB like mysql
        - 3 primary tables:
            1. events
                - table for event or message received
                - foreign key to entity
                - Column triggering_event has the message id to remove duplicate message
            2. entities
                - Has latest entity version and used for optimistic lock (update after compare vesion)
                - Create entity =&gt; Add a new line in this table
                - Update entity =&gt; Update column entity_version
            3. snapshots
                - find() will check snapshots
    2. Message broker like Kafka
        - Topic per aggregate like order topic and customer topic
    3. Message relay
        - Copy of events table by replay DB log like binlog in mysql
</code></pre>
<hr>
<h2 id="Chapter-7-Microservice-Data-Query"><a href="#Chapter-7-Microservice-Data-Query" class="headerlink" title="Chapter 7 Microservice Data Query"></a>Chapter 7 <em><strong>Microservice Data Query</strong></em></h2><h3 id="API-Composition-and-CQRS"><a href="#API-Composition-and-CQRS" class="headerlink" title="API Composition and CQRS"></a><code>API Composition and CQRS</code></h3><pre><code>- API Composition
    - Components:
        1. API Composer
            - web app or another service like API gateway
        2. Provider service
    - 3 ways to realize API Composer:
        1. Web app
        2. API gateway to handle
        3. Seperate service only used for query
            - Useful for more complicated query scenario that needs an alone service 
    - Benefits: It a simple way to query data in a microservice architecture
    - Drawbacks: Some queries would result in inefficient, in-memory joins of large datasets.
- Pattern: Command Query Responsibility Segregation (CQRS)
    - Problems API composition facing in some scenarios:
        1. Single service query challenge:
            - Service not supported
            - Undelying DB not supported
        2. Service responsibility isolation
            - copy of data not directly query original data
            - How to implement:
                - Seperate view database only used for R
                - Still has relational DB for CUD and view database subscribed to this relational CUD event
    - Benifits:
        1. Supports multiple denormalized views that are scalable and performant
        2. Improved separation of concerns = simpler command and query models
        3. Necessary in an event sourced architecture
    - Drawbacks:
        1. Increased complexity
        2. Potential code duplication
        3. Replication lag/eventually consistent views
</code></pre>
<hr>
<h2 id="Chapter-8-External-API"><a href="#Chapter-8-External-API" class="headerlink" title="Chapter 8 External API"></a>Chapter 8 <em><strong>External API</strong></em></h2><h3 id="Problems-and-Forces"><a href="#Problems-and-Forces" class="headerlink" title="Problems and Forces"></a><code>Problems and Forces</code></h3><pre><code>- Problem
    - How do the clients of a Microservices-based application access the individual services?
- Forces
    - The granularity of APIs provided by microservices is often different than what a client needs
    - Different clients need different data
    - Network performance is different for different types of clients
    - The number of service instances and their locations (host+port) changes dynamically
    - Partitioning into services can change over time and should be hidden from clients
    - Services might use a diverse set of protocols, some of which might not be web friendly
</code></pre>
<h3 id="API-Gateway-and-backends-for-frontends"><a href="#API-Gateway-and-backends-for-frontends" class="headerlink" title="API Gateway and backends for frontends"></a><code>API Gateway and backends for frontends</code></h3><pre><code>- API gateway
    - Routing request to specific service
    - API composition
    - Protocol switch between like gRPC and HTTP
    - Customized design based on used case
    - Edge function
        1. Identity authentication
        2. Authorization check
        3. Speed control
        4. Cache
        5. Monitoring
        6. Handle requests for Logs
    - Benefits:
        - Insulates the clients from how the application is partitioned into microservices
        - Provides the optimal API for each client
        - Reduces the number of requests/roundtrips. 
        - Simplifies the client by moving logic for calling multiple services from the client to API gateway
        - Translates from a “standard” public web-friendly API protocol to whatever protocols are used internally
    - Drawbacks:
        - Increased complexity
        - Increased response time due to the additional network hop through the API gateway 
        - How implement the API gateway? An event-driven/reactive approach is best if it must scale to scale to handle high loads. On the JVM, NIO-based libraries such as Netty, Spring Reactor, etc. make sense. NodeJS is another option.
- Backends for frontends
    - Every application team has its own API gateway and API gateway specific team own public shared part like edge function (Authenticatio and authorization)
    - Mobile device API gateway, Browser API gateway and public API (for third partner)
- Most existing API gateway frameworkds cannot achieve all functions need including edge function, API composition and routing
    - Spring cloud gateway is a good one
    - GraphQL is another option. Combined with express to build a API gateway service (P272 has the structure and Page279 has the express implementation code)
        - Graph oriented data model and supported query (Type and query)
        - resolvers mapping type and query to service
</code></pre>
<hr>
<h2 id="Chapter-9-and-10-Test-Strategy"><a href="#Chapter-9-and-10-Test-Strategy" class="headerlink" title="Chapter 9 and 10 Test Strategy"></a>Chapter 9 and 10 <em><strong>Test Strategy</strong></em></h2><h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a><code>Summary</code></h3><pre><code>- Test steps
    1. Initialzation
    2. Run test
    3. Compare output and expected
    4. Cleanup
- Test types (金字塔)
    - Unit test (simple and should have more)
    - End to end test (difficult, slow and expensive and should be fewer)
- Pattern:
    - Service Integration Contract Test for REST
        1. (Service consumer like API gateway) Create contracts including HTTP request and expected HTTP response
        2. Using Sping cloud contract to generate tests and testing contracts
        3. Push contracts to Maven
        4. API gateway will use published to Maven contract to test its code
    - Spring cloud contract Test also worked for Publisher and Subscriber
        - Contract contains domain event sample
</code></pre>
<hr>
<h2 id="Chapter-11-Microservice-application-in-Production"><a href="#Chapter-11-Microservice-application-in-Production" class="headerlink" title="Chapter 11 Microservice application in Production"></a>Chapter 11 <em><strong>Microservice application in Production</strong></em></h2><h3 id="Safety"><a href="#Safety" class="headerlink" title="Safety"></a><code>Safety</code></h3><pre><code>- Authentication and Authorization
    - Login Identity
    - Login process
        1. User sent login request with ID and password
        2. LoginHandler verify ID and password. Created conversation
        3. LoginHandler will send back to user with session id
        4. User will use the session for all following request
        5. SessionBasedSecurityInterceptor will handle request and create safety context
        6. Service will use the static safety context to get user identity
    - API gateway can handle authentication in microservice (Single talk)
        1. API gateway verified user identity and sends back JWT(Json web token)
        2. User will always send request with JWT and API gateway can pass JWT to service after verification
    - Spring OAuth can be a better option to replace API gateway to do authentication (Multiple talk in one conversation)
        1. User send login request to API gateway and API gateway will call Spring auth to authenticate user
        2. Spring auth will return session token and refresh token and API gateway will forward it to user (Always in cookie)
        3. User will use both tokens in following request
        4. SessionAuthenticationInterprator in API gateway will verify token and sent it to service
    - 3 best rules for microservice auth:
        1. API gateway is the place authenticate and verify user
        2. API gateway and service use token like JWT to pass user auth info
        3. Service use token to get user identity and role
- Auditing
    - Tracking customer activies
- Process communication safety
    - TLS
</code></pre>
<h3 id="Externalized-configuration"><a href="#Externalized-configuration" class="headerlink" title="Externalized configuration"></a><code>Externalized configuration</code></h3><pre><code>- 2 models to get environmental variables
    1. (Push model) Saved on machine like configure file or operation system variables and newly creating service will pull it from local
    2. (Pull model) Newly creating service will query configuration service
</code></pre>
<h3 id="Observability"><a href="#Observability" class="headerlink" title="Observability"></a><code>Observability</code></h3><pre><code>- Log aggregation
    - ELK
        1. ElasticSearch: log service server (Text search NoSQL DB)
        2. Logstash: log aggregation and write log into ElasticSearch
        3. Kibana: ElasticSearch visualized tool
- Distributed tracing
    - Assigns each external request a unique external request id
    - Passes the external request id to all services that are involved in handling the request
    - Includes the external request id in all log messages
    - Records information (e.g. start time, end time) about the requests and operations performed when handling a external request in a centralized service
- Application metrics
    - Instrument a service to gather statistics about individual operations. Aggregate metrics in centralized metrics service, which provides reporting and alerting. There are two models for aggregating metrics:
        1. push - the service pushes metrics to the metrics service
        2. pull - the metrics services pulls metrics from the service
- Exception tracking
    - Report all exceptions to a centralized exception tracking service that aggregates and tracks exceptions and notifies developers.
</code></pre>
<hr>
<h2 id="Chapter-12-Microservice-Deployment"><a href="#Chapter-12-Microservice-Deployment" class="headerlink" title="Chapter 12 Microservice Deployment"></a>Chapter 12 <em><strong>Microservice Deployment</strong></em></h2><h3 id="Multiple-service-instances-or-single-service-instance-per-host"><a href="#Multiple-service-instances-or-single-service-instance-per-host" class="headerlink" title="Multiple service instances or single service instance per host"></a><code>Multiple service instances or single service instance per host</code></h3><pre><code>- There are various ways of deploying a service instance on a shared host including:
    - Deploy each service instance as a JVM process. For example, a Tomcat or Jetty instances per service instance.
    - Deploy multiple service instances in the same JVM. For example, as web applications or OSGI bundles.
-The drawbacks of this approach include:
    - Risk of conflicting resource requirements
    - Risk of conflicting dependency versions
    - Difficult to limit the resources consumed by a service instance
    - If multiple services instances are deployed in the same process then its difficult to monitor the resource consumption of each service instance. Its also impossible to isolate each instance
</code></pre>
<h3 id="Service-Instance-per-VM"><a href="#Service-Instance-per-VM" class="headerlink" title="Service Instance per VM"></a><code>Service Instance per VM</code></h3><pre><code>- Netflix packages each service as an EC2 AMI and deploys each service instance as a EC2 instance.
- Benefits compared to first:
    - The VM encapsulates the details of the technology used to build the service. All services are, for example, started and stopped in exactly the same way.
    - You don&#39;t need to manual setup Tomcat or JDK and worry about version mismatch because they all are included in the package(image).
- The drawbacks of this approach include:
    - Building a VM image is slow and time consuming
</code></pre>
<h3 id="Service-instance-per-container"><a href="#Service-instance-per-container" class="headerlink" title="Service instance per container"></a><code>Service instance per container</code></h3><pre><code>- Package the service as a (Docker) container image and deploy each service instance as a container
    1. Create dockerfile and generate image
    2. Push image to docker central repository
    3. Create docker container which may download the image from centrl repository
- Benefits:
    - Docker image is smaller compared to VM image and it is fast to generate and deploy
- Drawbacks:
    - Need manual download and update docker containers including language or operating system
</code></pre>
<h3 id="Kubernetes"><a href="#Kubernetes" class="headerlink" title="Kubernetes"></a><code>Kubernetes</code></h3><pre><code>- Main node
    1. kube-apiserver
    2. etcd
    3. kube-scheduler
    4. kube-controller-manager
    5. cloud-controller-manager
- Node Components
    1. kubelet
    2. kube-proxy
    3. Container runtime
- Pods in a Kubernetes cluster are used in two main ways:
    1. Pods that run a single container
    2. Pods that run multiple containers that need to work together
- Service mesh
    - Service deployment and publish seperation
        1. Test new bits in PROD but not routing customer traffic to these new bits
        2. Route small amount of customers traffic to new bits
        3. Increase amount of customer traffic step by step
        4. Once found a problem, revert all prod services back to old version
    - Istio
        - features:
            1. network control
            2. Communication satety
            3. Telemetry
            4. Strategy
</code></pre>
<hr>
<h2 id="Chapter-13-Microservice-refactor-strategies"><a href="#Chapter-13-Microservice-refactor-strategies" class="headerlink" title="Chapter 13 Microservice refactor strategies"></a>Chapter 13 <em><strong>Microservice refactor strategies</strong></em></h2><pre><code>- Main strategies(strangler application):
    1. Make new feature as microsservice
        - API gateway
        - Integration glue code
    2. Front end and back end split
    3. Pull function from monolith service
        - Aspect of function
            0. Incoming request API adapter
            1. Domain model and logic
            2. Outgoing request API adapter like accessing DB
            3. Database
        - Challenges
            1. Decompose domain model
                - Use domain model primary key instead of object as reference like restaurantId to replace restaurant in Order
            2. Refactor database
                - Create new table with same fields for new service
                - Route updates to new table in new service
                - Table in new service will use trigger to update old God class table in monolith service
                - Update all related updates action codes to call new service
        - When to do
            1. Find somewhere needs big change and microservice can speed its development up
            2. Find which part not reliable
            3. Considering module dependency and one part may speed up another part pull
- Designing how the service and the monolith collaborate
    - Main concern is ***DATA INTEGRITY***
    - Communication ways:
        1. Rest API
        2. Messaging and publish and listening mode
    - Designing the integration glue
        - Picking an interaction style and IPC mechanism
        - Implementing an anti-corruption layer
- Maintaining data consistency across a service and a monolith
    - The challenge of changing the monolith to support compensatable transactions
    - Sagas don’t always require the monolith to support compensatable transactions which may be hard and time consuming
    - Sequencing the extraction of services to avoid implementing compe- ensating transactions in the monolith
-  Handling authentication and authorization
    - The monolith’s LoginHandler sets the USERINFO cookie
    - The API gateway maps the USERINFO cookie to the Authorization header
</code></pre>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags icon"></i>
		<ul class="article-tag-list">
			 
        		<li class="article-tag-list-item">
        			<a href="javascript:void(0)" class="js-tag article-tag-list-link color5">tags</a>
        		</li>
      		
		</ul>
	</div>

      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/07/17/Microservice-Pattern/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-Learning-networt-from-top-to-down" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/31/Learning-networt-from-top-to-down/">Learning network from top to down</a>
    </h1>
  

        
        <a href="/2021/05/31/Learning-networt-from-top-to-down/" class="archive-article-date">
  	<time datetime="2021-05-31T23:10:32.000Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-05-31</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Chapter-1-Network-layers-Stack"><a href="#Chapter-1-Network-layers-Stack" class="headerlink" title="Chapter 1 Network layers Stack"></a>Chapter 1 <em><strong>Network layers Stack</strong></em></h2><h3 id="5层因特网协议栈"><a href="#5层因特网协议栈" class="headerlink" title="5层因特网协议栈"></a><code>5层因特网协议栈</code></h3><pre><code>- Application: HTTP, SMTP, FTP and DNS
- Transport: TCP and UDP
- Network or Internet: IP
- Data Link: Ethernet, Wi-Fi
- Physical: Bit
</code></pre>
<hr>
<h2 id="Chapter-2-Application-layer"><a href="#Chapter-2-Application-layer" class="headerlink" title="Chapter 2 Application layer"></a>Chapter 2 <em><strong>Application layer</strong></em></h2><h3 id="Summary-of-application-layer"><a href="#Summary-of-application-layer" class="headerlink" title="Summary of application layer"></a><code>Summary of application layer</code></h3><h4 id="应用程序（计算机进程）和socket（应用程序和网络之间的API）会话"><a href="#应用程序（计算机进程）和socket（应用程序和网络之间的API）会话" class="headerlink" title="应用程序（计算机进程）和socket（应用程序和网络之间的API）会话"></a>应用程序（计算机进程）和socket（应用程序和网络之间的API）会话</h4><pre><code>- 选择运输协议
    1. 分类标准：
        - 可靠数据传输
        - 吞吐量
            - 带宽敏感应用：对吞吐量具有特定的要求
            - 弹性应用：实时利用当时可用的带宽（如电子邮件、文件传输以及Web应用）
        - 定时
            - 低时延vs高时延
        - 安全性
            - 加密、数据完整性和端点鉴别
    2. TCP/IP network provides 2 transport prototype:
        1. TCP: Reliable data transfer
            - SSL(Secure Sockes Layer) is the improvment of TCP and it provides data encryption and decryption while sending message e2e
            - Without SSL send message: Sender program -&gt; Sender TCP socket -&gt; Receiver TCP socket -&gt; Receiver program
            - With SSL send message: Sender program -&gt; Sender SSL socket API -&gt; Sender SSL encrypt message -&gt; Sender TCP socket -&gt; Receiver TCP socket -&gt; Receiver socket API -&gt; Receiver SSL decrypt message -&gt;Receiver program
        2. UDP: Unreliable data transfer
            - No connection handshake as TCP
            - No gurantee of data arrival and arrival sequence
- 设定几个运输层参数（如最大缓存和最大报文长度）
</code></pre>
<h4 id="进程寻址"><a href="#进程寻址" class="headerlink" title="进程寻址"></a>进程寻址</h4><pre><code>1. IP address (主机地址)
2. Port number（主机上的指定接收进程的标识符)
</code></pre>
<h4 id="Popular-application-and-its-prototypes"><a href="#Popular-application-and-its-prototypes" class="headerlink" title="Popular application and its prototypes"></a>Popular application and its prototypes</h4><table>
<thead>
<tr>
<th>Application</th>
<th>Application Prototype</th>
<th>Transport Prototype</th>
</tr>
</thead>
<tbody><tr>
<td>Email</td>
<td>SMTP</td>
<td>TCP</td>
</tr>
<tr>
<td>Remote Open end access</td>
<td>Telnet</td>
<td>TCP</td>
</tr>
<tr>
<td>Web</td>
<td>HTTP</td>
<td>TCP</td>
</tr>
<tr>
<td>File transfer</td>
<td>FTP</td>
<td>TCP</td>
</tr>
<tr>
<td>Steam media like youtube</td>
<td>HTTP</td>
<td>TCP</td>
</tr>
<tr>
<td>Internet phone call</td>
<td>SIP,RTP or special like skype</td>
<td>UDP</td>
</tr>
</tbody></table>
<h4 id="Application-layer-protocol"><a href="#Application-layer-protocol" class="headerlink" title="Application-layer protocol"></a>Application-layer protocol</h4><pre><code>1. Message type: Request and response message
2. Message grammar
3. Message different parts definition and meaning
4. When and how client and server send and recive message and response
</code></pre>
<hr>
<h3 id="Web-and-Http"><a href="#Web-and-Http" class="headerlink" title="Web and Http"></a><code>Web and Http</code></h3><h4 id="HTTP-HyperText-Transfer-Protocol"><a href="#HTTP-HyperText-Transfer-Protocol" class="headerlink" title="HTTP (HyperText Transfer Protocol)"></a>HTTP (HyperText Transfer Protocol)</h4><pre><code>- Concepts
    1. HTTP Client(like web browser) send HTTP request and receives HTTP response from HTTP server(like apache web server)
    2. HTTP is stateless protocol
- Three Hanshakes between client and server based on HTTP and TCP protocol
    1. First handshake: client sends small TCP message for connection request to server
    2. Second handshake: server sends small response TCP message to accept connection
    3. Third handshake: client accept connection and sent HTTP request message
    4. *SUMMARY* Rough Timecost: Two Round-Trip Time(RTT) + Real content(like html file) transfer
        - One RTT for first and second handshakes (Client wants to talk to server and server reponse YES to client round trip)
        - One RTT for third handshake (Client sends request message and receives response message from server)
- non-peristent connection vs persistent connection:
    1. Reduce RTT for first and second handshakes to build connection for every new request
    2. Persistent connection is HTTP 1\.1 and 2 default
</code></pre>
<h4 id="HTTP-message-format"><a href="#HTTP-message-format" class="headerlink" title="HTTP message format"></a><em><strong>HTTP message format</strong></em></h4><pre><code>- HTTP message
    1. HTTP *Request* message format:
        - Request line:
            1. HTTP verbs: GET, POST, *HEAD* (Similar as GET but only used for test trace without real HTTP response message from server), *PUT* (Upload file to specific path on server) and DELETE
            2. URL
            3. HTTP version
        - Header line (lines after first one):
            1. Host: www.abc.com (web proxy cache)
            2. Connection: close (Non-persistent connection and close the connection after current talk)
            3. User-agent: Mozilar (firefox browser)
            4. Accept-language: fr (Frensh as language if not exists in server use default language)
        - Entity body (POST reuqest will have submit form info)
    2. HTTP *Response* message format:
        - status line:
            1. HTTP version
            2. status code
            3. status message
</code></pre>
<table>
<thead>
<tr>
<th>Status CODE</th>
<th>Status MESSAGE</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>200</td>
<td>OK</td>
<td>Success</td>
</tr>
<tr>
<td>301</td>
<td>Moved Permanently</td>
<td>New URL can be found Header line location</td>
</tr>
<tr>
<td>400</td>
<td>Bad Request</td>
<td>Request not accepted by server</td>
</tr>
<tr>
<td>404</td>
<td>Not Found</td>
<td>Document cannot be found on server</td>
</tr>
<tr>
<td>505</td>
<td>Http version not supported</td>
<td>server not support current request HTTP version</td>
</tr>
</tbody></table>
<pre><code>        - Header line:
            1. Connection: close =&gt; (Non-persistent connection and tell client will close the connection after current talk)
            2. Date: Tue, 18 Aug 2015 blah blah =&gt; (Server found object and insert it into repsonse message datetime)
            3. Server: Apache/2.2.3 (Centos) =&gt; (like user agent in request message)
            4. Last modified: DATE_TIME =&gt; (Important for cache to know last content modified in server which may need refresh cache)
            5. Content-Length: int number
            6. Content-Type: HTML
        - Entity body
    3. Request and Response message can have a lot of different Header line and based on requirement and real use case.
</code></pre>
<h4 id="Web-cache"><a href="#Web-cache" class="headerlink" title="Web cache"></a>Web cache</h4><pre><code>- Cookie
    1. Request and response message will have cookie header line =&gt; cookie: COOKIE_ID
    2. Browser will save &quot;SITE_URL: ID&quot; into cookie for future same site load
    3. Server will also save user: COOKIE_ID pair into database
- Web proxy server
    1. A proxy server will answer local network requests(like school). If not hit cache, send request to real original server
    2. Keep last-modified date on proxy server and will check if cache has been out-of date
        - Add &quot;If-modified-since: LAST_MODIFIED_DATE&quot; as Header line in request message
        - If Server responds &quot;HTTP/1.1 304 Not Moified&quot; in response Header line, entity body will be empty. Use cached object.
</code></pre>
<hr>
<h3 id="Email-and-SMTP"><a href="#Email-and-SMTP" class="headerlink" title="Email and SMTP"></a><code>Email and SMTP</code></h3><h4 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h4><pre><code>- 3 parts:
    1. User agent
    2. Mail server
    3. SMTP (Simple Mail Transfer Protocol)

- Email send and receive process:
    1. Sender writes message and receiver email address using *User Agent* program
    2. Sender *User Agent* sends message to its *Mail Server* and message will be saved into message queue
    3. Sender *Mail Server* finds this message and will try to create a TCP connection to receiver *Mail Server*
    4. After initial handshakes between sender *Mail Server* and receiver *Mail Server*, message will be sent to receiver&#39;s *Mail Server*
    5. Receiver *Mail Server* will save this message to receiver&#39;s *Inbox*
    6. Receiver can use its username and password to access its *Inbox* and saw the message from sender
</code></pre>
<h4 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h4><pre><code>- Have to translate 0 and 1 media stream data into ASCII for sending email message because SMTP is an old protocol and there are not many image and video when email was firstly created.

- Handshake Commands sent from user agent(Client) to server(S):
    1. HELO (Short for Hello)
    2. MAIL FROM
    3. RCPT TO
    4. DATA (Message Body)
    5. QUIT

- SMTP vs HTTP:
    1. Push Protocol vs Pull Protocol
        - SMTP talk is initialized by sender (send email to server)
        - HTTP talk is initialized by receiver (Get document from server)
    2. SMTP required 7 bit ASCII and need translate everything into ASCII if they are not originally like image. It is ***NOT*** requirement for HTTP
    3. SMTP put all objects into one response message vs HTTP put every object into its own response message

- SMTP message format:
    * Header lines
        1. From: SENDER_EMAIL_ADDRESS
        2. To: RECEIVER_EMAIL_ADDRESS
        3. Subject: EMAIL_SUBJECT
        4. other optional Header lines
    * New line 
    * Message body data (ASCII)                       

- Reason why we need 2 mail servers between sender and client user agent
    1. First mail server (Sender) is existing for keeping retry in case receiver server is not on
    2. Second mail server (Receiver) is existing because we need one server always on to receive new emails

- 3 popular mail access protocols (SMTP is only used for push message and we need pull protocol for client to get emails)
    * POP3 (Post Office Protocol-Version 3)
        1. Authoriztion: use username and password to setup connection to mail server
        2. Event process: Get response messages from mail server and also mark emails messages that need to be deleted 
            - Delete message from server after download =&gt; User cannot access message from other device anymore. Only in first download device locally 
            - Keep message after download
        3. Refresh
    * Internet Mail Access Protocol
        - Add remote server folders and search functions (POP3 NOT)
        - Return part of the email message (like subject)
    * HTTP   
        - Sender use HTTP to send message to mail server
        - Receiver received HTTP response messsage from mail server      
</code></pre>
<h3 id="DNS-Domain-Name-System"><a href="#DNS-Domain-Name-System" class="headerlink" title="DNS (Domain Name System)"></a><code>DNS (Domain Name System)</code></h3><h4 id="DNS-Summary"><a href="#DNS-Summary" class="headerlink" title="DNS Summary"></a>DNS Summary</h4><pre><code>- Layered DNS server
- Distributed database application protocol for hostname searching 
- Also Application layer protocol:
    1. End to end communication in client - server mode
    2. Use transport layer to send message between DNS client and DNS server
- Example of how DNS has been used in browser:
    1. DNS application client is running on the same machine
    2. User enter &quot;www.someschool.edu&quot; in browser and browser will call DNS client application
    3. DNS client will send request to DNS server for the host name passed in
    4. DNS client will receive a response message including the IP address DNS server found by host name
    5. Browser will talk to the server using TCP connection by IP address and port like 123.0.123.3:80            
- Other features DNS provided:
    1. Host aliasing
    2. Mail server aliasing
        * Mail server aliasing can be same as host like yahoo.com is domain also the mail 
    3. Load balancing:
        * DNS server will has a list of IP addresses for one single domain host name. When request comes in, it can do round-robin in the list of IP or even more complicated load distribution logic.            
- DNS is Distributed Database
    1. Root DNS Server
    2. TLD (Top-Level Domain) DNS Server
        * top level domain like com, org, net, edu and gov
        * region domain like fr, uk, ca and jp
    3. Authoritive DNS server like big company and schools will maintain
- Recursive query vs Iterative query
    1. Recusive query is sent by myself
    2. Iterative query is sent on behalf original request sender
    3. In real world: First request is always recursive and following requests are iterative. 
- DNS cache:
    1. For every request, every DNS server in the path of IP DNS query will keep the record for TTL (Normally 2 days) 
- DNS Resource Record and message:
    1. (Name, Value, Type, TTL)
    2. Type=A: (relay1.bar.foo.com, 145.96.03.126, A)
    3. Type=NS: (foo.com, dns.foo.com, NS)
    4. Type=CNAME: (foo.com, relay1.bar.foo.com, CNAME)        
    5. Type=MX: (foo.com, mail.bar.foo.com, MX)
        * MX makes company web server and mail server having same alternate host name (foo.com)
        * For getting mail server formal host name, client neeeds send request for MX record
        * For getting other server formal host name, client needs send request for CNAME record
    6. For server having an NS record but not the authoritive DNS server withIP , there will always be a Type A record for dns NS record              
- DNS request and response message
    1. Header: 12 byte
    2. Question:
        * Host name
        * Type like A or MX
    3. Answer:
        * It may contain several Resource Records like multiple IP address for same host name     
    4. Authoritive 
    5. Additional info: like for MX request, it will have a Type A RR for formal hostname IP address  
</code></pre>
<h3 id="P2P-Document-transfer"><a href="#P2P-Document-transfer" class="headerlink" title="P2P Document transfer"></a><code>P2P Document transfer</code></h3><h4 id="BitTorrent"><a href="#BitTorrent" class="headerlink" title="BitTorrent"></a>BitTorrent</h4><pre><code>- Every one in the BitTorrent can be uploader and downloader
    1. Reduce the single server uploading time and duplicate work. Every one in the network having file can send its document to someone who needed it
- Process:
    1. When you join the torrent, you will register in tracker and periodly report active. You will also get a list of users (50) in the torrent.
    2. When you need a chunk(256KB), you will receive it from another user in the torrent. If it is a rare one, it will be prioritize the chunn in the list of needed chunks. This is for balance to have fewer rare chunk in the torrent
</code></pre>
<h3 id="Video-streaming-and-CDN"><a href="#Video-streaming-and-CDN" class="headerlink" title="Video streaming and CDN"></a><code>Video streaming and CDN</code></h3><h4 id="HTTP-and-DASH-for-video-stream"><a href="#HTTP-and-DASH-for-video-stream" class="headerlink" title="HTTP and DASH for video stream"></a>HTTP and DASH for video stream</h4><pre><code>- DASH (Dynamic Adaptive Streaming over HTTP)
    1. User cache all video files chunk in Bit. If user has better network, it can download higher quality video file with more stream bits.
    2. The quality can also change based on how many files cached on client user side and internet speed change =&gt; Dynamic and Adaptive
    3. HTTP server has a manifest file which will include all info about different quality and bit rates vs its specified URL
</code></pre>
<h4 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h4><pre><code>- 2 straties: 深入和邀请做客
    1. 深入 Build more clusters into ISP (Internet service provider) =&gt; High maintenance cost
    2. 邀请做客 Only build cluster in IXP (Internet exchange pointer) =&gt; low cost but user may suffer high delay
- CDN operations and request process:
    1. When user enter http://video.blah.com/6Y7B23V in browser, it will send a DNS request for video.blah.com
    2. blah.com authoritive DNS server will not send an IP address directly after found &quot;video&quot; in the domain name. It will send its CDN provider domain name like a1105.KingCND.com
    3. User LDNS will send second DNS request for the CND provider domain name return in previous step. It will receive a CDN endpointer IP address
    4. User can generate TCP connection with CDN endpointer and get video
- CDN cluster selection strategy: pick cluster after received request from user
    1. Geographically closest: it may not be the closest one because network path or network bandwidth
    2. Real-time measurement: based on current network bandwidth. This needs period ping message for every cluster LDNS to test. The bad side is that some cluster may not respond to HeartBeat test.        
</code></pre>
<h4 id="UDP-client-and-server-in-python"><a href="#UDP-client-and-server-in-python" class="headerlink" title="UDP client and server in python"></a>UDP client and server in python</h4><ul>
<li>UDPClient.py</li>
</ul>
<blockquote>
<p>from socket import *<br>serverName = ‘hostname’<br>serverPort = 12000<br>clientSocket = socket(AF_INET, SOCK_DGRAM)<br>message = raw_input(‘Input lowercase sentence:’)<br>clientSocket.send(message.encode(), (serverName, serverPort))<br>modifiedMessage, serverAddress = clientSocket.recvfrom(2048)<br>print(modifiedMessage.decode())<br>clientSocket.close()</p>
</blockquote>
<ul>
<li>UDPServer.py</li>
</ul>
<blockquote>
<p>from socket import *<br>serverPort = 12000<br>serverSocket = socket(AF_INET, SOCK_DGRAM)<br>serverSocket.bind(‘’, serverPort)<br>while True:<br>&nbsp;message, clientAddress = serverSocket.recvfrom(2048)<br>&nbsp;modifiedMessage = message.decode().upper()<br>&nbsp;serverSocket.send(modifiedMessage.encode(), clientAddress)</p>
</blockquote>
<ul>
<li>TCPClient.py</li>
</ul>
<blockquote>
<p>from socket import *<br>serverName = ‘servername’<br>serverPort = 12000<br>clientSocket = socket(AF_INET, SOCK_STREAM)<br>clientSocket.connect((serverName, serverPort))<br>message = raw_input(‘Input lowercase sentence:’)<br>clientSocket.send(message.encode())<br>modifiedMessage = clientSocket.recvfrom(2048)<br>print(“From server: “, modifiedMessage.decode())<br>clientSocket.close()</p>
</blockquote>
<ul>
<li>TCPServer.py</li>
</ul>
<blockquote>
<p>from socket import *<br>serverPort = 12000<br>serverSocket = socket(AF_INET, SOCK_STREAM)<br>serverSocket.bind(‘’, serverPort)<br>serverSocket.listen(1)<br>print(“The server is ready to receive”)<br>while True:<br>&nbsp;connectionSocket, addr = serverSocket.accept()<br>&nbsp;message = connectionSocket.recvfrom(2048).decode()<br>&nbsp;modifiedMessage = message.upper()<br>&nbsp;connectionSocket.send(modifiedMessage.encode())<br>&nbsp;connectionSocket.close()</p>
</blockquote>
<h2 id="Chapter-3-Transport-layer"><a href="#Chapter-3-Transport-layer" class="headerlink" title="Chapter 3 Transport layer"></a>Chapter 3 <em><strong>Transport layer</strong></em></h2><h3 id="Summary-of-transport-layer"><a href="#Summary-of-transport-layer" class="headerlink" title="Summary of transport layer"></a><code>Summary of transport layer</code></h3><h4 id="Transport-vs-Network"><a href="#Transport-vs-Network" class="headerlink" title="Transport vs Network"></a>Transport vs Network</h4><pre><code>- Use mail and post service as similar example
    1. Message from application = Content on one page
    2. Process = every sibling
    3. Host = family
    4. Transport protocol = Ann and Bill (Represent of family for picking  up mails and put them into post mailbox)
    5. Network protocol = post service
- IP: unreliable service and best-effor delivery service for segment and message delivery between 2 hosts
    1. Not guarentee message will be delivered
    2. Not guarentee messages will be delivered in same sequence as sent
    3. Not guarentee message delivered have all correct data as sent
- UDP is also unreliable. Service provided:
    1. transport-layer multiplexing on sender sideand demultiplexing on receiver side
    2. Error detection and correction but no gurantee on data integrity and sequence like IP
- TCP provides extra service than UDP:
    1. Reliable data transfer
    2. Congestion control
</code></pre>
<h4 id="Multiplexing-and-Demultiplexing"><a href="#Multiplexing-and-Demultiplexing" class="headerlink" title="Multiplexing and Demultiplexing"></a>Multiplexing and Demultiplexing</h4><pre><code>- NO connection Multiplexing (UDP):
    1. Sender will include origin (sender) port number and destination (receiver) port number into its sent message. 
    2. Receiver will use the destination port number to find which socket to pass message and use IP address and origin port number to send response. 
- Connection Multiplexing (TCP):
    1. (Origin IP, Origin port number, Dest IP, Dest port number) will be the key to distinguish socket on receiver side. If requests have same identifier with these 4 values, they can use same socket. Otherwise create a new one for latter request
    2. There is a specific port for accepting connection request. After accepting the connection request, server will build a new connection socket with a new port, origin IP address and port number for following message transport.
</code></pre>
<h3 id="UDP"><a href="#UDP" class="headerlink" title="UDP"></a><code>UDP</code></h3><h4 id="Summary-and-characteristics"><a href="#Summary-and-characteristics" class="headerlink" title="Summary and characteristics"></a>Summary and characteristics</h4><pre><code>- UDP is simple and only added the necessary function Multiplexing over IP (network protocol)
- UDP vs TCP:
    1. Application has more control on when to send data and what data it will be like
        * TCP has conjection control and need resend message to make sure message arrival on dest
    2. No need for connection before sending message
        * TCP needs 3 handshakes for connection before building channel for sending message
    3. UDP message will not include status info
        * TCP needs include flags or more info like sequence number in message
    4. Shorter header than TCP
- UDP can be used in application that has no requirement on sending accurate data and data integrity. Application can suffer data loss. 
- UDP Message:
    1. HEADER:
        * source port number | destination port number
        * length of Header and message | check sum
    2. Application data (message)               
- Check sum:
    1. (Bit sum) source port number + dest port number + lenght + check sum 
    2. Reverse 1 and 0
    3. (Expected check sum result is 16 bits of 1)If any bit is not zero, it means it has some error =&gt; Discard data
</code></pre>
<hr>
<h4 id="GBN-回退N步-and-SR-选择重传"><a href="#GBN-回退N步-and-SR-选择重传" class="headerlink" title="GBN (回退N步) and SR (选择重传)"></a>GBN (回退N步) and SR (选择重传)</h4><pre><code>- Sender steps

    1. Receive data from upper level:
        - Add header and send package IF package sequence number is within window
        - IF package sequence number has been out of range of current window, save the package from upper layer into queue for cache
    2. Timer and overtime
        - For SR, every package needs its own timer to calculate if it has been overtime and needs resend package since no response has been received in time
    3. Received ACK message from receiver
        - ACK send_base sequence nbr package: increase send_base to minimum number that has not been marked as RECEIVED. Move the window in sequence and send all packages that have not been sent
        - ACK NOT send_base sequence nbr package: mark it as RECEIVED if it is within window

- Receiver steps

    1. Package sequence nbr in [rev_base, rev_base + window.length - 1] (current minimum + window): 
        - nbr is rev_base: send all cached packages and this one to upper listener. 
        - nbr is NOT rev_base: cache the package and waiting for rev_base one and send to listener later
    2. Package sequence nbr in [rev_base - window.length, rev_base - 1] (current minimum - window):
        - Already received package and send ACK to no matter sender already marked it as RECEIVED or not
    3. Discard package in all other cases

- Sender and Receiver

    - Sender and Receiver may always see different window
    - SECOND point in RECEIVER steps is import because if sender keeps losing ACK signal from receiver. The sliding window may never slide.
    - window length &lt;= sequence number total count / 2 =&gt; Otherwise receiver may not be able to tell if new package coming in is resending old one or a totally new one(they may share same sequence number)
</code></pre>
<hr>
<h3 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a><code>TCP</code></h3><h4 id="TCP-Connection"><a href="#TCP-Connection" class="headerlink" title="TCP Connection"></a>TCP Connection</h4><pre><code>a. Components for TCP connection:
    - Sender Process (client): buffer for sending messages, send_base variable, and socket
    - Receiver Process (server): buffer for receiving messages, receive_base variable, and socket
b. *** 3-way handshakes ***
    1. client send (***1st***) TCP segment message to require connection
    2. server will respond with a special TCP segment message (***2nd***) to accept connection
    3. After connection built, client can keep sending messages (***3rd***) through the TCP channel. Only 3rd message will contain real application data.
c. TCP segment (32 bits):
    1. 16 bits of source port number and 16 bits of dest port number
    2. sequence number for a segment
        - Actual start bit count number of real message data flow
    3. ACK number
        - received sequence number + 1 (next expected received bit sequence number)
    4. 4 bits header length field, unused space, 6 bit flag field and receive window field 
        - flag field includes ACK bit for confirmation of received one segment 
</code></pre>
<hr>
<h3 id="TCP-reliable-data-transportation-implementation"><a href="#TCP-reliable-data-transportation-implementation" class="headerlink" title="TCP reliable data transportation implementation"></a><code>TCP reliable data transportation implementation</code></h3><h4 id="Simplified-TCP-sender-logic"><a href="#Simplified-TCP-sender-logic" class="headerlink" title="Simplified TCP sender logic"></a>Simplified TCP sender logic</h4><pre><code>NextSeqNum = InitialSeqNumber
SendBase=InitialSeqNumber

while (true) &#123;
    switch (case):
        CASE received signal from upper program to send data:
            if (timer not started) &#123;
                start timer 
            &#125;
            send message to IP
            NextSeqNum += length(data)
            break;

        CASE timer expired and no ACK received:
            resend the minimum sequence number of segment data
            restart timer
            break;

        CASE received ACK nad ACK y (y is next expected sent data sequence nbr):
            if (y &gt; SendBase) &#123;
                SendBase = y
                if (there is any segment not received ACK) &#123;
                    start timer
                &#125;
            &#125;
            else &#123; /*Duplicate ACK for received data which means following data between y and sendbase has lost */
                y&#39;s duplicate ACK += 1
                if (y == 3) &#123;
                    /* fast retransmit */
                    resend segment with sequence nbr y
                &#125;
            &#125;
            break;
&#125;
</code></pre>
<h4 id="Other-points-on-how-to-make-reliable-data-transmission-with-TCP"><a href="#Other-points-on-how-to-make-reliable-data-transmission-with-TCP" class="headerlink" title="Other points on how to make reliable data transmission with TCP"></a>Other points on how to make reliable data transmission with TCP</h4><pre><code>a. sender code above
b. Double TimeoutInterval when losing package ACK and timer timeout:
    - This will resolve the problem when network stuck but still try to resent same data and make network worse
c. fast retransmit when there are duplicate ACK
d. flow-control service
    - Sender send data speed should match with receiver receive speed
    - receive window: rwnd = RvcBuffer - [LastByteRecvd - LastByterRead]
    - Trick: if receiver&#39;s buffer is full, it will let sender know &quot;rwnd = 0&quot;. Sender will not stop sending data. Instead it will send a one-byte segment to keep pinging sender until sender as receiver buffer is cleaned up. It will resume sending segments. Otherwise receiver will never know when sender buffer will be cleaned up.
</code></pre>
<h4 id="Start-TCP-3-way-handshake-and-segments"><a href="#Start-TCP-3-way-handshake-and-segments" class="headerlink" title="Start TCP 3-way handshake and segments"></a>Start TCP 3-way handshake and segments</h4><pre><code>1. Client send TCP SYN connection segment
    - SYN=1, seq=client_isn
2. Server send TCP SYNACK connection segment
    - SYN=1, seq=server_isn, ack=client_isn+1
    - Server allocates buffer and other variables
2. Client send TCP SYNACK connection segment
    - SYN=0, seq=client_isn+1, ack=server_isn+1    
    - Client allocates buffer and other variables            
</code></pre>
<h4 id="Stop-TCP-connection"><a href="#Stop-TCP-connection" class="headerlink" title="Stop TCP connection"></a>Stop TCP connection</h4><pre><code>1. Client sends FIN segment (FIN_BIT=1)
    - client closes connection on its side
2. Server sends ACK for client FIN
3. Server send its own FIN segment (FIN_BIT=1)
    - server closes connection on its side
4. Client sends ACK for server FIN
    - Wait for 30s or some customized time period
</code></pre>
<h4 id="Congestion-control"><a href="#Congestion-control" class="headerlink" title="Congestion control"></a>Congestion control</h4><pre><code>- Signals and meaning:
    1. Package lost means congestion: 3 duplicate ACK or timeout once
    2. ACK means can increase send speed
- Congestion control Algorithms:
    1. slow-start:
        - start with one single minimum length message and test if receive ACK. If ACK received each time, double the sending message count.
        - Once one package is marked as lost (3 duplicate ACK or timeout): go back to one single message set cwnd / 2 as threshold. Should not increase speed over the threshold
    2. Once message count reached to threshold again. Increase one for each ACK and update threshold to cwnd / 2 once receiver another 3 duplicate ACK.
</code></pre>
<hr>
<h3 id="Network-layer"><a href="#Network-layer" class="headerlink" title="Network layer"></a><code>Network layer</code></h3><h4 id="Data-plane-转发"><a href="#Data-plane-转发" class="headerlink" title="Data plane (转发)"></a>Data plane (转发)</h4><pre><code>- Router internal routing from one input port to another output port
- Finished in hardware layer because of ns speed requirement
- Longest prefix matching rule: IP address match more than one prefix in IP routing table
- Include 3 parts:
    1. Input port
    2. Exchange structure: search routing table and send package to output port 
    3. Output port
- Input port and output port queue management:
    1. FIFO
    2. Priority Queue: FIFO within same priority
    3. round robin queuing discipline (most popular in current routers): Rount robin predefined queues. 
- DHCP (Dynamic Host Configuration)
    1. DHCP discover message (dest =&gt; 255.255.255.255; source: 0.0.0.0)
    2. DHCP offer message (Recommended IP for client)
    3. DHCP request message (Client pick one and send it back to server)
    4. DHCP ACK message
- NAT (Network Address Translation)
    1. NAT router has an internal NAT tranlation table with records of randomly generated port number and machine port number match. 
    2. All messages sent out from router will use the randomly generated port number.
    3. NAT router will use translation table to translate port number and route message to internal machine.
- General data plane
    1. A general data translation table for match(link, IP, TCP) and action (transfer, discard, rewrite bits of message)    
</code></pre>
<h4 id="Control-Plane（路由选择）"><a href="#Control-Plane（路由选择）" class="headerlink" title="Control Plane（路由选择）"></a>Control Plane（路由选择）</h4><pre><code>- Global routing from one address to another address outside of router    
- Finished in software layer 
    1. Software-Defined Networking (SDN)
- Every router control(distributed control) vs central control
- Routing algorithm:
    1. Centralized routing algorithm vs distributed routing algorithm
        - Centralized needs all Link State in the whole network
            1. Dijkstra: traverse all nodes and in every round, find the node with minimum D[i] (D is array of distance between start node and current node) NOT visited
        - Distributed doesn&#39;t need all info from the whole network. Every router has its own cost estimate, and use recursion to calculate.
            1. DV (Distance Vector): Update own routing table everytime any neighbor node send updates (Any change in distance vertor)
    2. Static vs Dymaic routing algorithm
    3. Load-sensitive vs load-incensitive routing algorithm
- OSPF in intra-AS (Autonomous System)
    1. intra-autonomous system routing protocol
    2. Dijkstra in local AS like every ISP itself
- BGP (Border Gateway Protocol 边际网关协议) 
    - inter-autonomous system routing protocol
    - Most important protocol (same as IP) to linking thousands of different ISP
    - AS External BGP (eBGP) vs AS Internal BGP (iBGP)
    - route includes BGP attribute and prefix
        1. IP of NEXT-HOP (Start router IP address)
        2. Next path
            - AS2 AS3
        3. Prefix                
        4. &quot;IP: AS2 AS3; x&quot; 
    - BGP Route pick algorithm:
        1. Local preference which may be learned by another router within same AS
        2. Shortest AS-PATH not router
        3. Hot potato routing: fewest router need pass to next AS  
- How to register a new DNS domain:
    1. Get IP address range (/24) from ISP (Your Internet service provider)
    2. Buy a domain and bind your DNS server IP address
    3. ISP will use BGP broadcast IP address
</code></pre>
<h4 id="SDN"><a href="#SDN" class="headerlink" title="SDN"></a>SDN</h4><pre><code>- 4 features:
    1. Transfer based on flow:
        - Compared with router based on IP address, SDN can transfer package based on 11 different header bits in package header
    2. Split data plane and control plane
        - Data plane: switch
        - Control plane: server and its running software used for determining and managing flow chart in switch 
    3. Network control feature is outside of switch 
    4. Programmable network functions in software level            
- Functions:
    1. Communication between SDN controller and swiches controlled by controller
    2. Network state management including state updates and recalculate after new state update
    3. REST API for higher level network application like route picker         
</code></pre>
<h4 id="ICMP"><a href="#ICMP" class="headerlink" title="ICMP"></a>ICMP</h4><pre><code>- Used for communication between PC and router
- Typically used for error detection
</code></pre>
<h4 id="Network-management-and-SNMP-Simple-Network-Management-Protocol"><a href="#Network-management-and-SNMP-Simple-Network-Management-Protocol" class="headerlink" title="Network management and SNMP (Simple Network Management Protocol)"></a>Network management and SNMP (Simple Network Management Protocol)</h4><pre><code>- Key parts:
    1. Managing server
    2. Managed device
    3. MIB (Management Information base)
        - Counter like couter of bad IP data
        - Managed device will update MIB
    4. Network management agent:
        - Communication between Managing server and MIB
    5. Netwrok management protocol:
        - It will not manage devices but it is the protocol for network adminitrator to manage the system
        - SNMP            
</code></pre>
<hr>
<h2 id="Link-layer"><a href="#Link-layer" class="headerlink" title="Link layer"></a><code>Link layer</code></h2><h3 id="Link-layer-summary"><a href="#Link-layer-summary" class="headerlink" title="Link layer summary"></a>Link layer summary</h3><pre><code>- Link layer provided services:
    1. framing
        - wrap network layer data and include link layer header
    2. MAC (Medium Access Control)
        - MAC protocol is useful when there are multiple nodes listening on same link
    3. Reliable data transmission
    4. Error detection and correction
- Link layer is mostly living in Network Adapter or called Network Interface Card (NIC 网卡)
    - Nowadays, network interface card has been included in main board 
</code></pre>
<h3 id="Error-detection-and-correction"><a href="#Error-detection-and-correction" class="headerlink" title="Error detection and correction"></a>Error detection and correction</h3><pre><code>1. 奇偶校验
2. checksum
3. CRC (Cyclic Redundancy Check) most used
    - Also called polynominal code
    - D * 2^r XOR R = nG
    - D: data bits
    - R: CRC bits R = D * 2^r % G
    - G: Internation standards known number
</code></pre>
<h3 id="Multiple-access-link-and-protocol"><a href="#Multiple-access-link-and-protocol" class="headerlink" title="Multiple access link and protocol"></a>Multiple access link and protocol</h3><pre><code>1. point to point link
2. broadcast link
    - 3 types of protocols:
        1. Channel partitioning protocol
            - TDM: TimeFrame / N nodes
            - FDM: R bps / N nodes
            - CDMA (Code Division Multiple Access): Every node use its own special way to Code message and receiver knows how to revert it back 
        2. Random access protocol
            1. ALOHA
                - Don&#39;t do carrier senseing collision detection
                - When collision happened, always retransmit at possibility p and (1 - p) wait for another time slot
            2. CSMA(Carrier Sense Multiple Access) and CSMA / CD (Collection Detection)
                - Carrier sensing: before transmission, it will listen on broadcast channel. It will wait until channel becomes quiet and send its own message
                - Collection Detection: while sending message, if node heard another node sending message signal. It will give up immediately and wait for a random time slot before resend message
                - Binary exponential backoff: the random time slot will be picked up randomly from &#123;0, 1, 2, ...., 2^n - 1&#125;. The more times collision happened, the above combination will be larger.
        3. taking-turns protocol
            1. Polling protocol: main node asking every node and behave like administrator
            2. token-passing protocol: nodes passing token
3. LAN (Local Area Network)
    - MAC addresss
        - MAC Address will never change
        - IP Address is like mailing address. It will change while you are moving
        - Broadcast MAC address: FF-FF-FF-FF-FF-FF
        - Only PC or router have MAC address. Not switch
    - ARP (Address Resolution Protocol)
        - IP and MAC relation
        - Local network: search ARP table on its own machine and find MAC address and put it in link data
        - Outside network: need find first router address in ARP table
    - Ethernet frame
        1. Data
        2. Target MAC address
            - Adapter only accept message with its MAC address or broadcast address
        3. Source MAC address
        4. Type
            - Translate message for upper level protocol (like IP in network layer)
        5. CRC
        6. Preamble
            - First 7 bytes are 10101010 used by receiver adapter to calculate link layer transmission speed
            - Last byte is 10101011 and last 2 bits are 11 to inform real data coming in     
    - Switch (More popular for LAN because of having better performance than broadcast)
        - Transparent to server or router. Server is not asking switch for address
        - How switch works:
            1. Filtering
                - Switch tale: MAC Address, Port, saved time 
            2. forwarding
                - No record for MAC Address in switch table =&gt; broadcast to all ports excluding incoming port
                - Has record for MAC address
                    1. record port == incoming port =&gt; discard message (It has been broadcast before. Duplicate)
                    2. record port != incoming port =&gt; save message to record port sending message queue
        - Self-learning:
            1. Empty at first
            2. Every message received, one record with MAC Address, Port and time will be saved in swtich table
            3. After some aging time, old records will be deleted automatically. Removed PC records will be retired in this way.
        - Compared to router:
            - Switch: 
                1. Plug and play device
                2. Used for fewer PC like hundreds machines LAN
            - Router:
                1. Route optimization
                2. Better protection and data seperation to reduce broadcast
                3. Used for larger network
        - VLAN 
            - Use software to create groups of ports
</code></pre>
<h3 id="Example-of-making-web-request-process"><a href="#Example-of-making-web-request-process" class="headerlink" title="Example of making web request process"></a>Example of making web request process</h3><pre><code>1. Preparing DHCP, UDP, IP and Ethernet
    - IN SHORT: send DHCP UDP message to get IP address from router DHCP ACK 
    - DHCP request to get an IP address from router connected to ISP provider
    - IP datagram including the DHCP request will be wrapped into an ethernet frame with broadcast MAC also with its own MAC address
    - Router received the message and decrypt it into UDP segment and it will allocate one IP for the request user. Create an UDP segment(DHCP ACK) and compose it into an IP datagram and ethernet frame back to request user with MAC address.
    - Switch is self-learning and has saved the user MAC and port relationship. It will send the frame back to user
2. Preparing DNS and ARP
    - User PC already knows the its LAN router IP address and its ISP DNS server IP address. It needs get IP address from ISP DNS server by url. It does not know its LAN router MAC address
    - It will send a broadcast ARP message to its LAN router and gets response from there. In previous DHCP message, it does not include router MAC address.  
3. Routing to DNS Server and Get IP address from url
4. TCP and HTTP
    - 3 handshakes for TCP connection
</code></pre>
<hr>
<h2 id="Security"><a href="#Security" class="headerlink" title="Security"></a><code>Security</code></h2><h3 id="Security-Summary"><a href="#Security-Summary" class="headerlink" title="Security Summary"></a>Security Summary</h3><pre><code>- Scure communication features:
    1. Confidentiality
        - PlainText =&gt; CipherText with Encryption Algorithm
        - 2 key systems:
            1. Symmetric key system
            2. Public key system
                - RSA: Pick public key numbers and use mod to calculate
                - Session key: RSA is too much for whole message. Encrypt session key only
    2. Message integrity
        - MD5 and SHA-1 (Cryptographic hash function)
        - MAC (Message Authentication Code) used authentication key to generate
        - MAC and Digital Signature
            - They both use hash function to get constant length hashed value.
            - MAC does NOT use key to encrypt message but Digital Signature will use private key to encrypt hashed value generated by hash function
        - (SSL) Public key certification
            1. CA (Certification Authority) verify one authority&#39;s (person or router) real identity 
            2. Once passed verification, CA will create a certificate for its authority as a binding between it and its real idetity
            3. Authority can use its certificate from CA to to digital signature to claim its identity
        - Allowed subject name and allowed issuer name (CA) are always used in coding to verify whether cert is valid 
    3. end-point authenticaiton
        - Need confirm 2 things while create conversation between 2 ends:
            1. I am talking to someone who claimed he is
            2. Person I am talking to is still active
        - Strategy like (TCP)
            1. Client sends request 
            2. Server responds with a nounce (unique number and will never be duplicate)
            3. Client will use symmetric key (which is only known by client and server) to encrypt the nounce and responds to server
            4. Server can verify the response from client by decrypting the response message with nounce it sent before
    4. Operational security
</code></pre>
<h3 id="Network-Security-Examples"><a href="#Network-Security-Examples" class="headerlink" title="Network Security Examples"></a>Network Security Examples</h3><pre><code>1. Email
    - Confidentiality
        1. Generate random symmetric key
        2. use the symmetric key to encrypt message
        3. use the receiver public key to encrypt symmetric key in step 1 and send it with encrypted message as well
        4. receiver will use its private key to decrypt the symmetric key and decrypt the message using the decrpted symmetric key 
    - Message integrity and end-point authenticaiton
        1. Hash
        2. Private key encrypt hash value and send encrypted hash value with message together
        3. Receiver descrpty message by public key and compare result with using same hash function on message
2. SSL TCP Connection
    - How it is working:
        1. Client sent server its algorithms list and a nounce (Unique random number)
        2. Server pick a symmetric algorithm, key algorithm (for encrypt) and a MAC algorithm (for integrity). Server will send back its certificate and a nounce from server including the algorithm selection
            - Nounce will prevent anyone who can get all messages for a TCP connection and try to resend later. Because every TCP connection will have a different nounce in order to have a different key . 
        3. Client verified the cert and get the server public key. Generate a PMS (Pre-Master Secret) and encrypt it using server public key.
        4. Decrypt message using private key. Get 4 keys using same function from same nounce and PMS.
        5. Client sends all handshake messages in one MAC
        6. Server also sends all handshake messages in one MAC
            - last 2 steps can prevent any modification because it will send all handshake message including it sent before. If any sent message has been changed by middle man, TCP connection will stop
    - SSL message record:
        - Type: TCP connection or real data messaage
        - Version
        - Data length
        - Data
        - MAC (Data and MAC will be encrypted)
</code></pre>
<hr>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/05/31/Learning-networt-from-top-to-down/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
    <article id="post-hello-world" class="article article-type-post  article-index" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/05/31/hello-world/">Hello World</a>
    </h1>
  

        
        <a href="/2021/05/31/hello-world/" class="archive-article-date">
  	<time datetime="2021-05-31T23:08:08.727Z" itemprop="datePublished"><i class="icon-calendar icon"></i>2021-05-31</time>
</a>
        
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      

      
    </div>
    <div class="article-info article-info-index">
      
      
      

      
        <p class="article-more-link">
          <a class="article-more-a" href="/2021/05/31/hello-world/">展开全文 >></a>
        </p>
      

      
      <div class="clearfix"></div>
    </div>
  </div>
</article>

<aside class="wrap-side-operation">
    <div class="mod-side-operation">
        
        <div class="jump-container" id="js-jump-container" style="display:none;">
            <a href="javascript:void(0)" class="mod-side-operation__jump-to-top">
                <i class="icon-font icon-back"></i>
            </a>
            <div id="js-jump-plan-container" class="jump-plan-container" style="top: -11px;">
                <i class="icon-font icon-plane jump-plane"></i>
            </div>
        </div>
        
        
    </div>
</aside>




  
  


          </div>
        </div>
      </div>
      <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2021 Hao Tang
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		mathjax: false,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		toc_hide_index: true,
		root: "/",
		innerArchive: true,
		showTags: false
	}
</script>

<script>!function(t){function n(e){if(r[e])return r[e].exports;var i=r[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var r={};n.m=t,n.c=r,n.p="./",n(0)}([function(t,n,r){r(195),t.exports=r(191)},function(t,n,r){var e=r(3),i=r(52),o=r(27),u=r(28),c=r(53),f="prototype",a=function(t,n,r){var s,l,h,v,p=t&a.F,d=t&a.G,y=t&a.S,g=t&a.P,b=t&a.B,m=d?e:y?e[n]||(e[n]={}):(e[n]||{})[f],x=d?i:i[n]||(i[n]={}),w=x[f]||(x[f]={});d&&(r=n);for(s in r)l=!p&&m&&void 0!==m[s],h=(l?m:r)[s],v=b&&l?c(h,e):g&&"function"==typeof h?c(Function.call,h):h,m&&u(m,s,h,t&a.U),x[s]!=h&&o(x,s,v),g&&w[s]!=h&&(w[s]=h)};e.core=i,a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,a.U=64,a.R=128,t.exports=a},function(t,n,r){var e=r(6);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,r){var e=r(126)("wks"),i=r(76),o=r(3).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n,r){var e=r(94),i=r(33);t.exports=function(t){return e(i(t))}},function(t,n,r){t.exports=!r(4)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(2),i=r(167),o=r(50),u=Object.defineProperty;n.f=r(10)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(14),i=r(22);t.exports=r(12)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(20),i=r(58),o=r(42),u=Object.defineProperty;n.f=r(12)?Object.defineProperty:function(t,n,r){if(e(t),n=o(n,!0),e(r),i)try{return u(t,n,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(40)("wks"),i=r(23),o=r(5).Symbol,u="function"==typeof o;(t.exports=function(t){return e[t]||(e[t]=u&&o[t]||(u?o:i)("Symbol."+t))}).store=e},function(t,n,r){var e=r(67),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){var e=r(46);t.exports=function(t){return Object(e(t))}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(63),i=r(34);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(21);t.exports=function(t){if(!e(t))throw TypeError(t+" is not an object!");return t}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n){var r={}.hasOwnProperty;t.exports=function(t,n){return r.call(t,n)}},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n,r){var e=r(11),i=r(66);t.exports=r(10)?function(t,n,r){return e.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n,r){var e=r(3),i=r(27),o=r(24),u=r(76)("src"),c="toString",f=Function[c],a=(""+f).split(c);r(52).inspectSource=function(t){return f.call(t)},(t.exports=function(t,n,r,c){var f="function"==typeof r;f&&(o(r,"name")||i(r,"name",n)),t[n]!==r&&(f&&(o(r,u)||i(r,u,t[n]?""+t[n]:a.join(String(n)))),t===e?t[n]=r:c?t[n]?t[n]=r:i(t,n,r):(delete t[n],i(t,n,r)))})(Function.prototype,c,function(){return"function"==typeof this&&this[u]||f.call(this)})},function(t,n,r){var e=r(1),i=r(4),o=r(46),u=function(t,n,r,e){var i=String(o(t)),u="<"+n;return""!==r&&(u+=" "+r+'="'+String(e).replace(/"/g,"&quot;")+'"'),u+">"+i+"</"+n+">"};t.exports=function(t,n){var r={};r[t]=n(u),e(e.P+e.F*i(function(){var n=""[t]('"');return n!==n.toLowerCase()||n.split('"').length>3}),"String",r)}},function(t,n,r){var e=r(115),i=r(46);t.exports=function(t){return e(i(t))}},function(t,n,r){var e=r(116),i=r(66),o=r(30),u=r(50),c=r(24),f=r(167),a=Object.getOwnPropertyDescriptor;n.f=r(10)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(24),i=r(17),o=r(145)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n){t.exports={}},function(t,n){t.exports=!0},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(14).f,i=r(8),o=r(15)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(40)("keys"),i=r(23);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(5),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n,r){var e=r(21);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(36),u=r(44),c=r(14).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){n.f=r(15)},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,r){var e=r(4);t.exports=function(t,n){return!!t&&e(function(){n?t.call(null,function(){},1):t.call(null)})}},function(t,n,r){var e=r(53),i=r(115),o=r(17),u=r(16),c=r(203);t.exports=function(t,n){var r=1==t,f=2==t,a=3==t,s=4==t,l=6==t,h=5==t||l,v=n||c;return function(n,c,p){for(var d,y,g=o(n),b=i(g),m=e(c,p,3),x=u(b.length),w=0,S=r?v(n,x):f?v(n,0):void 0;x>w;w++)if((h||w in b)&&(d=b[w],y=m(d,w,g),t))if(r)S[w]=y;else if(y)switch(t){case 3:return!0;case 5:return d;case 6:return w;case 2:S.push(d)}else if(s)return!1;return l?-1:a||s?s:S}}},function(t,n,r){var e=r(1),i=r(52),o=r(4);t.exports=function(t,n){var r=(i.Object||{})[t]||Object[t],u={};u[t]=n(r),e(e.S+e.F*o(function(){r(1)}),"Object",u)}},function(t,n,r){var e=r(6);t.exports=function(t,n){if(!e(t))return t;var r,i;if(n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!e(i=r.call(t)))return i;if(!n&&"function"==typeof(r=t.toString)&&!e(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,n,r){var e=r(5),i=r(25),o=r(91),u=r(13),c="prototype",f=function(t,n,r){var a,s,l,h=t&f.F,v=t&f.G,p=t&f.S,d=t&f.P,y=t&f.B,g=t&f.W,b=v?i:i[n]||(i[n]={}),m=b[c],x=v?e:p?e[n]:(e[n]||{})[c];v&&(r=n);for(a in r)(s=!h&&x&&void 0!==x[a])&&a in b||(l=s?x[a]:r[a],b[a]=v&&"function"!=typeof x[a]?r[a]:y&&s?o(l,e):g&&x[a]==l?function(t){var n=function(n,r,e){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(n);case 2:return new t(n,r)}return new t(n,r,e)}return t.apply(this,arguments)};return n[c]=t[c],n}(l):d&&"function"==typeof l?o(Function.call,l):l,d&&((b.virtual||(b.virtual={}))[a]=l,t&f.R&&m&&!m[a]&&u(m,a,l)))};f.F=1,f.G=2,f.S=4,f.P=8,f.B=16,f.W=32,f.U=64,f.R=128,t.exports=f},function(t,n){var r=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=r)},function(t,n,r){var e=r(26);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(183),i=r(1),o=r(126)("metadata"),u=o.store||(o.store=new(r(186))),c=function(t,n,r){var i=u.get(t);if(!i){if(!r)return;u.set(t,i=new e)}var o=i.get(n);if(!o){if(!r)return;i.set(n,o=new e)}return o},f=function(t,n,r){var e=c(n,r,!1);return void 0!==e&&e.has(t)},a=function(t,n,r){var e=c(n,r,!1);return void 0===e?void 0:e.get(t)},s=function(t,n,r,e){c(r,e,!0).set(t,n)},l=function(t,n){var r=c(t,n,!1),e=[];return r&&r.forEach(function(t,n){e.push(n)}),e},h=function(t){return void 0===t||"symbol"==typeof t?t:String(t)},v=function(t){i(i.S,"Reflect",t)};t.exports={store:u,map:c,has:f,get:a,set:s,keys:l,key:h,exp:v}},function(t,n,r){"use strict";if(r(10)){var e=r(69),i=r(3),o=r(4),u=r(1),c=r(127),f=r(152),a=r(53),s=r(68),l=r(66),h=r(27),v=r(73),p=r(67),d=r(16),y=r(75),g=r(50),b=r(24),m=r(180),x=r(114),w=r(6),S=r(17),_=r(137),O=r(70),E=r(32),P=r(71).f,j=r(154),F=r(76),M=r(7),A=r(48),N=r(117),T=r(146),I=r(155),k=r(80),L=r(123),R=r(74),C=r(130),D=r(160),U=r(11),W=r(31),G=U.f,B=W.f,V=i.RangeError,z=i.TypeError,q=i.Uint8Array,K="ArrayBuffer",J="Shared"+K,Y="BYTES_PER_ELEMENT",H="prototype",$=Array[H],X=f.ArrayBuffer,Q=f.DataView,Z=A(0),tt=A(2),nt=A(3),rt=A(4),et=A(5),it=A(6),ot=N(!0),ut=N(!1),ct=I.values,ft=I.keys,at=I.entries,st=$.lastIndexOf,lt=$.reduce,ht=$.reduceRight,vt=$.join,pt=$.sort,dt=$.slice,yt=$.toString,gt=$.toLocaleString,bt=M("iterator"),mt=M("toStringTag"),xt=F("typed_constructor"),wt=F("def_constructor"),St=c.CONSTR,_t=c.TYPED,Ot=c.VIEW,Et="Wrong length!",Pt=A(1,function(t,n){return Tt(T(t,t[wt]),n)}),jt=o(function(){return 1===new q(new Uint16Array([1]).buffer)[0]}),Ft=!!q&&!!q[H].set&&o(function(){new q(1).set({})}),Mt=function(t,n){if(void 0===t)throw z(Et);var r=+t,e=d(t);if(n&&!m(r,e))throw V(Et);return e},At=function(t,n){var r=p(t);if(r<0||r%n)throw V("Wrong offset!");return r},Nt=function(t){if(w(t)&&_t in t)return t;throw z(t+" is not a typed array!")},Tt=function(t,n){if(!(w(t)&&xt in t))throw z("It is not a typed array constructor!");return new t(n)},It=function(t,n){return kt(T(t,t[wt]),n)},kt=function(t,n){for(var r=0,e=n.length,i=Tt(t,e);e>r;)i[r]=n[r++];return i},Lt=function(t,n,r){G(t,n,{get:function(){return this._d[r]}})},Rt=function(t){var n,r,e,i,o,u,c=S(t),f=arguments.length,s=f>1?arguments[1]:void 0,l=void 0!==s,h=j(c);if(void 0!=h&&!_(h)){for(u=h.call(c),e=[],n=0;!(o=u.next()).done;n++)e.push(o.value);c=e}for(l&&f>2&&(s=a(s,arguments[2],2)),n=0,r=d(c.length),i=Tt(this,r);r>n;n++)i[n]=l?s(c[n],n):c[n];return i},Ct=function(){for(var t=0,n=arguments.length,r=Tt(this,n);n>t;)r[t]=arguments[t++];return r},Dt=!!q&&o(function(){gt.call(new q(1))}),Ut=function(){return gt.apply(Dt?dt.call(Nt(this)):Nt(this),arguments)},Wt={copyWithin:function(t,n){return D.call(Nt(this),t,n,arguments.length>2?arguments[2]:void 0)},every:function(t){return rt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return C.apply(Nt(this),arguments)},filter:function(t){return It(this,tt(Nt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return et(Nt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return it(Nt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Z(Nt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return ut(Nt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return ot(Nt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return vt.apply(Nt(this),arguments)},lastIndexOf:function(t){return st.apply(Nt(this),arguments)},map:function(t){return Pt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return lt.apply(Nt(this),arguments)},reduceRight:function(t){return ht.apply(Nt(this),arguments)},reverse:function(){for(var t,n=this,r=Nt(n).length,e=Math.floor(r/2),i=0;i<e;)t=n[i],n[i++]=n[--r],n[r]=t;return n},some:function(t){return nt(Nt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return pt.call(Nt(this),t)},subarray:function(t,n){var r=Nt(this),e=r.length,i=y(t,e);return new(T(r,r[wt]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,d((void 0===n?e:y(n,e))-i))}},Gt=function(t,n){return It(this,dt.call(Nt(this),t,n))},Bt=function(t){Nt(this);var n=At(arguments[1],1),r=this.length,e=S(t),i=d(e.length),o=0;if(i+n>r)throw V(Et);for(;o<i;)this[n+o]=e[o++]},Vt={entries:function(){return at.call(Nt(this))},keys:function(){return ft.call(Nt(this))},values:function(){return ct.call(Nt(this))}},zt=function(t,n){return w(t)&&t[_t]&&"symbol"!=typeof n&&n in t&&String(+n)==String(n)},qt=function(t,n){return zt(t,n=g(n,!0))?l(2,t[n]):B(t,n)},Kt=function(t,n,r){return!(zt(t,n=g(n,!0))&&w(r)&&b(r,"value"))||b(r,"get")||b(r,"set")||r.configurable||b(r,"writable")&&!r.writable||b(r,"enumerable")&&!r.enumerable?G(t,n,r):(t[n]=r.value,t)};St||(W.f=qt,U.f=Kt),u(u.S+u.F*!St,"Object",{getOwnPropertyDescriptor:qt,defineProperty:Kt}),o(function(){yt.call({})})&&(yt=gt=function(){return vt.call(this)});var Jt=v({},Wt);v(Jt,Vt),h(Jt,bt,Vt.values),v(Jt,{slice:Gt,set:Bt,constructor:function(){},toString:yt,toLocaleString:Ut}),Lt(Jt,"buffer","b"),Lt(Jt,"byteOffset","o"),Lt(Jt,"byteLength","l"),Lt(Jt,"length","e"),G(Jt,mt,{get:function(){return this[_t]}}),t.exports=function(t,n,r,f){f=!!f;var a=t+(f?"Clamped":"")+"Array",l="Uint8Array"!=a,v="get"+t,p="set"+t,y=i[a],g=y||{},b=y&&E(y),m=!y||!c.ABV,S={},_=y&&y[H],j=function(t,r){var e=t._d;return e.v[v](r*n+e.o,jt)},F=function(t,r,e){var i=t._d;f&&(e=(e=Math.round(e))<0?0:e>255?255:255&e),i.v[p](r*n+i.o,e,jt)},M=function(t,n){G(t,n,{get:function(){return j(this,n)},set:function(t){return F(this,n,t)},enumerable:!0})};m?(y=r(function(t,r,e,i){s(t,y,a,"_d");var o,u,c,f,l=0,v=0;if(w(r)){if(!(r instanceof X||(f=x(r))==K||f==J))return _t in r?kt(y,r):Rt.call(y,r);o=r,v=At(e,n);var p=r.byteLength;if(void 0===i){if(p%n)throw V(Et);if((u=p-v)<0)throw V(Et)}else if((u=d(i)*n)+v>p)throw V(Et);c=u/n}else c=Mt(r,!0),u=c*n,o=new X(u);for(h(t,"_d",{b:o,o:v,l:u,e:c,v:new Q(o)});l<c;)M(t,l++)}),_=y[H]=O(Jt),h(_,"constructor",y)):L(function(t){new y(null),new y(t)},!0)||(y=r(function(t,r,e,i){s(t,y,a);var o;return w(r)?r instanceof X||(o=x(r))==K||o==J?void 0!==i?new g(r,At(e,n),i):void 0!==e?new g(r,At(e,n)):new g(r):_t in r?kt(y,r):Rt.call(y,r):new g(Mt(r,l))}),Z(b!==Function.prototype?P(g).concat(P(b)):P(g),function(t){t in y||h(y,t,g[t])}),y[H]=_,e||(_.constructor=y));var A=_[bt],N=!!A&&("values"==A.name||void 0==A.name),T=Vt.values;h(y,xt,!0),h(_,_t,a),h(_,Ot,!0),h(_,wt,y),(f?new y(1)[mt]==a:mt in _)||G(_,mt,{get:function(){return a}}),S[a]=y,u(u.G+u.W+u.F*(y!=g),S),u(u.S,a,{BYTES_PER_ELEMENT:n,from:Rt,of:Ct}),Y in _||h(_,Y,n),u(u.P,a,Wt),R(a),u(u.P+u.F*Ft,a,{set:Bt}),u(u.P+u.F*!N,a,Vt),u(u.P+u.F*(_.toString!=yt),a,{toString:yt}),u(u.P+u.F*o(function(){new y(1).slice()}),a,{slice:Gt}),u(u.P+u.F*(o(function(){return[1,2].toLocaleString()!=new y([1,2]).toLocaleString()})||!o(function(){_.toLocaleString.call([1,2])})),a,{toLocaleString:Ut}),k[a]=N?A:T,e||N||h(_,bt,T)}}else t.exports=function(){}},function(t,n){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,n,r){var e=r(21),i=r(5).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n,r){t.exports=!r(12)&&!r(18)(function(){return 7!=Object.defineProperty(r(57)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){"use strict";var e=r(36),i=r(51),o=r(64),u=r(13),c=r(8),f=r(35),a=r(96),s=r(38),l=r(103),h=r(15)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n,r){var e=r(20),i=r(100),o=r(34),u=r(39)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(57)("iframe"),e=o.length;for(n.style.display="none",r(93).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(63),i=r(34).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(8),i=r(9),o=r(90)(!1),u=r(39)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){t.exports=r(13)},function(t,n,r){var e=r(76)("meta"),i=r(6),o=r(24),u=r(11).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(4)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?e:r)(t)}},function(t,n){t.exports=function(t,n,r,e){if(!(t instanceof n)||void 0!==e&&e in t)throw TypeError(r+": incorrect invocation!");return t}},function(t,n){t.exports=!1},function(t,n,r){var e=r(2),i=r(173),o=r(133),u=r(145)("IE_PROTO"),c=function(){},f="prototype",a=function(){var t,n=r(132)("iframe"),e=o.length;for(n.style.display="none",r(135).appendChild(n),n.src="javascript:",t=n.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),a=t.F;e--;)delete a[f][o[e]];return a()};t.exports=Object.create||function(t,n){var r;return null!==t?(c[f]=e(t),r=new c,c[f]=null,r[u]=t):r=a(),void 0===n?r:i(r,n)}},function(t,n,r){var e=r(175),i=r(133).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,i)}},function(t,n,r){var e=r(175),i=r(133);t.exports=Object.keys||function(t){return e(t,i)}},function(t,n,r){var e=r(28);t.exports=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t}},function(t,n,r){"use strict";var e=r(3),i=r(11),o=r(10),u=r(7)("species");t.exports=function(t){var n=e[t];o&&n&&!n[u]&&i.f(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(67),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n){var r=0,e=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+e).toString(36))}},function(t,n,r){var e=r(33);t.exports=function(t){return Object(e(t))}},function(t,n,r){var e=r(7)("unscopables"),i=Array.prototype;void 0==i[e]&&r(27)(i,e,{}),t.exports=function(t){i[e][t]=!0}},function(t,n,r){var e=r(53),i=r(169),o=r(137),u=r(2),c=r(16),f=r(154),a={},s={},n=t.exports=function(t,n,r,l,h){var v,p,d,y,g=h?function(){return t}:f(t),b=e(r,l,n?2:1),m=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(v=c(t.length);v>m;m++)if((y=n?b(u(p=t[m])[0],p[1]):b(t[m]))===a||y===s)return y}else for(d=g.call(t);!(p=d.next()).done;)if((y=i(d,b,p.value,n))===a||y===s)return y};n.BREAK=a,n.RETURN=s},function(t,n){t.exports={}},function(t,n,r){var e=r(11).f,i=r(24),o=r(7)("toStringTag");t.exports=function(t,n,r){t&&!i(t=r?t:t.prototype,o)&&e(t,o,{configurable:!0,value:n})}},function(t,n,r){var e=r(1),i=r(46),o=r(4),u=r(150),c="["+u+"]",f="​",a=RegExp("^"+c+c+"*"),s=RegExp(c+c+"*$"),l=function(t,n,r){var i={},c=o(function(){return!!u[t]()||f[t]()!=f}),a=i[t]=c?n(h):u[t];r&&(i[r]=a),e(e.P+e.F*c,"String",i)},h=l.trim=function(t,n){return t=String(i(t)),1&n&&(t=t.replace(a,"")),2&n&&(t=t.replace(s,"")),t};t.exports=l},function(t,n,r){t.exports={default:r(86),__esModule:!0}},function(t,n,r){t.exports={default:r(87),__esModule:!0}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}n.__esModule=!0;var i=r(84),o=e(i),u=r(83),c=e(u),f="function"==typeof c.default&&"symbol"==typeof o.default?function(t){return typeof t}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":typeof t};n.default="function"==typeof c.default&&"symbol"===f(o.default)?function(t){return void 0===t?"undefined":f(t)}:function(t){return t&&"function"==typeof c.default&&t.constructor===c.default&&t!==c.default.prototype?"symbol":void 0===t?"undefined":f(t)}},function(t,n,r){r(110),r(108),r(111),r(112),t.exports=r(25).Symbol},function(t,n,r){r(109),r(113),t.exports=r(44).f("iterator")},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(9),i=r(106),o=r(105);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){var e=r(88);t.exports=function(t,n,r){if(e(t),void 0===n)return t;switch(r){case 1:return function(r){return t.call(n,r)};case 2:return function(r,e){return t.call(n,r,e)};case 3:return function(r,e,i){return t.call(n,r,e,i)}}return function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(19),i=r(62),o=r(37);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){t.exports=r(5).document&&document.documentElement},function(t,n,r){var e=r(56);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n,r){var e=r(56);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(60),i=r(22),o=r(38),u={};r(13)(u,r(15)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,r){var e=r(19),i=r(9);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){var e=r(23)("meta"),i=r(21),o=r(8),u=r(14).f,c=0,f=Object.isExtensible||function(){return!0},a=!r(18)(function(){return f(Object.preventExtensions({}))}),s=function(t){u(t,e,{value:{i:"O"+ ++c,w:{}}})},l=function(t,n){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!o(t,e)){if(!f(t))return"F";if(!n)return"E";s(t)}return t[e].i},h=function(t,n){if(!o(t,e)){if(!f(t))return!0;if(!n)return!1;s(t)}return t[e].w},v=function(t){return a&&p.NEED&&f(t)&&!o(t,e)&&s(t),t},p=t.exports={KEY:e,NEED:!1,fastKey:l,getWeak:h,onFreeze:v}},function(t,n,r){var e=r(14),i=r(20),o=r(19);t.exports=r(12)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(37),i=r(22),o=r(9),u=r(42),c=r(8),f=r(58),a=Object.getOwnPropertyDescriptor;n.f=r(12)?a:function(t,n){if(t=o(t),n=u(n,!0),f)try{return a(t,n)}catch(t){}if(c(t,n))return i(!e.f.call(t,n),t[n])}},function(t,n,r){var e=r(9),i=r(61).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(8),i=r(77),o=r(39)("IE_PROTO"),u=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),e(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},function(t,n,r){var e=r(41),i=r(33);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(41),i=Math.max,o=Math.min;t.exports=function(t,n){return t=e(t),t<0?i(t+n,0):o(t,n)}},function(t,n,r){var e=r(41),i=Math.min;t.exports=function(t){return t>0?i(e(t),9007199254740991):0}},function(t,n,r){"use strict";var e=r(89),i=r(97),o=r(35),u=r(9);t.exports=r(59)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){},function(t,n,r){"use strict";var e=r(104)(!0);r(59)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";var e=r(5),i=r(8),o=r(12),u=r(51),c=r(64),f=r(99).KEY,a=r(18),s=r(40),l=r(38),h=r(23),v=r(15),p=r(44),d=r(43),y=r(98),g=r(92),b=r(95),m=r(20),x=r(9),w=r(42),S=r(22),_=r(60),O=r(102),E=r(101),P=r(14),j=r(19),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(61).f=O.f=Z,r(37).f=X,r(62).f=tt,o&&!r(36)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(13)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){r(43)("asyncIterator")},function(t,n,r){r(43)("observable")},function(t,n,r){r(107);for(var e=r(5),i=r(13),o=r(35),u=r(15)("toStringTag"),c=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var a=c[f],s=e[a],l=s&&s.prototype;l&&!l[u]&&i(l,u,a),o[a]=o.Array}},function(t,n,r){var e=r(45),i=r(7)("toStringTag"),o="Arguments"==e(function(){return arguments}()),u=function(t,n){try{return t[n]}catch(t){}};t.exports=function(t){var n,r,c;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=u(n=Object(t),i))?r:o?e(n):"Object"==(c=e(n))&&"function"==typeof n.callee?"Arguments":c}},function(t,n,r){var e=r(45);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==e(t)?t.split(""):Object(t)}},function(t,n){n.f={}.propertyIsEnumerable},function(t,n,r){var e=r(30),i=r(16),o=r(75);t.exports=function(t){return function(n,r,u){var c,f=e(n),a=i(f.length),s=o(u,a);if(t&&r!=r){for(;a>s;)if((c=f[s++])!=c)return!0}else for(;a>s;s++)if((t||s in f)&&f[s]===r)return t||s||0;return!t&&-1}}},function(t,n,r){"use strict";var e=r(3),i=r(1),o=r(28),u=r(73),c=r(65),f=r(79),a=r(68),s=r(6),l=r(4),h=r(123),v=r(81),p=r(136);t.exports=function(t,n,r,d,y,g){var b=e[t],m=b,x=y?"set":"add",w=m&&m.prototype,S={},_=function(t){var n=w[t];o(w,t,"delete"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!s(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!s(t)?void 0:n.call(this,0===t?0:t)}:"add"==t?function(t){return n.call(this,0===t?0:t),this}:function(t,r){return n.call(this,0===t?0:t,r),this})};if("function"==typeof m&&(g||w.forEach&&!l(function(){(new m).entries().next()}))){var O=new m,E=O[x](g?{}:-0,1)!=O,P=l(function(){O.has(1)}),j=h(function(t){new m(t)}),F=!g&&l(function(){for(var t=new m,n=5;n--;)t[x](n,n);return!t.has(-0)});j||(m=n(function(n,r){a(n,m,t);var e=p(new b,n,m);return void 0!=r&&f(r,y,e[x],e),e}),m.prototype=w,w.constructor=m),(P||F)&&(_("delete"),_("has"),y&&_("get")),(F||E)&&_(x),g&&w.clear&&delete w.clear}else m=d.getConstructor(n,t,y,x),u(m.prototype,r),c.NEED=!0;return v(m,t),S[t]=m,i(i.G+i.W+i.F*(m!=b),S),g||d.setStrong(m,t,y),m}},function(t,n,r){"use strict";var e=r(27),i=r(28),o=r(4),u=r(46),c=r(7);t.exports=function(t,n,r){var f=c(t),a=r(u,f,""[t]),s=a[0],l=a[1];o(function(){var n={};return n[f]=function(){return 7},7!=""[t](n)})&&(i(String.prototype,t,s),e(RegExp.prototype,f,2==n?function(t,n){return l.call(t,this,n)}:function(t){return l.call(t,this)}))}
},function(t,n,r){"use strict";var e=r(2);t.exports=function(){var t=e(this),n="";return t.global&&(n+="g"),t.ignoreCase&&(n+="i"),t.multiline&&(n+="m"),t.unicode&&(n+="u"),t.sticky&&(n+="y"),n}},function(t,n){t.exports=function(t,n,r){var e=void 0===r;switch(n.length){case 0:return e?t():t.call(r);case 1:return e?t(n[0]):t.call(r,n[0]);case 2:return e?t(n[0],n[1]):t.call(r,n[0],n[1]);case 3:return e?t(n[0],n[1],n[2]):t.call(r,n[0],n[1],n[2]);case 4:return e?t(n[0],n[1],n[2],n[3]):t.call(r,n[0],n[1],n[2],n[3])}return t.apply(r,n)}},function(t,n,r){var e=r(6),i=r(45),o=r(7)("match");t.exports=function(t){var n;return e(t)&&(void 0!==(n=t[o])?!!n:"RegExp"==i(t))}},function(t,n,r){var e=r(7)("iterator"),i=!1;try{var o=[7][e]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,n){if(!n&&!i)return!1;var r=!1;try{var o=[7],u=o[e]();u.next=function(){return{done:r=!0}},o[e]=function(){return u},t(o)}catch(t){}return r}},function(t,n,r){t.exports=r(69)||!r(4)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete r(3)[t]})},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(3),i="__core-js_shared__",o=e[i]||(e[i]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,n,r){for(var e,i=r(3),o=r(27),u=r(76),c=u("typed_array"),f=u("view"),a=!(!i.ArrayBuffer||!i.DataView),s=a,l=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");l<9;)(e=i[h[l++]])?(o(e.prototype,c,!0),o(e.prototype,f,!0)):s=!1;t.exports={ABV:a,CONSTR:s,TYPED:c,VIEW:f}},function(t,n){"use strict";var r={versions:function(){var t=window.navigator.userAgent;return{trident:t.indexOf("Trident")>-1,presto:t.indexOf("Presto")>-1,webKit:t.indexOf("AppleWebKit")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),mobile:!!t.match(/AppleWebKit.*Mobile.*/),ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,webApp:-1==t.indexOf("Safari"),weixin:-1==t.indexOf("MicroMessenger")}}()};t.exports=r},function(t,n,r){"use strict";var e=r(85),i=function(t){return t&&t.__esModule?t:{default:t}}(e),o=function(){function t(t,n,e){return n||e?String.fromCharCode(n||e):r[t]||t}function n(t){return e[t]}var r={"&quot;":'"',"&lt;":"<","&gt;":">","&amp;":"&","&nbsp;":" "},e={};for(var u in r)e[r[u]]=u;return r["&apos;"]="'",e["'"]="&#39;",{encode:function(t){return t?(""+t).replace(/['<> "&]/g,n).replace(/\r?\n/g,"<br/>").replace(/\s/g,"&nbsp;"):""},decode:function(n){return n?(""+n).replace(/<br\s*\/?>/gi,"\n").replace(/&quot;|&lt;|&gt;|&amp;|&nbsp;|&apos;|&#(\d+);|&#(\d+)/g,t).replace(/\u00a0/g," "):""},encodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},encodeBase16forJSON:function(t){if(!t)return t;t=t.replace(/[\u4E00-\u9FBF]/gi,function(t){return escape(t).replace("%u","\\u")});for(var n=[],r=0,e=t.length;e>r;r++)n.push(t.charCodeAt(r).toString(16).toUpperCase());return n.join("")},decodeBase16:function(t){if(!t)return t;t+="";for(var n=[],r=0,e=t.length;e>r;r+=2)n.push(String.fromCharCode("0x"+t.slice(r,r+2)));return n.join("")},encodeObject:function(t){if(t instanceof Array)for(var n=0,r=t.length;r>n;n++)t[n]=o.encodeObject(t[n]);else if("object"==(void 0===t?"undefined":(0,i.default)(t)))for(var e in t)t[e]=o.encodeObject(t[e]);else if("string"==typeof t)return o.encode(t);return t},loadScript:function(t){var n=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(n),n.setAttribute("src",t)},addLoadEvent:function(t){var n=window.onload;"function"!=typeof window.onload?window.onload=t:window.onload=function(){n(),t()}}}}();t.exports=o},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=function(t){for(var n=e(this),r=o(n.length),u=arguments.length,c=i(u>1?arguments[1]:void 0,r),f=u>2?arguments[2]:void 0,a=void 0===f?r:i(f,r);a>c;)n[c++]=t;return n}},function(t,n,r){"use strict";var e=r(11),i=r(66);t.exports=function(t,n,r){n in t?e.f(t,n,i(0,r)):t[n]=r}},function(t,n,r){var e=r(6),i=r(3).document,o=e(i)&&e(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,n){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,n,r){var e=r(7)("match");t.exports=function(t){var n=/./;try{"/./"[t](n)}catch(r){try{return n[e]=!1,!"/./"[t](n)}catch(t){}}return!0}},function(t,n,r){t.exports=r(3).document&&document.documentElement},function(t,n,r){var e=r(6),i=r(144).set;t.exports=function(t,n,r){var o,u=n.constructor;return u!==r&&"function"==typeof u&&(o=u.prototype)!==r.prototype&&e(o)&&i&&i(t,o),t}},function(t,n,r){var e=r(80),i=r(7)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(e.Array===t||o[i]===t)}},function(t,n,r){var e=r(45);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){"use strict";var e=r(70),i=r(66),o=r(81),u={};r(27)(u,r(7)("iterator"),function(){return this}),t.exports=function(t,n,r){t.prototype=e(u,{next:i(1,r)}),o(t,n+" Iterator")}},function(t,n,r){"use strict";var e=r(69),i=r(1),o=r(28),u=r(27),c=r(24),f=r(80),a=r(139),s=r(81),l=r(32),h=r(7)("iterator"),v=!([].keys&&"next"in[].keys()),p="keys",d="values",y=function(){return this};t.exports=function(t,n,r,g,b,m,x){a(r,n,g);var w,S,_,O=function(t){if(!v&&t in F)return F[t];switch(t){case p:case d:return function(){return new r(this,t)}}return function(){return new r(this,t)}},E=n+" Iterator",P=b==d,j=!1,F=t.prototype,M=F[h]||F["@@iterator"]||b&&F[b],A=M||O(b),N=b?P?O("entries"):A:void 0,T="Array"==n?F.entries||M:M;if(T&&(_=l(T.call(new t)))!==Object.prototype&&(s(_,E,!0),e||c(_,h)||u(_,h,y)),P&&M&&M.name!==d&&(j=!0,A=function(){return M.call(this)}),e&&!x||!v&&!j&&F[h]||u(F,h,A),f[n]=A,f[E]=y,b)if(w={values:P?A:O(d),keys:m?A:O(p),entries:N},x)for(S in w)S in F||o(F,S,w[S]);else i(i.P+i.F*(v||j),n,w);return w}},function(t,n){var r=Math.expm1;t.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:r},function(t,n){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,n,r){var e=r(3),i=r(151).set,o=e.MutationObserver||e.WebKitMutationObserver,u=e.process,c=e.Promise,f="process"==r(45)(u);t.exports=function(){var t,n,r,a=function(){var e,i;for(f&&(e=u.domain)&&e.exit();t;){i=t.fn,t=t.next;try{i()}catch(e){throw t?r():n=void 0,e}}n=void 0,e&&e.enter()};if(f)r=function(){u.nextTick(a)};else if(o){var s=!0,l=document.createTextNode("");new o(a).observe(l,{characterData:!0}),r=function(){l.data=s=!s}}else if(c&&c.resolve){var h=c.resolve();r=function(){h.then(a)}}else r=function(){i.call(e,a)};return function(e){var i={fn:e,next:void 0};n&&(n.next=i),t||(t=i,r()),n=i}}},function(t,n,r){var e=r(6),i=r(2),o=function(t,n){if(i(t),!e(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,e){try{e=r(53)(Function.call,r(31).f(Object.prototype,"__proto__").set,2),e(t,[]),n=!(t instanceof Array)}catch(t){n=!0}return function(t,r){return o(t,r),n?t.__proto__=r:e(t,r),t}}({},!1):void 0),check:o}},function(t,n,r){var e=r(126)("keys"),i=r(76);t.exports=function(t){return e[t]||(e[t]=i(t))}},function(t,n,r){var e=r(2),i=r(26),o=r(7)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||void 0==(r=e(u)[o])?n:i(r)}},function(t,n,r){var e=r(67),i=r(46);t.exports=function(t){return function(n,r){var o,u,c=String(i(n)),f=e(r),a=c.length;return f<0||f>=a?t?"":void 0:(o=c.charCodeAt(f),o<55296||o>56319||f+1===a||(u=c.charCodeAt(f+1))<56320||u>57343?t?c.charAt(f):o:t?c.slice(f,f+2):u-56320+(o-55296<<10)+65536)}}},function(t,n,r){var e=r(122),i=r(46);t.exports=function(t,n,r){if(e(n))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(t))}},function(t,n,r){"use strict";var e=r(67),i=r(46);t.exports=function(t){var n=String(i(this)),r="",o=e(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(n+=n))1&o&&(r+=n);return r}},function(t,n){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,n,r){var e,i,o,u=r(53),c=r(121),f=r(135),a=r(132),s=r(3),l=s.process,h=s.setImmediate,v=s.clearImmediate,p=s.MessageChannel,d=0,y={},g="onreadystatechange",b=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},m=function(t){b.call(t.data)};h&&v||(h=function(t){for(var n=[],r=1;arguments.length>r;)n.push(arguments[r++]);return y[++d]=function(){c("function"==typeof t?t:Function(t),n)},e(d),d},v=function(t){delete y[t]},"process"==r(45)(l)?e=function(t){l.nextTick(u(b,t,1))}:p?(i=new p,o=i.port2,i.port1.onmessage=m,e=u(o.postMessage,o,1)):s.addEventListener&&"function"==typeof postMessage&&!s.importScripts?(e=function(t){s.postMessage(t+"","*")},s.addEventListener("message",m,!1)):e=g in a("script")?function(t){f.appendChild(a("script"))[g]=function(){f.removeChild(this),b.call(t)}}:function(t){setTimeout(u(b,t,1),0)}),t.exports={set:h,clear:v}},function(t,n,r){"use strict";var e=r(3),i=r(10),o=r(69),u=r(127),c=r(27),f=r(73),a=r(4),s=r(68),l=r(67),h=r(16),v=r(71).f,p=r(11).f,d=r(130),y=r(81),g="ArrayBuffer",b="DataView",m="prototype",x="Wrong length!",w="Wrong index!",S=e[g],_=e[b],O=e.Math,E=e.RangeError,P=e.Infinity,j=S,F=O.abs,M=O.pow,A=O.floor,N=O.log,T=O.LN2,I="buffer",k="byteLength",L="byteOffset",R=i?"_b":I,C=i?"_l":k,D=i?"_o":L,U=function(t,n,r){var e,i,o,u=Array(r),c=8*r-n-1,f=(1<<c)-1,a=f>>1,s=23===n?M(2,-24)-M(2,-77):0,l=0,h=t<0||0===t&&1/t<0?1:0;for(t=F(t),t!=t||t===P?(i=t!=t?1:0,e=f):(e=A(N(t)/T),t*(o=M(2,-e))<1&&(e--,o*=2),t+=e+a>=1?s/o:s*M(2,1-a),t*o>=2&&(e++,o/=2),e+a>=f?(i=0,e=f):e+a>=1?(i=(t*o-1)*M(2,n),e+=a):(i=t*M(2,a-1)*M(2,n),e=0));n>=8;u[l++]=255&i,i/=256,n-=8);for(e=e<<n|i,c+=n;c>0;u[l++]=255&e,e/=256,c-=8);return u[--l]|=128*h,u},W=function(t,n,r){var e,i=8*r-n-1,o=(1<<i)-1,u=o>>1,c=i-7,f=r-1,a=t[f--],s=127&a;for(a>>=7;c>0;s=256*s+t[f],f--,c-=8);for(e=s&(1<<-c)-1,s>>=-c,c+=n;c>0;e=256*e+t[f],f--,c-=8);if(0===s)s=1-u;else{if(s===o)return e?NaN:a?-P:P;e+=M(2,n),s-=u}return(a?-1:1)*e*M(2,s-n)},G=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},B=function(t){return[255&t]},V=function(t){return[255&t,t>>8&255]},z=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},q=function(t){return U(t,52,8)},K=function(t){return U(t,23,4)},J=function(t,n,r){p(t[m],n,{get:function(){return this[r]}})},Y=function(t,n,r,e){var i=+r,o=l(i);if(i!=o||o<0||o+n>t[C])throw E(w);var u=t[R]._b,c=o+t[D],f=u.slice(c,c+n);return e?f:f.reverse()},H=function(t,n,r,e,i,o){var u=+r,c=l(u);if(u!=c||c<0||c+n>t[C])throw E(w);for(var f=t[R]._b,a=c+t[D],s=e(+i),h=0;h<n;h++)f[a+h]=s[o?h:n-h-1]},$=function(t,n){s(t,S,g);var r=+n,e=h(r);if(r!=e)throw E(x);return e};if(u.ABV){if(!a(function(){new S})||!a(function(){new S(.5)})){S=function(t){return new j($(this,t))};for(var X,Q=S[m]=j[m],Z=v(j),tt=0;Z.length>tt;)(X=Z[tt++])in S||c(S,X,j[X]);o||(Q.constructor=S)}var nt=new _(new S(2)),rt=_[m].setInt8;nt.setInt8(0,2147483648),nt.setInt8(1,2147483649),!nt.getInt8(0)&&nt.getInt8(1)||f(_[m],{setInt8:function(t,n){rt.call(this,t,n<<24>>24)},setUint8:function(t,n){rt.call(this,t,n<<24>>24)}},!0)}else S=function(t){var n=$(this,t);this._b=d.call(Array(n),0),this[C]=n},_=function(t,n,r){s(this,_,b),s(t,S,b);var e=t[C],i=l(n);if(i<0||i>e)throw E("Wrong offset!");if(r=void 0===r?e-i:h(r),i+r>e)throw E(x);this[R]=t,this[D]=i,this[C]=r},i&&(J(S,k,"_l"),J(_,I,"_b"),J(_,k,"_l"),J(_,L,"_o")),f(_[m],{getInt8:function(t){return Y(this,1,t)[0]<<24>>24},getUint8:function(t){return Y(this,1,t)[0]},getInt16:function(t){var n=Y(this,2,t,arguments[1]);return(n[1]<<8|n[0])<<16>>16},getUint16:function(t){var n=Y(this,2,t,arguments[1]);return n[1]<<8|n[0]},getInt32:function(t){return G(Y(this,4,t,arguments[1]))},getUint32:function(t){return G(Y(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return W(Y(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return W(Y(this,8,t,arguments[1]),52,8)},setInt8:function(t,n){H(this,1,t,B,n)},setUint8:function(t,n){H(this,1,t,B,n)},setInt16:function(t,n){H(this,2,t,V,n,arguments[2])},setUint16:function(t,n){H(this,2,t,V,n,arguments[2])},setInt32:function(t,n){H(this,4,t,z,n,arguments[2])},setUint32:function(t,n){H(this,4,t,z,n,arguments[2])},setFloat32:function(t,n){H(this,4,t,K,n,arguments[2])},setFloat64:function(t,n){H(this,8,t,q,n,arguments[2])}});y(S,g),y(_,b),c(_[m],u.VIEW,!0),n[g]=S,n[b]=_},function(t,n,r){var e=r(3),i=r(52),o=r(69),u=r(182),c=r(11).f;t.exports=function(t){var n=i.Symbol||(i.Symbol=o?{}:e.Symbol||{});"_"==t.charAt(0)||t in n||c(n,t,{value:u.f(t)})}},function(t,n,r){var e=r(114),i=r(7)("iterator"),o=r(80);t.exports=r(52).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[e(t)]}},function(t,n,r){"use strict";var e=r(78),i=r(170),o=r(80),u=r(30);t.exports=r(140)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,i(1)):"keys"==n?i(0,r):"values"==n?i(0,t[r]):i(0,[r,t[r]])},"values"),o.Arguments=o.Array,e("keys"),e("values"),e("entries")},function(t,n){function r(t,n){t.classList?t.classList.add(n):t.className+=" "+n}t.exports=r},function(t,n){function r(t,n){if(t.classList)t.classList.remove(n);else{var r=new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi");t.className=t.className.replace(r," ")}}t.exports=r},function(t,n){function r(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function i(t){if(s===setTimeout)return setTimeout(t,0);if((s===r||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(n){try{return s.call(null,t,0)}catch(n){return s.call(this,t,0)}}}function o(t){if(l===clearTimeout)return clearTimeout(t);if((l===e||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(n){try{return l.call(null,t)}catch(n){return l.call(this,t)}}}function u(){d&&v&&(d=!1,v.length?p=v.concat(p):y=-1,p.length&&c())}function c(){if(!d){var t=i(u);d=!0;for(var n=p.length;n;){for(v=p,p=[];++y<n;)v&&v[y].run();y=-1,n=p.length}v=null,d=!1,o(t)}}function f(t,n){this.fun=t,this.array=n}function a(){}var s,l,h=t.exports={};!function(){try{s="function"==typeof setTimeout?setTimeout:r}catch(t){s=r}try{l="function"==typeof clearTimeout?clearTimeout:e}catch(t){l=e}}();var v,p=[],d=!1,y=-1;h.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];p.push(new f(t,n)),1!==p.length||d||i(c)},f.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=a,h.addListener=a,h.once=a,h.off=a,h.removeListener=a,h.removeAllListeners=a,h.emit=a,h.prependListener=a,h.prependOnceListener=a,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,n,r){var e=r(45);t.exports=function(t,n){if("number"!=typeof t&&"Number"!=e(t))throw TypeError(n);return+t}},function(t,n,r){"use strict";var e=r(17),i=r(75),o=r(16);t.exports=[].copyWithin||function(t,n){var r=e(this),u=o(r.length),c=i(t,u),f=i(n,u),a=arguments.length>2?arguments[2]:void 0,s=Math.min((void 0===a?u:i(a,u))-f,u-c),l=1;for(f<c&&c<f+s&&(l=-1,f+=s-1,c+=s-1);s-- >0;)f in r?r[c]=r[f]:delete r[c],c+=l,f+=l;return r}},function(t,n,r){var e=r(79);t.exports=function(t,n){var r=[];return e(t,!1,r.push,r,n),r}},function(t,n,r){var e=r(26),i=r(17),o=r(115),u=r(16);t.exports=function(t,n,r,c,f){e(n);var a=i(t),s=o(a),l=u(a.length),h=f?l-1:0,v=f?-1:1;if(r<2)for(;;){if(h in s){c=s[h],h+=v;break}if(h+=v,f?h<0:l<=h)throw TypeError("Reduce of empty array with no initial value")}for(;f?h>=0:l>h;h+=v)h in s&&(c=n(c,s[h],h,a));return c}},function(t,n,r){"use strict";var e=r(26),i=r(6),o=r(121),u=[].slice,c={},f=function(t,n,r){if(!(n in c)){for(var e=[],i=0;i<n;i++)e[i]="a["+i+"]";c[n]=Function("F,a","return new F("+e.join(",")+")")}return c[n](t,r)};t.exports=Function.bind||function(t){var n=e(this),r=u.call(arguments,1),c=function(){var e=r.concat(u.call(arguments));return this instanceof c?f(n,e.length,e):o(n,e,t)};return i(n.prototype)&&(c.prototype=n.prototype),c}},function(t,n,r){"use strict";var e=r(11).f,i=r(70),o=r(73),u=r(53),c=r(68),f=r(46),a=r(79),s=r(140),l=r(170),h=r(74),v=r(10),p=r(65).fastKey,d=v?"_s":"size",y=function(t,n){var r,e=p(n);if("F"!==e)return t._i[e];for(r=t._f;r;r=r.n)if(r.k==n)return r};t.exports={getConstructor:function(t,n,r,s){var l=t(function(t,e){c(t,l,n,"_i"),t._i=i(null),t._f=void 0,t._l=void 0,t[d]=0,void 0!=e&&a(e,r,t[s],t)});return o(l.prototype,{clear:function(){for(var t=this,n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[d]=0},delete:function(t){var n=this,r=y(n,t);if(r){var e=r.n,i=r.p;delete n._i[r.i],r.r=!0,i&&(i.n=e),e&&(e.p=i),n._f==r&&(n._f=e),n._l==r&&(n._l=i),n[d]--}return!!r},forEach:function(t){c(this,l,"forEach");for(var n,r=u(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!y(this,t)}}),v&&e(l.prototype,"size",{get:function(){return f(this[d])}}),l},def:function(t,n,r){var e,i,o=y(t,n);return o?o.v=r:(t._l=o={i:i=p(n,!0),k:n,v:r,p:e=t._l,n:void 0,r:!1},t._f||(t._f=o),e&&(e.n=o),t[d]++,"F"!==i&&(t._i[i]=o)),t},getEntry:y,setStrong:function(t,n,r){s(t,n,function(t,n){this._t=t,this._k=n,this._l=void 0},function(){for(var t=this,n=t._k,r=t._l;r&&r.r;)r=r.p;return t._t&&(t._l=r=r?r.n:t._t._f)?"keys"==n?l(0,r.k):"values"==n?l(0,r.v):l(0,[r.k,r.v]):(t._t=void 0,l(1))},r?"entries":"values",!r,!0),h(n)}}},function(t,n,r){var e=r(114),i=r(161);t.exports=function(t){return function(){if(e(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,n,r){"use strict";var e=r(73),i=r(65).getWeak,o=r(2),u=r(6),c=r(68),f=r(79),a=r(48),s=r(24),l=a(5),h=a(6),v=0,p=function(t){return t._l||(t._l=new d)},d=function(){this.a=[]},y=function(t,n){return l(t.a,function(t){return t[0]===n})};d.prototype={get:function(t){var n=y(this,t);if(n)return n[1]},has:function(t){return!!y(this,t)},set:function(t,n){var r=y(this,t);r?r[1]=n:this.a.push([t,n])},delete:function(t){var n=h(this.a,function(n){return n[0]===t});return~n&&this.a.splice(n,1),!!~n}},t.exports={getConstructor:function(t,n,r,o){var a=t(function(t,e){c(t,a,n,"_i"),t._i=v++,t._l=void 0,void 0!=e&&f(e,r,t[o],t)});return e(a.prototype,{delete:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).delete(t):n&&s(n,this._i)&&delete n[this._i]},has:function(t){if(!u(t))return!1;var n=i(t);return!0===n?p(this).has(t):n&&s(n,this._i)}}),a},def:function(t,n,r){var e=i(o(n),!0);return!0===e?p(t).set(n,r):e[t._i]=r,t},ufstore:p}},function(t,n,r){t.exports=!r(10)&&!r(4)(function(){return 7!=Object.defineProperty(r(132)("div"),"a",{get:function(){return 7}}).a})},function(t,n,r){var e=r(6),i=Math.floor;t.exports=function(t){return!e(t)&&isFinite(t)&&i(t)===t}},function(t,n,r){var e=r(2);t.exports=function(t,n,r,i){try{return i?n(e(r)[0],r[1]):n(r)}catch(n){var o=t.return;throw void 0!==o&&e(o.call(t)),n}}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,n,r){"use strict";var e=r(72),i=r(125),o=r(116),u=r(17),c=r(115),f=Object.assign;t.exports=!f||r(4)(function(){var t={},n={},r=Symbol(),e="abcdefghijklmnopqrst";return t[r]=7,e.split("").forEach(function(t){n[t]=t}),7!=f({},t)[r]||Object.keys(f({},n)).join("")!=e})?function(t,n){for(var r=u(t),f=arguments.length,a=1,s=i.f,l=o.f;f>a;)for(var h,v=c(arguments[a++]),p=s?e(v).concat(s(v)):e(v),d=p.length,y=0;d>y;)l.call(v,h=p[y++])&&(r[h]=v[h]);return r}:f},function(t,n,r){var e=r(11),i=r(2),o=r(72);t.exports=r(10)?Object.defineProperties:function(t,n){i(t);for(var r,u=o(n),c=u.length,f=0;c>f;)e.f(t,r=u[f++],n[r]);return t}},function(t,n,r){var e=r(30),i=r(71).f,o={}.toString,u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],c=function(t){try{return i(t)}catch(t){return u.slice()}};t.exports.f=function(t){return u&&"[object Window]"==o.call(t)?c(t):i(e(t))}},function(t,n,r){var e=r(24),i=r(30),o=r(117)(!1),u=r(145)("IE_PROTO");t.exports=function(t,n){var r,c=i(t),f=0,a=[];for(r in c)r!=u&&e(c,r)&&a.push(r);for(;n.length>f;)e(c,r=n[f++])&&(~o(a,r)||a.push(r));return a}},function(t,n,r){var e=r(72),i=r(30),o=r(116).f;t.exports=function(t){return function(n){for(var r,u=i(n),c=e(u),f=c.length,a=0,s=[];f>a;)o.call(u,r=c[a++])&&s.push(t?[r,u[r]]:u[r]);return s}}},function(t,n,r){var e=r(71),i=r(125),o=r(2),u=r(3).Reflect;t.exports=u&&u.ownKeys||function(t){var n=e.f(o(t)),r=i.f;return r?n.concat(r(t)):n}},function(t,n,r){var e=r(3).parseFloat,i=r(82).trim;t.exports=1/e(r(150)+"-0")!=-1/0?function(t){var n=i(String(t),3),r=e(n);return 0===r&&"-"==n.charAt(0)?-0:r}:e},function(t,n,r){var e=r(3).parseInt,i=r(82).trim,o=r(150),u=/^[\-+]?0[xX]/;t.exports=8!==e(o+"08")||22!==e(o+"0x16")?function(t,n){var r=i(String(t),3);return e(r,n>>>0||(u.test(r)?16:10))}:e},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t==1/n:t!=t&&n!=n}},function(t,n,r){var e=r(16),i=r(149),o=r(46);t.exports=function(t,n,r,u){var c=String(o(t)),f=c.length,a=void 0===r?" ":String(r),s=e(n);if(s<=f||""==a)return c;var l=s-f,h=i.call(a,Math.ceil(l/a.length));return h.length>l&&(h=h.slice(0,l)),u?h+c:c+h}},function(t,n,r){n.f=r(7)},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var n=e.getEntry(this,t);return n&&n.v},set:function(t,n){return e.def(this,0===t?0:t,n)}},e,!0)},function(t,n,r){r(10)&&"g"!=/./g.flags&&r(11).f(RegExp.prototype,"flags",{configurable:!0,get:r(120)})},function(t,n,r){"use strict";var e=r(164);t.exports=r(118)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t=0===t?0:t,t)}},e)},function(t,n,r){"use strict";var e,i=r(48)(0),o=r(28),u=r(65),c=r(172),f=r(166),a=r(6),s=u.getWeak,l=Object.isExtensible,h=f.ufstore,v={},p=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},d={get:function(t){if(a(t)){var n=s(t);return!0===n?h(this).get(t):n?n[this._i]:void 0}},set:function(t,n){return f.def(this,t,n)}},y=t.exports=r(118)("WeakMap",p,d,f,!0,!0);7!=(new y).set((Object.freeze||Object)(v),7).get(v)&&(e=f.getConstructor(p),c(e.prototype,d),u.NEED=!0,i(["delete","has","get","set"],function(t){var n=y.prototype,r=n[t];o(n,t,function(n,i){if(a(n)&&!l(n)){this._f||(this._f=new e);var o=this._f[t](n,i);return"set"==t?this:o}return r.call(this,n,i)})}))},,,,function(t,n){"use strict";function r(){var t=document.querySelector("#page-nav");if(t&&!document.querySelector("#page-nav .extend.prev")&&(t.innerHTML='<a class="extend prev disabled" rel="prev">&laquo; Prev</a>'+t.innerHTML),t&&!document.querySelector("#page-nav .extend.next")&&(t.innerHTML=t.innerHTML+'<a class="extend next disabled" rel="next">Next &raquo;</a>'),yiliaConfig&&yiliaConfig.open_in_new){document.querySelectorAll(".article-entry a:not(.article-more-a)").forEach(function(t){var n=t.getAttribute("target");n&&""!==n||t.setAttribute("target","_blank")})}if(yiliaConfig&&yiliaConfig.toc_hide_index){document.querySelectorAll(".toc-number").forEach(function(t){t.style.display="none"})}var n=document.querySelector("#js-aboutme");n&&0!==n.length&&(n.innerHTML=n.innerText)}t.exports={init:r}},function(t,n,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function i(t,n){var r=/\/|index.html/g;return t.replace(r,"")===n.replace(r,"")}function o(){for(var t=document.querySelectorAll(".js-header-menu li a"),n=window.location.pathname,r=0,e=t.length;r<e;r++){var o=t[r];i(n,o.getAttribute("href"))&&(0,h.default)(o,"active")}}function u(t){for(var n=t.offsetLeft,r=t.offsetParent;null!==r;)n+=r.offsetLeft,r=r.offsetParent;return n}function c(t){for(var n=t.offsetTop,r=t.offsetParent;null!==r;)n+=r.offsetTop,r=r.offsetParent;return n}function f(t,n,r,e,i){var o=u(t),f=c(t)-n;if(f-r<=i){var a=t.$newDom;a||(a=t.cloneNode(!0),(0,d.default)(t,a),t.$newDom=a,a.style.position="fixed",a.style.top=(r||f)+"px",a.style.left=o+"px",a.style.zIndex=e||2,a.style.width="100%",a.style.color="#fff"),a.style.visibility="visible",t.style.visibility="hidden"}else{t.style.visibility="visible";var s=t.$newDom;s&&(s.style.visibility="hidden")}}function a(){var t=document.querySelector(".js-overlay"),n=document.querySelector(".js-header-menu");f(t,document.body.scrollTop,-63,2,0),f(n,document.body.scrollTop,1,3,0)}function s(){document.querySelector("#container").addEventListener("scroll",function(t){a()}),window.addEventListener("scroll",function(t){a()}),a()}var l=r(156),h=e(l),v=r(157),p=(e(v),r(382)),d=e(p),y=r(128),g=e(y),b=r(190),m=e(b),x=r(129);(function(){g.default.versions.mobile&&window.screen.width<800&&(o(),s())})(),(0,x.addLoadEvent)(function(){m.default.init()}),t.exports={}},,,,function(t,n,r){(function(t){"use strict";function n(t,n,r){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:r})}if(r(381),r(391),r(198),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&n(Array,t,Function.call.bind([][t]))})}).call(n,function(){return this}())},,,function(t,n,r){r(210),t.exports=r(52).RegExp.escape},,,,function(t,n,r){var e=r(6),i=r(138),o=r(7)("species");t.exports=function(t){var n;return i(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!i(n.prototype)||(n=void 0),e(n)&&null===(n=n[o])&&(n=void 0)),void 0===n?Array:n}},function(t,n,r){var e=r(202);t.exports=function(t,n){return new(e(t))(n)}},function(t,n,r){"use strict";var e=r(2),i=r(50),o="number";t.exports=function(t){if("string"!==t&&t!==o&&"default"!==t)throw TypeError("Incorrect hint");return i(e(this),t!=o)}},function(t,n,r){var e=r(72),i=r(125),o=r(116);t.exports=function(t){var n=e(t),r=i.f;if(r)for(var u,c=r(t),f=o.f,a=0;c.length>a;)f.call(t,u=c[a++])&&n.push(u);return n}},function(t,n,r){var e=r(72),i=r(30);t.exports=function(t,n){for(var r,o=i(t),u=e(o),c=u.length,f=0;c>f;)if(o[r=u[f++]]===n)return r}},function(t,n,r){"use strict";var e=r(208),i=r(121),o=r(26);t.exports=function(){for(var t=o(this),n=arguments.length,r=Array(n),u=0,c=e._,f=!1;n>u;)(r[u]=arguments[u++])===c&&(f=!0);return function(){var e,o=this,u=arguments.length,a=0,s=0;if(!f&&!u)return i(t,r,o);if(e=r.slice(),f)for(;n>a;a++)e[a]===c&&(e[a]=arguments[s++]);for(;u>s;)e.push(arguments[s++]);return i(t,e,o)}}},function(t,n,r){t.exports=r(3)},function(t,n){t.exports=function(t,n){var r=n===Object(n)?function(t){return n[t]}:n;return function(n){return String(n).replace(t,r)}}},function(t,n,r){var e=r(1),i=r(209)(/[\\^$*+?.()|[\]{}]/g,"\\$&");e(e.S,"RegExp",{escape:function(t){return i(t)}})},function(t,n,r){var e=r(1);e(e.P,"Array",{copyWithin:r(160)}),r(78)("copyWithin")},function(t,n,r){"use strict";var e=r(1),i=r(48)(4);e(e.P+e.F*!r(47)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.P,"Array",{fill:r(130)}),r(78)("fill")},function(t,n,r){"use strict";var e=r(1),i=r(48)(2);e(e.P+e.F*!r(47)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(6),o="findIndex",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(5),o="find",u=!0;o in[]&&Array(1)[o](function(){u=!1}),e(e.P+e.F*u,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)(o)},function(t,n,r){"use strict";var e=r(1),i=r(48)(0),o=r(47)([].forEach,!0);e(e.P+e.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(53),i=r(1),o=r(17),u=r(169),c=r(137),f=r(16),a=r(131),s=r(154);i(i.S+i.F*!r(123)(function(t){Array.from(t)}),"Array",{from:function(t){var n,r,i,l,h=o(t),v="function"==typeof this?this:Array,p=arguments.length,d=p>1?arguments[1]:void 0,y=void 0!==d,g=0,b=s(h);if(y&&(d=e(d,p>2?arguments[2]:void 0,2)),void 0==b||v==Array&&c(b))for(n=f(h.length),r=new v(n);n>g;g++)a(r,g,y?d(h[g],g):h[g]);else for(l=b.call(h),r=new v;!(i=l.next()).done;g++)a(r,g,y?u(l,d,[i.value,g],!0):i.value);return r.length=g,r}})},function(t,n,r){"use strict";var e=r(1),i=r(117)(!1),o=[].indexOf,u=!!o&&1/[1].indexOf(1,-0)<0;e(e.P+e.F*(u||!r(47)(o)),"Array",{indexOf:function(t){return u?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,n,r){var e=r(1);e(e.S,"Array",{isArray:r(138)})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=[].join;e(e.P+e.F*(r(115)!=Object||!r(47)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,n,r){"use strict";var e=r(1),i=r(30),o=r(67),u=r(16),c=[].lastIndexOf,f=!!c&&1/[1].lastIndexOf(1,-0)<0;e(e.P+e.F*(f||!r(47)(c)),"Array",{lastIndexOf:function(t){if(f)return c.apply(this,arguments)||0;var n=i(this),r=u(n.length),e=r-1;for(arguments.length>1&&(e=Math.min(e,o(arguments[1]))),e<0&&(e=r+e);e>=0;e--)if(e in n&&n[e]===t)return e||0;return-1}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(1);e(e.P+e.F*!r(47)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(131);e(e.S+e.F*r(4)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,n=arguments.length,r=new("function"==typeof this?this:Array)(n);n>t;)i(r,t,arguments[t++]);return r.length=n,r}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,n,r){"use strict";var e=r(1),i=r(162);e(e.P+e.F*!r(47)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(135),o=r(45),u=r(75),c=r(16),f=[].slice;e(e.P+e.F*r(4)(function(){i&&f.call(i)}),"Array",{slice:function(t,n){var r=c(this.length),e=o(this);if(n=void 0===n?r:n,"Array"==e)return f.call(this,t,n);for(var i=u(t,r),a=u(n,r),s=c(a-i),l=Array(s),h=0;h<s;h++)l[h]="String"==e?this.charAt(i+h):this[i+h];return l}})},function(t,n,r){"use strict";var e=r(1),i=r(48)(3);e(e.P+e.F*!r(47)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,n,r){"use strict";var e=r(1),i=r(26),o=r(17),u=r(4),c=[].sort,f=[1,2,3];e(e.P+e.F*(u(function(){f.sort(void 0)})||!u(function(){f.sort(null)})||!r(47)(c)),"Array",{sort:function(t){return void 0===t?c.call(o(this)):c.call(o(this),i(t))}})},function(t,n,r){r(74)("Array")},function(t,n,r){var e=r(1);e(e.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=Date.prototype.getTime,u=function(t){return t>9?t:"0"+t};e(e.P+e.F*(i(function(){return"0385-07-25T07:06:39.999Z"!=new Date(-5e13-1).toISOString()})||!i(function(){new Date(NaN).toISOString()})),"Date",{toISOString:function(){
if(!isFinite(o.call(this)))throw RangeError("Invalid time value");var t=this,n=t.getUTCFullYear(),r=t.getUTCMilliseconds(),e=n<0?"-":n>9999?"+":"";return e+("00000"+Math.abs(n)).slice(e?-6:-4)+"-"+u(t.getUTCMonth()+1)+"-"+u(t.getUTCDate())+"T"+u(t.getUTCHours())+":"+u(t.getUTCMinutes())+":"+u(t.getUTCSeconds())+"."+(r>99?r:"0"+u(r))+"Z"}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50);e(e.P+e.F*r(4)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var n=i(this),r=o(n);return"number"!=typeof r||isFinite(r)?n.toISOString():null}})},function(t,n,r){var e=r(7)("toPrimitive"),i=Date.prototype;e in i||r(27)(i,e,r(204))},function(t,n,r){var e=Date.prototype,i="Invalid Date",o="toString",u=e[o],c=e.getTime;new Date(NaN)+""!=i&&r(28)(e,o,function(){var t=c.call(this);return t===t?u.call(this):i})},function(t,n,r){var e=r(1);e(e.P,"Function",{bind:r(163)})},function(t,n,r){"use strict";var e=r(6),i=r(32),o=r(7)("hasInstance"),u=Function.prototype;o in u||r(11).f(u,o,{value:function(t){if("function"!=typeof this||!e(t))return!1;if(!e(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,n,r){var e=r(11).f,i=r(66),o=r(24),u=Function.prototype,c="name",f=Object.isExtensible||function(){return!0};c in u||r(10)&&e(u,c,{configurable:!0,get:function(){try{var t=this,n=(""+t).match(/^\s*function ([^ (]*)/)[1];return o(t,c)||!f(t)||e(t,c,i(5,n)),n}catch(t){return""}}})},function(t,n,r){var e=r(1),i=r(171),o=Math.sqrt,u=Math.acosh;e(e.S+e.F*!(u&&710==Math.floor(u(Number.MAX_VALUE))&&u(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,n,r){function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}var i=r(1),o=Math.asinh;i(i.S+i.F*!(o&&1/o(0)>0),"Math",{asinh:e})},function(t,n,r){var e=r(1),i=Math.atanh;e(e.S+e.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,n,r){var e=r(1),i=r(142);e(e.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,n,r){var e=r(1),i=Math.exp;e(e.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,n,r){var e=r(1),i=r(141);e(e.S+e.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,n,r){var e=r(1),i=r(142),o=Math.pow,u=o(2,-52),c=o(2,-23),f=o(2,127)*(2-c),a=o(2,-126),s=function(t){return t+1/u-1/u};e(e.S,"Math",{fround:function(t){var n,r,e=Math.abs(t),o=i(t);return e<a?o*s(e/a/c)*a*c:(n=(1+c/u)*e,r=n-(n-e),r>f||r!=r?o*(1/0):o*r)}})},function(t,n,r){var e=r(1),i=Math.abs;e(e.S,"Math",{hypot:function(t,n){for(var r,e,o=0,u=0,c=arguments.length,f=0;u<c;)r=i(arguments[u++]),f<r?(e=f/r,o=o*e*e+1,f=r):r>0?(e=r/f,o+=e*e):o+=r;return f===1/0?1/0:f*Math.sqrt(o)}})},function(t,n,r){var e=r(1),i=Math.imul;e(e.S+e.F*r(4)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,n){var r=65535,e=+t,i=+n,o=r&e,u=r&i;return 0|o*u+((r&e>>>16)*u+o*(r&i>>>16)<<16>>>0)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log10:function(t){return Math.log(t)/Math.LN10}})},function(t,n,r){var e=r(1);e(e.S,"Math",{log1p:r(171)})},function(t,n,r){var e=r(1);e(e.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,n,r){var e=r(1);e(e.S,"Math",{sign:r(142)})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S+e.F*r(4)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,n,r){var e=r(1),i=r(141),o=Math.exp;e(e.S,"Math",{tanh:function(t){var n=i(t=+t),r=i(-t);return n==1/0?1:r==1/0?-1:(n-r)/(o(t)+o(-t))}})},function(t,n,r){var e=r(1);e(e.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(45),u=r(136),c=r(50),f=r(4),a=r(71).f,s=r(31).f,l=r(11).f,h=r(82).trim,v="Number",p=e[v],d=p,y=p.prototype,g=o(r(70)(y))==v,b="trim"in String.prototype,m=function(t){var n=c(t,!1);if("string"==typeof n&&n.length>2){n=b?n.trim():h(n,3);var r,e,i,o=n.charCodeAt(0);if(43===o||45===o){if(88===(r=n.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(n.charCodeAt(1)){case 66:case 98:e=2,i=49;break;case 79:case 111:e=8,i=55;break;default:return+n}for(var u,f=n.slice(2),a=0,s=f.length;a<s;a++)if((u=f.charCodeAt(a))<48||u>i)return NaN;return parseInt(f,e)}}return+n};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var n=arguments.length<1?0:t,r=this;return r instanceof p&&(g?f(function(){y.valueOf.call(r)}):o(r)!=v)?u(new d(m(n)),r,p):m(n)};for(var x,w=r(10)?a(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),S=0;w.length>S;S++)i(d,x=w[S])&&!i(p,x)&&l(p,x,s(d,x));p.prototype=y,y.constructor=p,r(28)(e,v,p)}},function(t,n,r){var e=r(1);e(e.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,n,r){var e=r(1),i=r(3).isFinite;e(e.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,n,r){var e=r(1);e(e.S,"Number",{isInteger:r(168)})},function(t,n,r){var e=r(1);e(e.S,"Number",{isNaN:function(t){return t!=t}})},function(t,n,r){var e=r(1),i=r(168),o=Math.abs;e(e.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,n,r){var e=r(1);e(e.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,r){var e=r(1);e(e.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,n,r){var e=r(1),i=r(178);e(e.S+e.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.S+e.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,n,r){"use strict";var e=r(1),i=r(67),o=r(159),u=r(149),c=1..toFixed,f=Math.floor,a=[0,0,0,0,0,0],s="Number.toFixed: incorrect invocation!",l="0",h=function(t,n){for(var r=-1,e=n;++r<6;)e+=t*a[r],a[r]=e%1e7,e=f(e/1e7)},v=function(t){for(var n=6,r=0;--n>=0;)r+=a[n],a[n]=f(r/t),r=r%t*1e7},p=function(){for(var t=6,n="";--t>=0;)if(""!==n||0===t||0!==a[t]){var r=String(a[t]);n=""===n?r:n+u.call(l,7-r.length)+r}return n},d=function(t,n,r){return 0===n?r:n%2==1?d(t,n-1,r*t):d(t*t,n/2,r)},y=function(t){for(var n=0,r=t;r>=4096;)n+=12,r/=4096;for(;r>=2;)n+=1,r/=2;return n};e(e.P+e.F*(!!c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(4)(function(){c.call({})})),"Number",{toFixed:function(t){var n,r,e,c,f=o(this,s),a=i(t),g="",b=l;if(a<0||a>20)throw RangeError(s);if(f!=f)return"NaN";if(f<=-1e21||f>=1e21)return String(f);if(f<0&&(g="-",f=-f),f>1e-21)if(n=y(f*d(2,69,1))-69,r=n<0?f*d(2,-n,1):f/d(2,n,1),r*=4503599627370496,(n=52-n)>0){for(h(0,r),e=a;e>=7;)h(1e7,0),e-=7;for(h(d(10,e,1),0),e=n-1;e>=23;)v(1<<23),e-=23;v(1<<e),h(1,1),v(2),b=p()}else h(0,r),h(1<<-n,0),b=p()+u.call(l,a);return a>0?(c=b.length,b=g+(c<=a?"0."+u.call(l,a-c)+b:b.slice(0,c-a)+"."+b.slice(c-a))):b=g+b,b}})},function(t,n,r){"use strict";var e=r(1),i=r(4),o=r(159),u=1..toPrecision;e(e.P+e.F*(i(function(){return"1"!==u.call(1,void 0)})||!i(function(){u.call({})})),"Number",{toPrecision:function(t){var n=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?u.call(n):u.call(n,t)}})},function(t,n,r){var e=r(1);e(e.S+e.F,"Object",{assign:r(172)})},function(t,n,r){var e=r(1);e(e.S,"Object",{create:r(70)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperties:r(173)})},function(t,n,r){var e=r(1);e(e.S+e.F*!r(10),"Object",{defineProperty:r(11).f})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("freeze",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(30),i=r(31).f;r(49)("getOwnPropertyDescriptor",function(){return function(t,n){return i(e(t),n)}})},function(t,n,r){r(49)("getOwnPropertyNames",function(){return r(174).f})},function(t,n,r){var e=r(17),i=r(32);r(49)("getPrototypeOf",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6);r(49)("isExtensible",function(t){return function(n){return!!e(n)&&(!t||t(n))}})},function(t,n,r){var e=r(6);r(49)("isFrozen",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(6);r(49)("isSealed",function(t){return function(n){return!e(n)||!!t&&t(n)}})},function(t,n,r){var e=r(1);e(e.S,"Object",{is:r(180)})},function(t,n,r){var e=r(17),i=r(72);r(49)("keys",function(){return function(t){return i(e(t))}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("preventExtensions",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(6),i=r(65).onFreeze;r(49)("seal",function(t){return function(n){return t&&e(n)?t(i(n)):n}})},function(t,n,r){var e=r(1);e(e.S,"Object",{setPrototypeOf:r(144).set})},function(t,n,r){"use strict";var e=r(114),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(28)(Object.prototype,"toString",function(){return"[object "+e(this)+"]"},!0)},function(t,n,r){var e=r(1),i=r(178);e(e.G+e.F*(parseFloat!=i),{parseFloat:i})},function(t,n,r){var e=r(1),i=r(179);e(e.G+e.F*(parseInt!=i),{parseInt:i})},function(t,n,r){"use strict";var e,i,o,u=r(69),c=r(3),f=r(53),a=r(114),s=r(1),l=r(6),h=r(26),v=r(68),p=r(79),d=r(146),y=r(151).set,g=r(143)(),b="Promise",m=c.TypeError,x=c.process,w=c[b],x=c.process,S="process"==a(x),_=function(){},O=!!function(){try{var t=w.resolve(1),n=(t.constructor={})[r(7)("species")]=function(t){t(_,_)};return(S||"function"==typeof PromiseRejectionEvent)&&t.then(_)instanceof n}catch(t){}}(),E=function(t,n){return t===n||t===w&&n===o},P=function(t){var n;return!(!l(t)||"function"!=typeof(n=t.then))&&n},j=function(t){return E(w,t)?new F(t):new i(t)},F=i=function(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw m("Bad Promise constructor");n=t,r=e}),this.resolve=h(n),this.reject=h(r)},M=function(t){try{t()}catch(t){return{error:t}}},A=function(t,n){if(!t._n){t._n=!0;var r=t._c;g(function(){for(var e=t._v,i=1==t._s,o=0;r.length>o;)!function(n){var r,o,u=i?n.ok:n.fail,c=n.resolve,f=n.reject,a=n.domain;try{u?(i||(2==t._h&&I(t),t._h=1),!0===u?r=e:(a&&a.enter(),r=u(e),a&&a.exit()),r===n.promise?f(m("Promise-chain cycle")):(o=P(r))?o.call(r,c,f):c(r)):f(e)}catch(t){f(t)}}(r[o++]);t._c=[],t._n=!1,n&&!t._h&&N(t)})}},N=function(t){y.call(c,function(){var n,r,e,i=t._v;if(T(t)&&(n=M(function(){S?x.emit("unhandledRejection",i,t):(r=c.onunhandledrejection)?r({promise:t,reason:i}):(e=c.console)&&e.error&&e.error("Unhandled promise rejection",i)}),t._h=S||T(t)?2:1),t._a=void 0,n)throw n.error})},T=function(t){if(1==t._h)return!1;for(var n,r=t._a||t._c,e=0;r.length>e;)if(n=r[e++],n.fail||!T(n.promise))return!1;return!0},I=function(t){y.call(c,function(){var n;S?x.emit("rejectionHandled",t):(n=c.onrejectionhandled)&&n({promise:t,reason:t._v})})},k=function(t){var n=this;n._d||(n._d=!0,n=n._w||n,n._v=t,n._s=2,n._a||(n._a=n._c.slice()),A(n,!0))},L=function(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw m("Promise can't be resolved itself");(n=P(t))?g(function(){var e={_w:r,_d:!1};try{n.call(t,f(L,e,1),f(k,e,1))}catch(t){k.call(e,t)}}):(r._v=t,r._s=1,A(r,!1))}catch(t){k.call({_w:r,_d:!1},t)}}};O||(w=function(t){v(this,w,b,"_h"),h(t),e.call(this);try{t(f(L,this,1),f(k,this,1))}catch(t){k.call(this,t)}},e=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},e.prototype=r(73)(w.prototype,{then:function(t,n){var r=j(d(this,w));return r.ok="function"!=typeof t||t,r.fail="function"==typeof n&&n,r.domain=S?x.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&A(this,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),F=function(){var t=new e;this.promise=t,this.resolve=f(L,t,1),this.reject=f(k,t,1)}),s(s.G+s.W+s.F*!O,{Promise:w}),r(81)(w,b),r(74)(b),o=r(52)[b],s(s.S+s.F*!O,b,{reject:function(t){var n=j(this);return(0,n.reject)(t),n.promise}}),s(s.S+s.F*(u||!O),b,{resolve:function(t){if(t instanceof w&&E(t.constructor,this))return t;var n=j(this);return(0,n.resolve)(t),n.promise}}),s(s.S+s.F*!(O&&r(123)(function(t){w.all(t).catch(_)})),b,{all:function(t){var n=this,r=j(n),e=r.resolve,i=r.reject,o=M(function(){var r=[],o=0,u=1;p(t,!1,function(t){var c=o++,f=!1;r.push(void 0),u++,n.resolve(t).then(function(t){f||(f=!0,r[c]=t,--u||e(r))},i)}),--u||e(r)});return o&&i(o.error),r.promise},race:function(t){var n=this,r=j(n),e=r.reject,i=M(function(){p(t,!1,function(t){n.resolve(t).then(r.resolve,e)})});return i&&e(i.error),r.promise}})},function(t,n,r){var e=r(1),i=r(26),o=r(2),u=(r(3).Reflect||{}).apply,c=Function.apply;e(e.S+e.F*!r(4)(function(){u(function(){})}),"Reflect",{apply:function(t,n,r){var e=i(t),f=o(r);return u?u(e,n,f):c.call(e,n,f)}})},function(t,n,r){var e=r(1),i=r(70),o=r(26),u=r(2),c=r(6),f=r(4),a=r(163),s=(r(3).Reflect||{}).construct,l=f(function(){function t(){}return!(s(function(){},[],t)instanceof t)}),h=!f(function(){s(function(){})});e(e.S+e.F*(l||h),"Reflect",{construct:function(t,n){o(t),u(n);var r=arguments.length<3?t:o(arguments[2]);if(h&&!l)return s(t,n,r);if(t==r){switch(n.length){case 0:return new t;case 1:return new t(n[0]);case 2:return new t(n[0],n[1]);case 3:return new t(n[0],n[1],n[2]);case 4:return new t(n[0],n[1],n[2],n[3])}var e=[null];return e.push.apply(e,n),new(a.apply(t,e))}var f=r.prototype,v=i(c(f)?f:Object.prototype),p=Function.apply.call(t,v,n);return c(p)?p:v}})},function(t,n,r){var e=r(11),i=r(1),o=r(2),u=r(50);i(i.S+i.F*r(4)(function(){Reflect.defineProperty(e.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,n,r){o(t),n=u(n,!0),o(r);try{return e.f(t,n,r),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(31).f,o=r(2);e(e.S,"Reflect",{deleteProperty:function(t,n){var r=i(o(t),n);return!(r&&!r.configurable)&&delete t[n]}})},function(t,n,r){"use strict";var e=r(1),i=r(2),o=function(t){this._t=i(t),this._i=0;var n,r=this._k=[];for(n in t)r.push(n)};r(139)(o,"Object",function(){var t,n=this,r=n._k;do{if(n._i>=r.length)return{value:void 0,done:!0}}while(!((t=r[n._i++])in n._t));return{value:t,done:!1}}),e(e.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,n,r){var e=r(31),i=r(1),o=r(2);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,n){return e.f(o(t),n)}})},function(t,n,r){var e=r(1),i=r(32),o=r(2);e(e.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,n,r){function e(t,n){var r,c,s=arguments.length<3?t:arguments[2];return a(t)===s?t[n]:(r=i.f(t,n))?u(r,"value")?r.value:void 0!==r.get?r.get.call(s):void 0:f(c=o(t))?e(c,n,s):void 0}var i=r(31),o=r(32),u=r(24),c=r(1),f=r(6),a=r(2);c(c.S,"Reflect",{get:e})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{has:function(t,n){return n in t}})},function(t,n,r){var e=r(1),i=r(2),o=Object.isExtensible;e(e.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,n,r){var e=r(1);e(e.S,"Reflect",{ownKeys:r(177)})},function(t,n,r){var e=r(1),i=r(2),o=Object.preventExtensions;e(e.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,n,r){var e=r(1),i=r(144);i&&e(e.S,"Reflect",{setPrototypeOf:function(t,n){i.check(t,n);try{return i.set(t,n),!0}catch(t){return!1}}})},function(t,n,r){function e(t,n,r){var f,h,v=arguments.length<4?t:arguments[3],p=o.f(s(t),n);if(!p){if(l(h=u(t)))return e(h,n,r,v);p=a(0)}return c(p,"value")?!(!1===p.writable||!l(v)||(f=o.f(v,n)||a(0),f.value=r,i.f(v,n,f),0)):void 0!==p.set&&(p.set.call(v,r),!0)}var i=r(11),o=r(31),u=r(32),c=r(24),f=r(1),a=r(66),s=r(2),l=r(6);f(f.S,"Reflect",{set:e})},function(t,n,r){var e=r(3),i=r(136),o=r(11).f,u=r(71).f,c=r(122),f=r(120),a=e.RegExp,s=a,l=a.prototype,h=/a/g,v=/a/g,p=new a(h)!==h;if(r(10)&&(!p||r(4)(function(){return v[r(7)("match")]=!1,a(h)!=h||a(v)==v||"/a/i"!=a(h,"i")}))){a=function(t,n){var r=this instanceof a,e=c(t),o=void 0===n;return!r&&e&&t.constructor===a&&o?t:i(p?new s(e&&!o?t.source:t,n):s((e=t instanceof a)?t.source:t,e&&o?f.call(t):n),r?this:l,a)};for(var d=u(s),y=0;d.length>y;)!function(t){t in a||o(a,t,{configurable:!0,get:function(){return s[t]},set:function(n){s[t]=n}})}(d[y++]);l.constructor=a,a.prototype=l,r(28)(e,"RegExp",a)}r(74)("RegExp")},function(t,n,r){r(119)("match",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("replace",2,function(t,n,r){return[function(e,i){"use strict";var o=t(this),u=void 0==e?void 0:e[n];return void 0!==u?u.call(e,o,i):r.call(String(o),e,i)},r]})},function(t,n,r){r(119)("search",1,function(t,n,r){return[function(r){"use strict";var e=t(this),i=void 0==r?void 0:r[n];return void 0!==i?i.call(r,e):new RegExp(r)[n](String(e))},r]})},function(t,n,r){r(119)("split",2,function(t,n,e){"use strict";var i=r(122),o=e,u=[].push,c="split",f="length",a="lastIndex";if("c"=="abbc"[c](/(b)*/)[1]||4!="test"[c](/(?:)/,-1)[f]||2!="ab"[c](/(?:ab)*/)[f]||4!="."[c](/(.?)(.?)/)[f]||"."[c](/()()/)[f]>1||""[c](/.?/)[f]){var s=void 0===/()??/.exec("")[1];e=function(t,n){var r=String(this);if(void 0===t&&0===n)return[];if(!i(t))return o.call(r,t,n);var e,c,l,h,v,p=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,g=void 0===n?4294967295:n>>>0,b=new RegExp(t.source,d+"g");for(s||(e=new RegExp("^"+b.source+"$(?!\\s)",d));(c=b.exec(r))&&!((l=c.index+c[0][f])>y&&(p.push(r.slice(y,c.index)),!s&&c[f]>1&&c[0].replace(e,function(){for(v=1;v<arguments[f]-2;v++)void 0===arguments[v]&&(c[v]=void 0)}),c[f]>1&&c.index<r[f]&&u.apply(p,c.slice(1)),h=c[0][f],y=l,p[f]>=g));)b[a]===c.index&&b[a]++;return y===r[f]?!h&&b.test("")||p.push(""):p.push(r.slice(y)),p[f]>g?p.slice(0,g):p}}else"0"[c](void 0,0)[f]&&(e=function(t,n){return void 0===t&&0===n?[]:o.call(this,t,n)});return[function(r,i){var o=t(this),u=void 0==r?void 0:r[n];return void 0!==u?u.call(r,o,i):e.call(String(o),r,i)},e]})},function(t,n,r){"use strict";r(184);var e=r(2),i=r(120),o=r(10),u="toString",c=/./[u],f=function(t){r(28)(RegExp.prototype,u,t,!0)};r(4)(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?f(function(){var t=e(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):c.name!=u&&f(function(){return c.call(this)})},function(t,n,r){"use strict";r(29)("anchor",function(t){return function(n){return t(this,"a","name",n)}})},function(t,n,r){"use strict";r(29)("big",function(t){return function(){return t(this,"big","","")}})},function(t,n,r){"use strict";r(29)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,n,r){"use strict";r(29)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!1);e(e.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="endsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{endsWith:function(t){var n=o(this,t,u),r=arguments.length>1?arguments[1]:void 0,e=i(n.length),f=void 0===r?e:Math.min(i(r),e),a=String(t);return c?c.call(n,a,f):n.slice(f-a.length,f)===a}})},function(t,n,r){"use strict";r(29)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,n,r){"use strict";r(29)("fontcolor",function(t){return function(n){return t(this,"font","color",n)}})},function(t,n,r){"use strict";r(29)("fontsize",function(t){return function(n){return t(this,"font","size",n)}})},function(t,n,r){var e=r(1),i=r(75),o=String.fromCharCode,u=String.fromCodePoint;e(e.S+e.F*(!!u&&1!=u.length),"String",{fromCodePoint:function(t){for(var n,r=[],e=arguments.length,u=0;e>u;){if(n=+arguments[u++],i(n,1114111)!==n)throw RangeError(n+" is not a valid code point");r.push(n<65536?o(n):o(55296+((n-=65536)>>10),n%1024+56320))}return r.join("")}})},function(t,n,r){"use strict";var e=r(1),i=r(148),o="includes";e(e.P+e.F*r(134)(o),"String",{includes:function(t){return!!~i(this,t,o).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){"use strict";r(29)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,n,r){"use strict";var e=r(147)(!0);r(140)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,r=this._i;return r>=n.length?{value:void 0,done:!0}:(t=e(n,r),this._i+=t.length,{value:t,done:!1})})},function(t,n,r){"use strict";r(29)("link",function(t){return function(n){return t(this,"a","href",n)}})},function(t,n,r){var e=r(1),i=r(30),o=r(16);e(e.S,"String",{raw:function(t){for(var n=i(t.raw),r=o(n.length),e=arguments.length,u=[],c=0;r>c;)u.push(String(n[c++])),c<e&&u.push(String(arguments[c]));return u.join("")}})},function(t,n,r){var e=r(1);e(e.P,"String",{repeat:r(149)})},function(t,n,r){"use strict";r(29)("small",function(t){return function(){return t(this,"small","","")}})},function(t,n,r){"use strict";var e=r(1),i=r(16),o=r(148),u="startsWith",c=""[u];e(e.P+e.F*r(134)(u),"String",{startsWith:function(t){var n=o(this,t,u),r=i(Math.min(arguments.length>1?arguments[1]:void 0,n.length)),e=String(t);return c?c.call(n,e,r):n.slice(r,r+e.length)===e}})},function(t,n,r){"use strict";r(29)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,n,r){"use strict";r(29)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,n,r){"use strict";r(29)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,n,r){"use strict";r(82)("trim",function(t){return function(){return t(this,3)}})},function(t,n,r){"use strict";var e=r(3),i=r(24),o=r(10),u=r(1),c=r(28),f=r(65).KEY,a=r(4),s=r(126),l=r(81),h=r(76),v=r(7),p=r(182),d=r(153),y=r(206),g=r(205),b=r(138),m=r(2),x=r(30),w=r(50),S=r(66),_=r(70),O=r(174),E=r(31),P=r(11),j=r(72),F=E.f,M=P.f,A=O.f,N=e.Symbol,T=e.JSON,I=T&&T.stringify,k="prototype",L=v("_hidden"),R=v("toPrimitive"),C={}.propertyIsEnumerable,D=s("symbol-registry"),U=s("symbols"),W=s("op-symbols"),G=Object[k],B="function"==typeof N,V=e.QObject,z=!V||!V[k]||!V[k].findChild,q=o&&a(function(){return 7!=_(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(t,n,r){var e=F(G,n);e&&delete G[n],M(t,n,r),e&&t!==G&&M(G,n,e)}:M,K=function(t){var n=U[t]=_(N[k]);return n._k=t,n},J=B&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},Y=function(t,n,r){return t===G&&Y(W,n,r),m(t),n=w(n,!0),m(r),i(U,n)?(r.enumerable?(i(t,L)&&t[L][n]&&(t[L][n]=!1),r=_(r,{enumerable:S(0,!1)})):(i(t,L)||M(t,L,S(1,{})),t[L][n]=!0),q(t,n,r)):M(t,n,r)},H=function(t,n){m(t);for(var r,e=g(n=x(n)),i=0,o=e.length;o>i;)Y(t,r=e[i++],n[r]);return t},$=function(t,n){return void 0===n?_(t):H(_(t),n)},X=function(t){var n=C.call(this,t=w(t,!0));return!(this===G&&i(U,t)&&!i(W,t))&&(!(n||!i(this,t)||!i(U,t)||i(this,L)&&this[L][t])||n)},Q=function(t,n){if(t=x(t),n=w(n,!0),t!==G||!i(U,n)||i(W,n)){var r=F(t,n);return!r||!i(U,n)||i(t,L)&&t[L][n]||(r.enumerable=!0),r}},Z=function(t){for(var n,r=A(x(t)),e=[],o=0;r.length>o;)i(U,n=r[o++])||n==L||n==f||e.push(n);return e},tt=function(t){for(var n,r=t===G,e=A(r?W:x(t)),o=[],u=0;e.length>u;)!i(U,n=e[u++])||r&&!i(G,n)||o.push(U[n]);return o};B||(N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=h(arguments.length>0?arguments[0]:void 0),n=function(r){this===G&&n.call(W,r),i(this,L)&&i(this[L],t)&&(this[L][t]=!1),q(this,t,S(1,r))};return o&&z&&q(G,t,{configurable:!0,set:n}),K(t)},c(N[k],"toString",function(){return this._k}),E.f=Q,P.f=Y,r(71).f=O.f=Z,r(116).f=X,r(125).f=tt,o&&!r(69)&&c(G,"propertyIsEnumerable",X,!0),p.f=function(t){return K(v(t))}),u(u.G+u.W+u.F*!B,{Symbol:N});for(var nt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rt=0;nt.length>rt;)v(nt[rt++]);for(var nt=j(v.store),rt=0;nt.length>rt;)d(nt[rt++]);u(u.S+u.F*!B,"Symbol",{for:function(t){return i(D,t+="")?D[t]:D[t]=N(t)},keyFor:function(t){if(J(t))return y(D,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),u(u.S+u.F*!B,"Object",{create:$,defineProperty:Y,defineProperties:H,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),T&&u(u.S+u.F*(!B||a(function(){var t=N();return"[null]"!=I([t])||"{}"!=I({a:t})||"{}"!=I(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!J(t)){for(var n,r,e=[t],i=1;arguments.length>i;)e.push(arguments[i++]);return n=e[1],"function"==typeof n&&(r=n),!r&&b(n)||(n=function(t,n){if(r&&(n=r.call(this,t,n)),!J(n))return n}),e[1]=n,I.apply(T,e)}}}),N[k][R]||r(27)(N[k],R,N[k].valueOf),l(N,"Symbol"),l(Math,"Math",!0),l(e.JSON,"JSON",!0)},function(t,n,r){"use strict";var e=r(1),i=r(127),o=r(152),u=r(2),c=r(75),f=r(16),a=r(6),s=r(3).ArrayBuffer,l=r(146),h=o.ArrayBuffer,v=o.DataView,p=i.ABV&&s.isView,d=h.prototype.slice,y=i.VIEW,g="ArrayBuffer";e(e.G+e.W+e.F*(s!==h),{ArrayBuffer:h}),e(e.S+e.F*!i.CONSTR,g,{isView:function(t){return p&&p(t)||a(t)&&y in t}}),e(e.P+e.U+e.F*r(4)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,n){if(void 0!==d&&void 0===n)return d.call(u(this),t);for(var r=u(this).byteLength,e=c(t,r),i=c(void 0===n?r:n,r),o=new(l(this,h))(f(i-e)),a=new v(this),s=new v(o),p=0;e<i;)s.setUint8(p++,a.getUint8(e++));return o}}),r(74)(g)},function(t,n,r){var e=r(1);e(e.G+e.W+e.F*!r(127).ABV,{DataView:r(152).DataView})},function(t,n,r){r(55)("Float32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Float64",8,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Int8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint16",2,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint32",4,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}})},function(t,n,r){r(55)("Uint8",1,function(t){return function(n,r,e){return t(this,n,r,e)}},!0)},function(t,n,r){"use strict";var e=r(166);r(118)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return e.def(this,t,!0)}},e,!1,!0)},function(t,n,r){"use strict";var e=r(1),i=r(117)(!0);e(e.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r(78)("includes")},function(t,n,r){var e=r(1),i=r(143)(),o=r(3).process,u="process"==r(45)(o);e(e.G,{asap:function(t){var n=u&&o.domain;i(n?n.bind(t):t)}})},function(t,n,r){var e=r(1),i=r(45);e(e.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Map",{toJSON:r(165)("Map")})},function(t,n,r){var e=r(1);e(e.S,"Math",{iaddh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o+(e>>>0)+((i&u|(i|u)&~(i+u>>>0))>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{imulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>16,f=i>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>16)+((o*f>>>0)+(a&r)>>16)}})},function(t,n,r){var e=r(1);e(e.S,"Math",{isubh:function(t,n,r,e){var i=t>>>0,o=n>>>0,u=r>>>0;return o-(e>>>0)-((~i&u|~(i^u)&i-u>>>0)>>>31)|0}})},function(t,n,r){var e=r(1);e(e.S,"Math",{umulh:function(t,n){var r=65535,e=+t,i=+n,o=e&r,u=i&r,c=e>>>16,f=i>>>16,a=(c*u>>>0)+(o*u>>>16);return c*f+(a>>>16)+((o*f>>>0)+(a&r)>>>16)}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineGetter__:function(t,n){u.f(i(this),t,{get:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(26),u=r(11);r(10)&&e(e.P+r(124),"Object",{__defineSetter__:function(t,n){u.f(i(this),t,{set:o(n),enumerable:!0,configurable:!0})}})},function(t,n,r){var e=r(1),i=r(176)(!0);e(e.S,"Object",{entries:function(t){return i(t)}})},function(t,n,r){var e=r(1),i=r(177),o=r(30),u=r(31),c=r(131);e(e.S,"Object",{getOwnPropertyDescriptors:function(t){for(var n,r=o(t),e=u.f,f=i(r),a={},s=0;f.length>s;)c(a,n=f[s++],e(r,n));return a}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupGetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.get}while(r=u(r))}})},function(t,n,r){"use strict";var e=r(1),i=r(17),o=r(50),u=r(32),c=r(31).f;r(10)&&e(e.P+r(124),"Object",{__lookupSetter__:function(t){var n,r=i(this),e=o(t,!0);do{if(n=c(r,e))return n.set}while(r=u(r))}})},function(t,n,r){var e=r(1),i=r(176)(!1);e(e.S,"Object",{values:function(t){return i(t)}})},function(t,n,r){"use strict";var e=r(1),i=r(3),o=r(52),u=r(143)(),c=r(7)("observable"),f=r(26),a=r(2),s=r(68),l=r(73),h=r(27),v=r(79),p=v.RETURN,d=function(t){return null==t?void 0:f(t)},y=function(t){var n=t._c;n&&(t._c=void 0,n())},g=function(t){return void 0===t._o},b=function(t){g(t)||(t._o=void 0,y(t))},m=function(t,n){a(t),this._c=void 0,this._o=t,t=new x(this);try{var r=n(t),e=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){e.unsubscribe()}:f(r),this._c=r)}catch(n){return void t.error(n)}g(this)&&y(this)};m.prototype=l({},{unsubscribe:function(){b(this)}});var x=function(t){this._s=t};x.prototype=l({},{next:function(t){var n=this._s;if(!g(n)){var r=n._o;try{var e=d(r.next);if(e)return e.call(r,t)}catch(t){try{b(n)}finally{throw t}}}},error:function(t){var n=this._s;if(g(n))throw t;var r=n._o;n._o=void 0;try{var e=d(r.error);if(!e)throw t;t=e.call(r,t)}catch(t){try{y(n)}finally{throw t}}return y(n),t},complete:function(t){var n=this._s;if(!g(n)){var r=n._o;n._o=void 0;try{var e=d(r.complete);t=e?e.call(r,t):void 0}catch(t){try{y(n)}finally{throw t}}return y(n),t}}});var w=function(t){s(this,w,"Observable","_f")._f=f(t)};l(w.prototype,{subscribe:function(t){return new m(t,this._f)},forEach:function(t){var n=this;return new(o.Promise||i.Promise)(function(r,e){f(t);var i=n.subscribe({next:function(n){try{return t(n)}catch(t){e(t),i.unsubscribe()}},error:e,complete:r})})}}),l(w,{from:function(t){var n="function"==typeof this?this:w,r=d(a(t)[c]);if(r){var e=a(r.call(t));return e.constructor===n?e:new n(function(t){return e.subscribe(t)})}return new n(function(n){var r=!1;return u(function(){if(!r){try{if(v(t,!1,function(t){if(n.next(t),r)return p})===p)return}catch(t){if(r)throw t;return void n.error(t)}n.complete()}}),function(){r=!0}})},of:function(){for(var t=0,n=arguments.length,r=Array(n);t<n;)r[t]=arguments[t++];return new("function"==typeof this?this:w)(function(t){var n=!1;return u(function(){if(!n){for(var e=0;e<r.length;++e)if(t.next(r[e]),n)return;t.complete()}}),function(){n=!0}})}}),h(w.prototype,c,function(){return this}),e(e.G,{Observable:w}),r(74)("Observable")},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.set;e.exp({defineMetadata:function(t,n,r,e){u(t,n,i(r),o(e))}})},function(t,n,r){var e=r(54),i=r(2),o=e.key,u=e.map,c=e.store;e.exp({deleteMetadata:function(t,n){var r=arguments.length<3?void 0:o(arguments[2]),e=u(i(n),r,!1);if(void 0===e||!e.delete(t))return!1;if(e.size)return!0;var f=c.get(n);return f.delete(r),!!f.size||c.delete(n)}})},function(t,n,r){var e=r(185),i=r(161),o=r(54),u=r(2),c=r(32),f=o.keys,a=o.key,s=function(t,n){var r=f(t,n),o=c(t);if(null===o)return r;var u=s(o,n);return u.length?r.length?i(new e(r.concat(u))):u:r};o.exp({getMetadataKeys:function(t){return s(u(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.get,f=e.key,a=function(t,n,r){if(u(t,n,r))return c(t,n,r);var e=o(n);return null!==e?a(t,e,r):void 0};e.exp({getMetadata:function(t,n){return a(t,i(n),arguments.length<3?void 0:f(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.keys,u=e.key;e.exp({getOwnMetadataKeys:function(t){
return o(i(t),arguments.length<2?void 0:u(arguments[1]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.get,u=e.key;e.exp({getOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(32),u=e.has,c=e.key,f=function(t,n,r){if(u(t,n,r))return!0;var e=o(n);return null!==e&&f(t,e,r)};e.exp({hasMetadata:function(t,n){return f(t,i(n),arguments.length<3?void 0:c(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=e.has,u=e.key;e.exp({hasOwnMetadata:function(t,n){return o(t,i(n),arguments.length<3?void 0:u(arguments[2]))}})},function(t,n,r){var e=r(54),i=r(2),o=r(26),u=e.key,c=e.set;e.exp({metadata:function(t,n){return function(r,e){c(t,n,(void 0!==e?i:o)(r),u(e))}}})},function(t,n,r){var e=r(1);e(e.P+e.R,"Set",{toJSON:r(165)("Set")})},function(t,n,r){"use strict";var e=r(1),i=r(147)(!0);e(e.P,"String",{at:function(t){return i(this,t)}})},function(t,n,r){"use strict";var e=r(1),i=r(46),o=r(16),u=r(122),c=r(120),f=RegExp.prototype,a=function(t,n){this._r=t,this._s=n};r(139)(a,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),e(e.P,"String",{matchAll:function(t){if(i(this),!u(t))throw TypeError(t+" is not a regexp!");var n=String(this),r="flags"in f?String(t.flags):c.call(t),e=new RegExp(t.source,~r.indexOf("g")?r:"g"+r);return e.lastIndex=o(t.lastIndex),new a(e,n)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,n,r){"use strict";var e=r(1),i=r(181);e(e.P,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,n,r){"use strict";r(82)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,n,r){"use strict";r(82)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,n,r){r(153)("asyncIterator")},function(t,n,r){r(153)("observable")},function(t,n,r){var e=r(1);e(e.S,"System",{global:r(3)})},function(t,n,r){for(var e=r(155),i=r(28),o=r(3),u=r(27),c=r(80),f=r(7),a=f("iterator"),s=f("toStringTag"),l=c.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],v=0;v<5;v++){var p,d=h[v],y=o[d],g=y&&y.prototype;if(g){g[a]||u(g,a,l),g[s]||u(g,s,d),c[d]=l;for(p in e)g[p]||i(g,p,e[p],!0)}}},function(t,n,r){var e=r(1),i=r(151);e(e.G+e.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,n,r){var e=r(3),i=r(1),o=r(121),u=r(207),c=e.navigator,f=!!c&&/MSIE .\./.test(c.userAgent),a=function(t){return f?function(n,r){return t(o(u,[].slice.call(arguments,2),"function"==typeof n?n:Function(n)),r)}:t};i(i.G+i.B+i.F*f,{setTimeout:a(e.setTimeout),setInterval:a(e.setInterval)})},function(t,n,r){r(330),r(269),r(271),r(270),r(273),r(275),r(280),r(274),r(272),r(282),r(281),r(277),r(278),r(276),r(268),r(279),r(283),r(284),r(236),r(238),r(237),r(286),r(285),r(256),r(266),r(267),r(257),r(258),r(259),r(260),r(261),r(262),r(263),r(264),r(265),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(317),r(322),r(329),r(320),r(312),r(313),r(318),r(323),r(325),r(308),r(309),r(310),r(311),r(314),r(315),r(316),r(319),r(321),r(324),r(326),r(327),r(328),r(231),r(233),r(232),r(235),r(234),r(220),r(218),r(224),r(221),r(227),r(229),r(217),r(223),r(214),r(228),r(212),r(226),r(225),r(219),r(222),r(211),r(213),r(216),r(215),r(230),r(155),r(302),r(307),r(184),r(303),r(304),r(305),r(306),r(287),r(183),r(185),r(186),r(342),r(331),r(332),r(337),r(340),r(341),r(335),r(338),r(336),r(339),r(333),r(334),r(288),r(289),r(290),r(291),r(292),r(295),r(293),r(294),r(296),r(297),r(298),r(299),r(301),r(300),r(343),r(369),r(372),r(371),r(373),r(374),r(370),r(375),r(376),r(354),r(357),r(353),r(351),r(352),r(355),r(356),r(346),r(368),r(377),r(345),r(347),r(349),r(348),r(350),r(359),r(360),r(362),r(361),r(364),r(363),r(365),r(366),r(367),r(344),r(358),r(380),r(379),r(378),t.exports=r(52)},function(t,n){function r(t,n){if("string"==typeof n)return t.insertAdjacentHTML("afterend",n);var r=t.nextSibling;return r?t.parentNode.insertBefore(n,r):t.parentNode.appendChild(n)}t.exports=r},,,,,,,,,function(t,n,r){(function(n,r){!function(n){"use strict";function e(t,n,r,e){var i=n&&n.prototype instanceof o?n:o,u=Object.create(i.prototype),c=new p(e||[]);return u._invoke=s(t,r,c),u}function i(t,n,r){try{return{type:"normal",arg:t.call(n,r)}}catch(t){return{type:"throw",arg:t}}}function o(){}function u(){}function c(){}function f(t){["next","throw","return"].forEach(function(n){t[n]=function(t){return this._invoke(n,t)}})}function a(t){function n(r,e,o,u){var c=i(t[r],t,e);if("throw"!==c.type){var f=c.arg,a=f.value;return a&&"object"==typeof a&&m.call(a,"__await")?Promise.resolve(a.__await).then(function(t){n("next",t,o,u)},function(t){n("throw",t,o,u)}):Promise.resolve(a).then(function(t){f.value=t,o(f)},u)}u(c.arg)}function e(t,r){function e(){return new Promise(function(e,i){n(t,r,e,i)})}return o=o?o.then(e,e):e()}"object"==typeof r&&r.domain&&(n=r.domain.bind(n));var o;this._invoke=e}function s(t,n,r){var e=P;return function(o,u){if(e===F)throw new Error("Generator is already running");if(e===M){if("throw"===o)throw u;return y()}for(r.method=o,r.arg=u;;){var c=r.delegate;if(c){var f=l(c,r);if(f){if(f===A)continue;return f}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(e===P)throw e=M,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);e=F;var a=i(t,n,r);if("normal"===a.type){if(e=r.done?M:j,a.arg===A)continue;return{value:a.arg,done:r.done}}"throw"===a.type&&(e=M,r.method="throw",r.arg=a.arg)}}}function l(t,n){var r=t.iterator[n.method];if(r===g){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=g,l(t,n),"throw"===n.method))return A;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=i(r,t.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,A;var o=e.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=g),n.delegate=null,A):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,A)}function h(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function v(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function p(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function d(t){if(t){var n=t[w];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,e=function n(){for(;++r<t.length;)if(m.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=g,n.done=!0,n};return e.next=e}}return{next:y}}function y(){return{value:g,done:!0}}var g,b=Object.prototype,m=b.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},w=x.iterator||"@@iterator",S=x.asyncIterator||"@@asyncIterator",_=x.toStringTag||"@@toStringTag",O="object"==typeof t,E=n.regeneratorRuntime;if(E)return void(O&&(t.exports=E));E=n.regeneratorRuntime=O?t.exports:{},E.wrap=e;var P="suspendedStart",j="suspendedYield",F="executing",M="completed",A={},N={};N[w]=function(){return this};var T=Object.getPrototypeOf,I=T&&T(T(d([])));I&&I!==b&&m.call(I,w)&&(N=I);var k=c.prototype=o.prototype=Object.create(N);u.prototype=k.constructor=c,c.constructor=u,c[_]=u.displayName="GeneratorFunction",E.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===u||"GeneratorFunction"===(n.displayName||n.name))},E.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,c):(t.__proto__=c,_ in t||(t[_]="GeneratorFunction")),t.prototype=Object.create(k),t},E.awrap=function(t){return{__await:t}},f(a.prototype),a.prototype[S]=function(){return this},E.AsyncIterator=a,E.async=function(t,n,r,i){var o=new a(e(t,n,r,i));return E.isGeneratorFunction(n)?o:o.next().then(function(t){return t.done?t.value:o.next()})},f(k),k[_]="Generator",k.toString=function(){return"[object Generator]"},E.keys=function(t){var n=[];for(var r in t)n.push(r);return n.reverse(),function r(){for(;n.length;){var e=n.pop();if(e in t)return r.value=e,r.done=!1,r}return r.done=!0,r}},E.values=d,p.prototype={constructor:p,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(v),!t)for(var n in this)"t"===n.charAt(0)&&m.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],n=t.completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(t){function n(n,e){return o.type="throw",o.arg=t,r.next=n,e&&(r.method="next",r.arg=g),!!e}if(this.done)throw t;for(var r=this,e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=m.call(i,"catchLoc"),c=m.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,n){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc<=this.prev&&m.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var i=e;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=n&&n<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=n,i?(this.method="next",this.next=i.finallyLoc,A):this.complete(o)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),A},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),v(r),A}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var e=r.completion;if("throw"===e.type){var i=e.arg;v(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:d(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=g),A}}}("object"==typeof n?n:"object"==typeof window?window:"object"==typeof self?self:this)}).call(n,function(){return this}(),r(158))}])</script><script src="/./main.0cf68a.js"></script><script>!function(){!function(e){var t=document.createElement("script");document.getElementsByTagName("body")[0].appendChild(t),t.setAttribute("src",e)}("/slider.e37972.js")}()</script>


    
<div class="tools-col" q-class="show:isShow,hide:isShow|isFalse" q-on="click:stop(e)">
  <div class="tools-nav header-menu">
    
    
      
      
      
    
      
      
      
    
      
      
      
    
    

    <ul style="width: 70%">
    
    
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'innerArchive')"><a href="javascript:void(0)" q-class="active:innerArchive">所有文章</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'friends')"><a href="javascript:void(0)" q-class="active:friends">友链</a></li>
      
        
      
      <li style="width: 33.333333333333336%" q-on="click: openSlider(e, 'aboutme')"><a href="javascript:void(0)" q-class="active:aboutme">关于我</a></li>
      
        
    </ul>
  </div>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all" q-show="innerArchive">
        <div class="search-wrap">
          <input class="search-ipt" q-model="search" type="text" placeholder="find something…">
          <i class="icon-search icon" q-show="search|isEmptyStr"></i>
          <i class="icon-close icon" q-show="search|isNotEmptyStr" q-on="click:clearChose(e)"></i>
        </div>
        <div class="widget tagcloud search-tag">
          <p class="search-tag-wording">tag:</p>
          <label class="search-switch">
            <input type="checkbox" q-on="click:toggleTag(e)" q-attr="checked:showTags">
          </label>
          <ul class="article-tag-list" q-show="showTags">
             
              <li class="article-tag-list-item">
                <a href="javascript:void(0)" class="js-tag color5">tags</a>
              </li>
            
            <div class="clearfix"></div>
          </ul>
        </div>
        <ul class="search-ul">
          <p q-show="jsonFail" style="padding: 20px; font-size: 12px;">
            缺失模块。<br/>1、请确保node版本大于6.2<br/>2、在博客根目录（注意不是yilia根目录）执行以下命令：<br/> npm i hexo-generator-json-content --save<br/><br/>
            3、在根目录_config.yml里添加配置：
<pre style="font-size: 12px;" q-show="jsonFail">
  jsonContent:
    meta: false
    pages: false
    posts:
      title: true
      date: true
      path: true
      text: false
      raw: false
      content: false
      slug: false
      updated: false
      comments: false
      link: false
      permalink: false
      excerpt: false
      categories: false
      tags: true
</pre>
          </p>
          <li class="search-li" q-repeat="items" q-show="isShow">
            <a q-attr="href:path|urlformat" class="search-title"><i class="icon-quo-left icon"></i><span q-text="title"></span></a>
            <p class="search-time">
              <i class="icon-calendar icon"></i>
              <span q-text="date|dateformat"></span>
            </p>
            <p class="search-tag">
              <i class="icon-price-tags icon"></i>
              <span q-repeat="tags" q-on="click:choseTag(e, name)" q-text="name|tagformat"></span>
            </p>
          </li>
        </ul>
    	</section>
    

    
    	<section class="tools-section tools-section-friends" q-show="friends">
  		
        <ul class="search-ul">
          
            <li class="search-li">
              <a href="https://thzidane.github.io/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>Link 1</a>
            </li>
          
            <li class="search-li">
              <a href="https://thzidane.github.io/" target="_blank" class="search-title"><i class="icon-quo-left icon"></i>友情链接1</a>
            </li>
          
        </ul>
  		
    	</section>
    

    
    	<section class="tools-section tools-section-me" q-show="aboutme">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">Thanks for visiting!!!&lt;br&gt;&lt;br&gt;Hao Tang&lt;br&gt;Microsoft Software Engineer</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>